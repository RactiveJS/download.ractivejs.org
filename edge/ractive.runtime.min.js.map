{"version":3,"file":"ractive.runtime.min.js","sources":["../src/view/items/shared/Mustache.js","../src/view/items/Interpolator.js","../src/view/items/element/specials/Input.js","../src/view/items/element/specials/Option.js","../src/view/items/Partial.js","../src/view/RepeatedFragment.js","../src/view/items/Section.js","../src/view/items/element/specials/Select.js","../src/view/items/Text.js","../src/view/items/triple/insertHtml.js","../src/view/items/Triple.js","../src/view/items/Yielder.js","../src/view/items/createItem.js","../src/view/resolvers/ReferenceResolver.js","../src/view/Fragment.js","../src/Ractive/prototype/reverse.js","../src/Ractive/prototype/shift.js","../src/Ractive/prototype/sort.js","../src/Ractive/prototype/splice.js","../src/Ractive/prototype/teardown.js","../src/Ractive/prototype/toHTML.js","../src/Ractive/prototype/unrender.js","../src/Ractive/prototype/unshift.js","../src/Ractive/prototype/update.js","../src/Ractive/prototype.js","../src/utils/wrapMethod.js","../src/extend/_extend.js","../src/Ractive/static/getNodeInfo.js","../src/Ractive.js","../src/view/items/element/attribute/propertyNames.js","../src/utils/html.js","../src/view/items/element/Attribute.js","../src/view/items/element/ConditionalAttribute.js","../src/view/items/element/Decorator.js","../src/view/items/element/EventHandler.js","../src/utils/camelCase.js","../src/view/items/element/transitions/prefix.js","../src/config/visibility.js","../src/shared/Ticker.js","../src/view/items/element/transitions/unprefix.js","../src/view/items/element/transitions/createTransitions.js","../src/view/items/element/transitions/hyphenate.js","../src/view/items/element/Transition.js","../src/view/items/element/updateLiveQueries.js","../src/view/items/element/binding/Binding.js","../src/view/items/element/binding/CheckboxBinding.js","../src/view/items/element/binding/getBindingGroup.js","../src/view/items/element/binding/CheckboxNameBinding.js","../src/view/items/element/binding/ContentEditableBinding.js","../src/view/items/element/binding/FileListBinding.js","../src/view/items/element/binding/GenericBinding.js","../src/view/items/element/binding/MultipleSelectBinding.js","../src/view/items/element/binding/NumericBinding.js","../src/view/items/element/binding/RadioBinding.js","../src/view/items/element/binding/RadioNameBinding.js","../src/view/items/element/binding/SingleSelectBinding.js","../src/view/items/Element.js","../src/view/items/element/specials/Form.js","../src/Ractive/prototype/observe.js","../src/Ractive/prototype/observeList.js","../src/Ractive/prototype/observeOnce.js","../src/Ractive/prototype/shared/trim.js","../src/Ractive/prototype/shared/notEmptyString.js","../src/Ractive/prototype/once.js","../src/Ractive/prototype/shared/makeArrayMethod.js","../src/Ractive/prototype/pop.js","../src/Ractive/prototype/push.js","../src/global/css.js","../src/Ractive/config/registries.js","../src/Ractive/render.js","../src/Ractive/config/custom/adapt.js","../src/Ractive/config/custom/css/transform.js","../src/Ractive/config/custom/css/css.js","../src/Ractive/config/custom/data.js","../.gobble-build/02-babel/1/parse/_parse.js","../src/Ractive/config/custom/template/parser.js","../src/Ractive/config/custom/template/template.js","../src/Ractive/config/config.js","../src/Ractive/prototype/reset.js","../src/config/types.js","../src/Ractive/prototype/resetPartial.js","../src/view/items/shared/Item.js","../src/Ractive/static/adaptors/array/processWrapper.js","../src/Ractive/static/adaptors/array/patch.js","../src/Ractive/static/adaptors/array/index.js","../src/Ractive/static/adaptors/magic.js","../src/Ractive/static/adaptors/magicArray.js","../src/global/capture.js","../src/parse/Parser.js","../src/model/helpers/getPrefixer.js","../src/model/specials/KeyModel.js","../src/model/specials/KeypathModel.js","../src/model/Model.js","../src/model/Computation.js","../src/model/RootModel.js","../src/Ractive/helpers/getComputationSignature.js","../src/Ractive/construct.js","../src/events/HookQueue.js","../src/Ractive/initialise.js","../src/shared/createFunction.js","../src/view/resolvers/ExpressionProxy.js","../src/view/resolvers/ReferenceExpressionProxy.js","../src/parse/converters/expressions/primary/literal/stringLiteral/makeQuotedStringMatcher.js","../src/utils/parseJSON.js","../src/parse/converters/expressions/primary/literal/readStringLiteral.js","../src/parse/converters/expressions/primary/literal/readNumberLiteral.js","../src/parse/converters/expressions/shared/patterns.js","../src/parse/converters/expressions/shared/readKey.js","../src/view/items/Component.js","../src/view/items/Doctype.js","../src/view/items/element/transitions/resetStyle.js","../src/view/items/element/binding/handleDomEvent.js","../src/view/items/element/binding/selectBinding.js","../src/view/items/partial/getPartialTemplate.js","../src/view/items/component/getComponentConstructor.js","../src/view/helpers/processItems.js","../src/Ractive/prototype/resetTemplate.js","../src/Ractive/prototype/set.js","../src/Ractive/prototype/subtract.js","../src/Ractive/prototype/toggle.js","../src/Ractive/prototype/updateModel.js","../src/extend/unwrapExtended.js","../src/config/template.js","../src/Ractive/config/defaults.js","../src/Ractive/static/easing.js","../src/config/environment.js","../src/utils/dom.js","../.gobble-build/02-babel/1/legacy.js","../src/utils/object.js","../src/utils/log.js","../src/utils/is.js","../src/config/errors.js","../src/utils/requestAnimationFrame.js","../src/shared/interpolate.js","../src/Ractive/static/interpolators.js","../src/shared/keypaths.js","../src/Ractive/prototype/shared/add.js","../src/utils/getTime.js","../src/events/Hook.js","../src/utils/array.js","../src/utils/Promise.js","../src/global/TransitionManager.js","../src/global/runloop.js","../src/shared/animations.js","../src/Ractive/prototype/animate/Animation.js","../src/Ractive/prototype/animate.js","../src/Ractive/prototype/detach.js","../src/Ractive/prototype/find.js","../src/Ractive/prototype/shared/Query.js","../src/Ractive/prototype/findComponent.js","../src/Ractive/prototype/findParent.js","../src/utils/getPotentialWildcardMatches.js","../src/events/fireEvent.js","../src/Ractive/prototype/insert.js","../src/Ractive/prototype/merge.js","../src/shared/registry.js","../src/Ractive/prototype/add.js","../src/shared/methodCallers.js","../src/Ractive/prototype/findAll.js","../src/Ractive/prototype/findAllComponents.js","../src/Ractive/prototype/findContainer.js","../src/events/eventStack.js","../src/Ractive/prototype/fire.js","../src/view/resolvers/resolveAmbiguousReference.js","../src/view/resolvers/resolveReference.js","../src/Ractive/prototype/get.js","../src/Ractive/prototype/off.js","../src/Ractive/prototype/on.js","../src/shared/getNewIndices.js","../src/Ractive/prototype/render.js","../src/Ractive/config/wrapPrototypeMethod.js","../src/Ractive/config/deprecate.js","../src/view/resolvers/resolve.js","../src/view/items/component/updateLiveQueries.js","../src/view/items/element/attribute/getUpdateDelegate.js"],"sourcesContent":["import Item from './Item';\nimport resolve from '../../resolvers/resolve';\n\nexport default class Mustache extends Item {\n\tconstructor ( options ) {\n\t\tsuper( options );\n\n\t\tthis.parentFragment = options.parentFragment;\n\t\tthis.template = options.template;\n\t\tthis.index = options.index;\n\n\t\tthis.isStatic = !!options.template.s;\n\n\t\tthis.model = null;\n\t\tthis.dirty = false;\n\t}\n\n\tbind () {\n\t\t// try to find a model for this view\n\t\tconst model = resolve( this.parentFragment, this.template );\n\t\tconst value = model ? model.get() : undefined;\n\n\t\tif ( this.isStatic ) {\n\t\t\tthis.model = { get: () => value };\n\t\t\treturn;\n\t\t}\n\n\t\tif ( model ) {\n\t\t\tmodel.register( this );\n\t\t\tthis.model = model;\n\t\t} else {\n\t\t\tthis.resolver = this.parentFragment.resolve( this.template.r, model => {\n\t\t\t\tthis.model = model;\n\t\t\t\tmodel.register( this );\n\n\t\t\t\tthis.handleChange();\n\t\t\t\tthis.resolver = null;\n\t\t\t});\n\t\t}\n\t}\n\n\thandleChange () {\n\t\tthis.bubble();\n\t}\n\n\trebind () {\n\t\tif ( this.isStatic || !this.model ) return;\n\n\t\tconst model = resolve( this.parentFragment, this.template );\n\n\t\tif ( model === this.model ) return;\n\n\t\tconst oldValue = this.model.get();\n\t\tthis.model.unregister( this );\n\n\t\tmodel.register( this );\n\t\tthis.model = model;\n\n\t\tif ( model.get() !== oldValue ) this.handleChange();\n\t}\n\n\tunbind () {\n\t\tif ( !this.isStatic ) {\n\t\t\tthis.model && this.model.unregister( this );\n\t\t\tthis.resolver && this.resolver.unbind();\n\t\t}\n\t}\n}\n","import { doc } from 'config/environment';\nimport { escapeHtml } from 'utils/html';\nimport { safeToStringValue } from 'utils/dom';\nimport Mustache from './shared/Mustache';\n\nexport default class Interpolator extends Mustache {\n\tdetach () {\n\t\treturn this.node.parentNode.removeChild( this.node );\n\t}\n\n\tfirstNode () {\n\t\treturn this.node;\n\t}\n\n\tgetString () {\n\t\treturn this.model ? safeToStringValue( this.model.get() ) : '';\n\t}\n\n\trender ( target ) {\n\t\tthis.rendered = true;\n\t\tthis.node = doc.createTextNode( this.getString() );\n\n\t\ttarget.appendChild( this.node );\n\t}\n\n\ttoString ( escape ) {\n\t\tconst string = this.getString();\n\t\treturn escape ? escapeHtml( string ) : string;\n\t}\n\n\tunrender ( shouldDestroy ) {\n\t\tif ( shouldDestroy ) this.detach();\n\t\tthis.rendered = false;\n\t}\n\n\tupdate () {\n\t\tif ( this.dirty ) {\n\t\t\tif ( this.rendered ) {\n\t\t\t\tthis.node.data = this.getString();\n\t\t\t}\n\n\t\t\tthis.dirty = false;\n\t\t}\n\t}\n\n\tvalueOf () {\n\t\treturn this.model ? this.model.get() : undefined;\n\t}\n}\n","import Element from '../../Element';\n\nexport default class Input extends Element {\n\trender ( target ) {\n\t\tsuper.render( target );\n\t\tthis.node.defaultValue = this.node.value;\n\t}\n}\n","import Element from '../../Element';\nimport { removeFromArray } from 'utils/array';\nimport { isArray } from 'utils/is';\n\nfunction findParentSelect ( element ) {\n\twhile ( element ) {\n\t\tif ( element.name === 'select' ) return element;\n\t\telement = element.parent;\n\t}\n}\n\nexport default class Option extends Element {\n\tconstructor ( options ) {\n\t\tconst template = options.template;\n\t\tif ( !template.a ) template.a = {};\n\n\t\t// If the value attribute is missing, use the element's content,\n\t\t// as long as it isn't disabled\n\t\tif ( template.a.value === undefined && !( 'disabled' in template ) ) {\n\t\t\ttemplate.a.value = template.f;\n\t\t}\n\n\t\tsuper( options );\n\n\t\tthis.select = findParentSelect( this.parent );\n\t}\n\n\tbind () {\n\t\tif ( !this.select ) {\n\t\t\tsuper.bind();\n\t\t\treturn;\n\t\t}\n\n\t\t// If the select has a value, it overrides the `selected` attribute on\n\t\t// this option - so we delete the attribute\n\t\tconst selectedAttribute = this.attributeByName.selected;\n\t\tif ( selectedAttribute && this.select.getAttribute( 'value' ) !== undefined ) {\n\t\t\tconst index = this.attributes.indexOf( selectedAttribute );\n\t\t\tthis.attributes.splice( index, 1 );\n\t\t\tdelete this.attributeByName.selected;\n\t\t}\n\n\t\tsuper.bind();\n\t\tthis.select.options.push( this );\n\t}\n\n\tisSelected () {\n\t\tconst optionValue = this.getAttribute( 'value' );\n\n\t\tif ( optionValue === undefined || !this.select ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst selectValue = this.select.getAttribute( 'value' );\n\n\t\tif ( selectValue == optionValue ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( this.select.getAttribute( 'multiple' ) && isArray( selectValue ) ) {\n\t\t\tlet i = selectValue.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( selectValue[i] == optionValue ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tunbind () {\n\t\tsuper.unbind();\n\n\t\tif ( this.select ) {\n\t\t\tremoveFromArray( this.select.options, this );\n\t\t}\n\t}\n}\n","import { warnOnceIfDebug } from 'utils/log';\nimport Mustache from './shared/Mustache';\nimport Fragment from '../Fragment';\nimport getPartialTemplate from './partial/getPartialTemplate';\n\nexport default class Partial extends Mustache {\n\tbind () {\n\t\tsuper.bind();\n\n\t\t// name matches take priority over expressions\n\t\tlet template = this.template.r ? getPartialTemplate( this.ractive, this.template.r, this.parentFragment ) || null : null;\n\n\t\tif ( template ) {\n\t\t\tthis.named = true;\n\t\t\tthis.setTemplate( this.template.r, template );\n\t\t} else if ( ( !this.model || typeof this.model.get() !== 'string' ) && this.template.r ) {\n\t\t\tthis.setTemplate( this.template.r, template );\n\t\t} else {\n\t\t\tthis.setTemplate( this.model.get() );\n\t\t}\n\n\t\tthis.fragment = new Fragment({\n\t\t\towner: this,\n\t\t\ttemplate: this.partialTemplate\n\t\t}).bind();\n\t}\n\n\tdetach () {\n\t\treturn this.fragment.detach();\n\t}\n\n\tfind ( selector ) {\n\t\treturn this.fragment.find( selector );\n\t}\n\n\tfindAll ( selector, query ) {\n\t\tthis.fragment.findAll( selector, query );\n\t}\n\n\tfindComponent ( name ) {\n\t\treturn this.fragment.findComponent( name );\n\t}\n\n\tfindAllComponents ( name, query ) {\n\t\tthis.fragment.findAllComponents( name, query );\n\t}\n\n\tfirstNode () {\n\t\treturn this.fragment.firstNode();\n\t}\n\n\tforceResetTemplate () {\n\t\tthis.partialTemplate = getPartialTemplate( this.ractive, this.name, this.parentFragment );\n\n\t\tif ( !this.partialTemplate ) {\n\t\t\twarnOnceIfDebug( `Could not find template for partial '${this.name}'` );\n\t\t\tthis.partialTemplate = [];\n\t\t}\n\n\t\tthis.fragment.resetTemplate( this.partialTemplate );\n\t\tthis.bubble();\n\t}\n\n\trebind () {\n\t\tsuper.unbind();\n\t\tsuper.bind();\n\t\tthis.fragment.rebind();\n\t}\n\n\trender ( target ) {\n\t\tthis.fragment.render( target );\n\t}\n\n\tsetTemplate ( name, template ) {\n\t\tthis.name = name;\n\n\t\tif ( !template && template !== null ) template = getPartialTemplate( this.ractive, name, this.parentFragment );\n\n\t\tif ( !template ) {\n\t\t\twarnOnceIfDebug( `Could not find template for partial '${name}'` );\n\t\t}\n\n\t\tthis.partialTemplate = template || [];\n\t}\n\n\ttoString ( escape ) {\n\t\treturn this.fragment.toString( escape );\n\t}\n\n\tunbind () {\n\t\tsuper.unbind();\n\t\tthis.fragment.unbind();\n\t}\n\n\tunrender ( shouldDestroy ) {\n\t\tthis.fragment.unrender( shouldDestroy );\n\t}\n\n\tupdate () {\n\t\tif ( this.dirty ) {\n\t\t\tif ( !this.named ) {\n\t\t\t\tif ( this.model && typeof this.model.get() === 'string' && this.model.get() !== this.name ) {\n\t\t\t\t\tthis.setTemplate( this.model.get() );\n\t\t\t\t\tthis.fragment.resetTemplate( this.partialTemplate );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.fragment.update();\n\t\t\tthis.dirty = false;\n\t\t}\n\t}\n}\n","import Fragment from './Fragment';\nimport { createDocumentFragment } from 'utils/dom';\nimport { isArray, isObject } from 'utils/is';\nimport { toEscapedString, toString, unbind, unrender, unrenderAndDestroy, update } from 'shared/methodCallers';\n\nfunction getRefs ( ref, value, parent ) {\n\tlet refs;\n\n\tif ( ref ) {\n\t\trefs = {};\n\t\tObject.keys( parent ).forEach( ref => {\n\t\t\trefs[ ref ] = parent[ ref ];\n\t\t});\n\t\trefs[ ref ] = value;\n\t} else {\n\t\trefs = parent;\n\t}\n\n\treturn refs;\n}\n\nexport default class RepeatedFragment {\n\tconstructor ( options ) {\n\t\tthis.parent = options.owner.parentFragment;\n\n\t\t// bit of a hack, so reference resolution works without another\n\t\t// layer of indirection\n\t\tthis.parentFragment = this;\n\t\tthis.owner = options.owner;\n\t\tthis.ractive = this.parent.ractive;\n\n\t\tthis.template = options.template;\n\n\t\tthis.indexRef = options.indexRef;\n\t\tthis.keyRef = options.keyRef;\n\n\t\tthis.pendingNewIndices = null;\n\t\tthis.indexByKey = null; // for `{{#each object}}...`\n\t}\n\n\tbind ( context ) {\n\t\tthis.context = context;\n\t\tconst value = context.get();\n\n\t\t// {{#each array}}...\n\t\tif ( isArray( value ) ) {\n\t\t\t// we can't use map, because of sparse arrays\n\t\t\tthis.iterations = [];\n\t\t\tfor ( let i = 0; i < value.length; i += 1 ) {\n\t\t\t\tthis.iterations[i] = this.createIteration( i, i );\n\t\t\t}\n\t\t}\n\n\t\t// {{#each object}}...\n\t\telse if ( isObject( value ) ) {\n\t\t\t// TODO this is a dreadful hack. There must be a neater way\n\t\t\tif ( this.indexRef ) {\n\t\t\t\tconst [ keyRef, indexRef ] = this.indexRef.split( ',' );\n\t\t\t\tthis.keyRef = keyRef;\n\t\t\t\tthis.indexRef = indexRef;\n\t\t\t}\n\n\t\t\tthis.indexByKey = {};\n\t\t\tthis.iterations = Object.keys( value ).map( ( key, index ) => {\n\t\t\t\tthis.indexByKey[ key ] = index;\n\t\t\t\treturn this.createIteration( key, index );\n\t\t\t});\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tbubble () {\n\t\tthis.owner.bubble();\n\t}\n\n\tcreateIteration ( key, index ) {\n\t\tconst parentFragment = this.owner.parentFragment;\n\t\tconst keyRefs = getRefs( this.keyRef, key, parentFragment.keyRefs );\n\t\tconst indexRefs = getRefs( this.indexRef, index, parentFragment.indexRefs );\n\n\t\tconst fragment = new Fragment({\n\t\t\towner: this,\n\t\t\ttemplate: this.template,\n\t\t\tindexRefs,\n\t\t\tkeyRefs\n\t\t});\n\n\t\t// TODO this is a bit hacky\n\t\tfragment.key = key;\n\t\tfragment.index = index;\n\t\tfragment.isIteration = true;\n\n\t\tconst model = this.context.joinKey( key );\n\t\treturn fragment.bind( model );\n\t}\n\n\tdetach () {\n\t\tconst docFrag = createDocumentFragment();\n\t\tthis.iterations.forEach( fragment => docFrag.appendChild( fragment.detach() ) );\n\t\treturn docFrag;\n\t}\n\n\tfind ( selector ) {\n\t\tconst len = this.iterations.length;\n\t\tlet i;\n\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tconst found = this.iterations[i].find( selector );\n\t\t\tif ( found ) return found;\n\t\t}\n\t}\n\n\tfindAll ( selector, query ) {\n\t\tconst len = this.iterations.length;\n\t\tlet i;\n\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tthis.iterations[i].findAll( selector, query );\n\t\t}\n\t}\n\n\tfindComponent ( name ) {\n\t\tconst len = this.iterations.length;\n\t\tlet i;\n\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tconst found = this.iterations[i].findComponent( name );\n\t\t\tif ( found ) return found;\n\t\t}\n\t}\n\n\tfindAllComponents ( name, query ) {\n\t\tconst len = this.iterations.length;\n\t\tlet i;\n\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tthis.iterations[i].findAllComponents( name, query );\n\t\t}\n\t}\n\n\tfindNextNode ( iteration ) {\n\t\tif ( iteration.index < this.iterations.length - 1 ) {\n\t\t\treturn this.iterations[ iteration.index + 1 ].firstNode();\n\t\t}\n\n\t\treturn this.owner.findNextNode();\n\t}\n\n\tfirstNode () {\n\t\treturn this.iterations[0] ? this.iterations[0].firstNode() : null;\n\t}\n\n\trebind ( context ) {\n\t\tthis.context = context;\n\n\t\t// {{#each array}}...\n\t\tif ( isArray( context.get() ) ) {\n\t\t\tthis.iterations.forEach( ( fragment, i ) => {\n\t\t\t\tfragment.rebind( context.joinKey( i ) );\n\t\t\t});\n\t\t}\n\t}\n\n\trender ( target ) {\n\t\t// TODO use docFrag.cloneNode...\n\n\t\tif ( this.iterations ) {\n\t\t\tthis.iterations.forEach( fragment => fragment.render( target ) );\n\t\t}\n\n\t\tthis.rendered = true;\n\t}\n\n\tshuffle ( newIndices ) {\n\t\tif ( this.pendingNewIndices ) {\n\t\t\tthrow new Error( 'Section was already shuffled!' );\n\t\t}\n\n\t\tthis.pendingNewIndices = newIndices;\n\t\tthis.previousIterations = this.iterations.slice();\n\n\t\tconst iterations = [];\n\n\t\tnewIndices.forEach( ( newIndex, oldIndex ) => {\n\t\t\tif ( newIndex === -1 ) return;\n\n\t\t\tconst fragment = this.iterations[ oldIndex ];\n\t\t\titerations[ newIndex ] = fragment;\n\n\t\t\tif ( newIndex !== oldIndex ) fragment.dirty = true;\n\t\t});\n\n\t\tthis.iterations = iterations;\n\t\tthis.bubble();\n\t}\n\n\ttoString ( escape ) {\n\t\treturn this.iterations ?\n\t\t\tthis.iterations.map( escape ? toEscapedString : toString ).join( '' ) :\n\t\t\t'';\n\t}\n\n\tunbind () {\n\t\tthis.iterations.forEach( unbind );\n\t\treturn this;\n\t}\n\n\tunrender ( shouldDestroy ) {\n\t\tthis.iterations.forEach( shouldDestroy ? unrenderAndDestroy : unrender );\n\t\tthis.rendered = false;\n\t}\n\n\t// TODO smart update\n\tupdate () {\n\t\t// skip dirty check, since this is basically just a facade\n\n\t\tif ( this.pendingNewIndices ) {\n\t\t\tthis.updatePostShuffle();\n\t\t\treturn;\n\t\t}\n\n\t\tconst value = this.context.get();\n\n\t\tlet toRemove;\n\t\tlet oldKeys;\n\n\t\tif ( isArray( value ) ) {\n\t\t\tif ( this.iterations.length > value.length ) {\n\t\t\t\ttoRemove = this.iterations.splice( value.length );\n\t\t\t}\n\t\t} else if ( isObject( value ) ) {\n\t\t\ttoRemove = [];\n\t\t\toldKeys = {};\n\t\t\tlet i = this.iterations.length;\n\n\t\t\twhile ( i-- ) {\n\t\t\t\tconst fragment = this.iterations[i];\n\t\t\t\tif ( fragment.key in value ) {\n\t\t\t\t\toldKeys[ fragment.key ] = true;\n\t\t\t\t} else {\n\t\t\t\t\tthis.iterations.splice( i, 1 );\n\t\t\t\t\ttoRemove.push( fragment );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\ttoRemove = this.iterations;\n\t\t\tthis.iterations = [];\n\t\t}\n\n\t\tif ( toRemove ) {\n\t\t\ttoRemove.forEach( fragment => {\n\t\t\t\tfragment.unbind();\n\t\t\t\tfragment.unrender( true );\n\t\t\t});\n\t\t}\n\n\t\t// update the remaining ones\n\t\tthis.iterations.forEach( update );\n\n\t\t// add new iterations\n\t\tconst newLength = isArray( value ) ?\n\t\t\tvalue.length :\n\t\t\tisObject( value ) ?\n\t\t\t\tObject.keys( value ).length :\n\t\t\t\t0;\n\n\t\tif ( newLength > this.iterations.length ) {\n\t\t\tconst docFrag = this.rendered ? createDocumentFragment() : null;\n\t\t\tlet i = this.iterations.length;\n\n\t\t\tif ( isArray( value ) ) {\n\t\t\t\twhile ( i < value.length ) {\n\t\t\t\t\tconst fragment = this.createIteration( i, i );\n\n\t\t\t\t\tthis.iterations.push( fragment );\n\t\t\t\t\tif ( this.rendered ) fragment.render( docFrag );\n\n\t\t\t\t\ti += 1;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\telse if ( isObject( value ) ) {\n\t\t\t\tObject.keys( value ).forEach( key => {\n\t\t\t\t\tif ( !( key in oldKeys ) ) {\n\t\t\t\t\t\tconst fragment = this.createIteration( key, i );\n\n\t\t\t\t\t\tthis.iterations.push( fragment );\n\t\t\t\t\t\tif ( this.rendered ) fragment.render( docFrag );\n\n\t\t\t\t\t\ti += 1;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif ( this.rendered ) {\n\t\t\t\tconst parentNode = this.parent.findParentNode();\n\t\t\t\tconst anchor = this.parent.findNextNode( this );\n\n\t\t\t\tparentNode.insertBefore( docFrag, anchor );\n\t\t\t}\n\t\t}\n\t}\n\n\tupdatePostShuffle () {\n\t\tconst newIndices = this.pendingNewIndices;\n\n\t\t// This algorithm (for detaching incorrectly-ordered fragments from the DOM and\n\t\t// storing them in a document fragment for later reinsertion) seems a bit hokey,\n\t\t// but it seems to work for now\n\t\tlet previousNewIndex = -1;\n\t\tlet reinsertFrom = null;\n\n\t\tnewIndices.forEach( ( newIndex, oldIndex ) => {\n\t\t\tconst fragment = this.previousIterations[ oldIndex ];\n\n\t\t\tif ( newIndex === -1 ) {\n\t\t\t\tfragment.unbind().unrender( true );\n\t\t\t} else {\n\t\t\t\tfragment.index = newIndex;\n\t\t\t\tfragment.rebind( this.context.joinKey( newIndex ) );\n\n\t\t\t\tif ( reinsertFrom === null && ( newIndex !== previousNewIndex + 1 ) ) {\n\t\t\t\t\treinsertFrom = oldIndex;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tpreviousNewIndex = newIndex;\n\t\t});\n\n\t\t// create new iterations\n\t\tconst docFrag = this.rendered ? createDocumentFragment() : null;\n\t\tconst parentNode = this.rendered ? this.parent.findParentNode() : null;\n\n\t\tconst len = this.context.get().length;\n\t\tlet i;\n\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tlet existingFragment = this.iterations[i];\n\n\t\t\tif ( this.rendered ) {\n\t\t\t\tif ( existingFragment ) {\n\t\t\t\t\tif ( reinsertFrom !== null && i >= reinsertFrom ) {\n\t\t\t\t\t\tdocFrag.appendChild( existingFragment.detach() );\n\t\t\t\t\t}\n\n\t\t\t\t\telse if ( docFrag.childNodes.length ) {\n\t\t\t\t\t\tparentNode.insertBefore( docFrag, existingFragment.firstNode() );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.iterations[i] = this.createIteration( i, i );\n\t\t\t\t\tthis.iterations[i].render( docFrag );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( !this.rendered ) {\n\t\t\t\tif ( !existingFragment ) {\n\t\t\t\t\tthis.iterations[i] = this.createIteration( i, i );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ( this.rendered && docFrag.childNodes.length ) {\n\t\t\tparentNode.insertBefore( docFrag, this.owner.findNextNode() );\n\t\t}\n\n\t\tthis.iterations.forEach( update );\n\n\t\tthis.pendingNewIndices = null;\n\t}\n}\n","import { createDocumentFragment } from 'utils/dom';\nimport { SECTION_EACH, SECTION_IF, SECTION_IF_WITH, SECTION_UNLESS, SECTION_WITH } from 'config/types';\nimport { isArray, isObject } from 'utils/is';\nimport Fragment from '../Fragment';\nimport RepeatedFragment from '../RepeatedFragment';\nimport Mustache from './shared/Mustache';\n\nfunction isEmpty ( value ) {\n\treturn !value ||\n\t       ( isArray( value ) && value.length === 0 ) ||\n\t\t   ( isObject( value ) && Object.keys( value ).length === 0 );\n}\n\nfunction getType ( value, hasIndexRef ) {\n\tif ( hasIndexRef || isArray( value ) ) return SECTION_EACH;\n\tif ( isObject( value ) || typeof value === 'function' ) return SECTION_WITH;\n\tif ( value === undefined ) return null;\n\treturn SECTION_IF;\n}\n\nexport default class Section extends Mustache {\n\tconstructor ( options ) {\n\t\tsuper( options );\n\n\t\tthis.sectionType = options.template.n || null;\n\t\tthis.fragment = null;\n\t}\n\n\tbind () {\n\t\tsuper.bind();\n\n\t\t// if we managed to bind, we need to create children\n\t\tif ( this.model ) {\n\t\t\tconst value = this.model.value; // TODO should use this.model.get()... but weirdness around root models\n\t\t\tlet fragment;\n\n\t\t\tif ( !this.sectionType ) this.sectionType = getType( value, this.template.i );\n\n\t\t\tif ( isEmpty( value ) && this.sectionType !== SECTION_WITH ) { // TODO again, WITH should not render if empty\n\t\t\t\tif ( this.sectionType === SECTION_UNLESS ) {\n\t\t\t\t\tthis.fragment = new Fragment({\n\t\t\t\t\t\towner: this,\n\t\t\t\t\t\ttemplate: this.template.f\n\t\t\t\t\t}).bind();\n\t\t\t\t}\n\n\t\t\t\t// otherwise, create no children\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( this.sectionType === SECTION_UNLESS ) return;\n\n\t\t\tif ( this.sectionType === SECTION_IF ) {\n\t\t\t\tfragment = new Fragment({\n\t\t\t\t\towner: this,\n\t\t\t\t\ttemplate: this.template.f\n\t\t\t\t}).bind();\n\t\t\t}\n\n\t\t\t// TODO should only be WITH, and it should behave like IF_WITH\n\t\t\telse if ( this.sectionType === SECTION_WITH || this.sectionType === SECTION_IF_WITH ) {\n\t\t\t\tfragment = new Fragment({\n\t\t\t\t\towner: this,\n\t\t\t\t\ttemplate: this.template.f\n\t\t\t\t}).bind( this.model );\n\t\t\t}\n\n\t\t\telse {\n\t\t\t\tfragment = new RepeatedFragment({\n\t\t\t\t\towner: this,\n\t\t\t\t\ttemplate: this.template.f,\n\t\t\t\t\tindexRef: this.template.i\n\t\t\t\t}).bind( this.model );\n\t\t\t}\n\n\n\t\t\tthis.fragment = fragment;\n\t\t}\n\t}\n\n\tdetach () {\n\t\treturn this.fragment ? this.fragment.detach() : createDocumentFragment();\n\t}\n\n\tfind ( selector ) {\n\t\tif ( this.fragment ) {\n\t\t\treturn this.fragment.find( selector );\n\t\t}\n\t}\n\n\tfindAll ( selector, query ) {\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.findAll( selector, query );\n\t\t}\n\t}\n\n\tfindComponent ( name ) {\n\t\tif ( this.fragment ) {\n\t\t\treturn this.fragment.findComponent( name );\n\t\t}\n\t}\n\n\tfindAllComponents ( name, query ) {\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.findAllComponents( name, query );\n\t\t}\n\t}\n\n\tfirstNode () {\n\t\treturn this.fragment && this.fragment.firstNode();\n\t}\n\n\trebind () {\n\t\tsuper.rebind();\n\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.rebind( this.sectionType === SECTION_IF ? null : this.model );\n\t\t}\n\t}\n\n\trender ( target ) {\n\t\tthis.rendered = true;\n\t\tif ( this.fragment ) this.fragment.render( target );\n\t}\n\n\tshuffle ( newIndices ) {\n\t\tif ( this.fragment && this.sectionType === SECTION_EACH ) {\n\t\t\tthis.fragment.shuffle( newIndices );\n\t\t}\n\t}\n\n\ttoString ( escape ) {\n\t\treturn this.fragment ? this.fragment.toString( escape ) : '';\n\t}\n\n\tunbind () {\n\t\tsuper.unbind();\n\t\tif ( this.fragment ) this.fragment.unbind();\n\t}\n\n\tunrender ( shouldDestroy ) {\n\t\tif ( this.rendered && this.fragment ) this.fragment.unrender( shouldDestroy );\n\t\tthis.rendered = false;\n\t}\n\n\t// TODO DRY this out - lot of repeated stuff between this and bind()\n\tupdate () {\n\t\tif ( !this.dirty ) return;\n\t\tif ( !this.model ) return; // TODO can this happen?\n\n\t\tconst value = this.model.value; // TODO see above - should use .get()\n\n\t\tif ( this.sectionType === null ) this.sectionType = getType( value, this.template.i );\n\n\t\tlet newFragment;\n\n\t\tif ( this.sectionType === SECTION_EACH ) {\n\t\t\tif ( this.fragment ) {\n\t\t\t\tthis.fragment.update();\n\t\t\t} else {\n\t\t\t\t// TODO can this happen?\n\t\t\t\tnewFragment = new RepeatedFragment({\n\t\t\t\t\towner: this,\n\t\t\t\t\ttemplate: this.template.f,\n\t\t\t\t\tindexRef: this.template.i\n\t\t\t\t}).bind( this.model );\n\t\t\t}\n\t\t}\n\n\t\t// TODO same comment as before - WITH should be IF_WITH\n\t\telse if ( this.sectionType === SECTION_WITH ) {\n\t\t\tif ( this.fragment ) {\n\t\t\t\tthis.fragment.update();\n\t\t\t} else {\n\t\t\t\tnewFragment = new Fragment({\n\t\t\t\t\towner: this,\n\t\t\t\t\ttemplate: this.template.f\n\t\t\t\t}).bind( this.model );\n\t\t\t}\n\t\t}\n\n\t\telse if ( this.sectionType === SECTION_IF_WITH ) {\n\t\t\tif ( this.fragment ) {\n\t\t\t\tif ( isEmpty( value ) ) {\n\t\t\t\t\tif ( this.rendered ) {\n\t\t\t\t\t\tthis.fragment.unbind().unrender( true );\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.fragment = null;\n\t\t\t\t} else {\n\t\t\t\t\tthis.fragment.update();\n\t\t\t\t}\n\t\t\t} else if ( !isEmpty( value ) ) {\n\t\t\t\tnewFragment = new Fragment({\n\t\t\t\t\towner: this,\n\t\t\t\t\ttemplate: this.template.f\n\t\t\t\t}).bind( this.model );\n\t\t\t}\n\t\t}\n\n\t\telse {\n\t\t\tconst fragmentShouldExist = this.sectionType === SECTION_UNLESS ? isEmpty( value ) : !!value;\n\n\t\t\tif ( this.fragment ) {\n\t\t\t\tif ( fragmentShouldExist ) {\n\t\t\t\t\tthis.fragment.update();\n\t\t\t\t} else {\n\t\t\t\t\tif ( this.rendered ) {\n\t\t\t\t\t\tthis.fragment.unbind().unrender( true );\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.fragment = null;\n\t\t\t\t}\n\t\t\t} else if ( fragmentShouldExist ) {\n\t\t\t\tnewFragment = new Fragment({\n\t\t\t\t\towner: this,\n\t\t\t\t\ttemplate: this.template.f\n\t\t\t\t}).bind( null );\n\t\t\t}\n\t\t}\n\n\t\tif ( newFragment ) {\n\t\t\tif ( this.rendered ) {\n\t\t\t\tconst parentNode = this.parentFragment.findParentNode();\n\t\t\t\tconst anchor = this.parentFragment.findNextNode( this );\n\n\t\t\t\tif ( anchor ) {\n\t\t\t\t\tconst docFrag = createDocumentFragment();\n\t\t\t\t\tnewFragment.render( docFrag );\n\n\t\t\t\t\t// we use anchor.parentNode, not parentNode, because the sibling\n\t\t\t\t\t// may be temporarily detached as a result of a shuffle\n\t\t\t\t\tanchor.parentNode.insertBefore( docFrag, anchor );\n\t\t\t\t} else {\n\t\t\t\t\tnewFragment.render( parentNode );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.fragment = newFragment;\n\t\t}\n\n\t\tthis.dirty = false;\n\t}\n}\n","import Element from '../../Element';\nimport runloop from 'global/runloop';\nimport { toArray } from 'utils/array';\n\nfunction valueContains ( selectValue, optionValue ) {\n\tlet i = selectValue.length;\n\twhile ( i-- ) {\n\t\tif ( selectValue[i] == optionValue ) return true;\n\t}\n}\n\nexport default class Select extends Element {\n\tconstructor ( options ) {\n\t\tsuper( options );\n\t\tthis.options = [];\n\t}\n\n\tbubble () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.dirty = true;\n\n\t\t\tif ( this.rendered ) {\n\t\t\t\trunloop.scheduleTask( () => {\n\t\t\t\t\tthis.sync();\n\t\t\t\t\tthis.dirty = false;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.parentFragment.bubble(); // default behaviour\n\t\t}\n\t}\n\n\trender ( target ) {\n\t\tsuper.render( target );\n\t\tthis.sync();\n\n\t\tconst node = this.node;\n\n\t\tlet i = node.options.length;\n\t\twhile ( i-- ) {\n\t\t\tnode.options[i].defaultSelected = node.options[i].selected;\n\t\t}\n\n\t\tthis.rendered = true;\n\t}\n\n\tsync () {\n\t\tconst selectNode = this.node;\n\n\t\tif ( !selectNode ) return;\n\n\t\tconst options = toArray( selectNode.options );\n\n\t\tconst selectValue = this.getAttribute( 'value' );\n\t\tconst isMultiple = this.getAttribute( 'multiple' );\n\n\t\t// If the <select> has a specified value, that should override\n\t\t// these options\n\t\tif ( selectValue !== undefined ) {\n\t\t\tlet optionWasSelected;\n\n\t\t\toptions.forEach( o => {\n\t\t\t\tconst optionValue = o._ractive ? o._ractive.value : o.value;\n\t\t\t\tconst shouldSelect = isMultiple ? valueContains( selectValue, optionValue ) : selectValue == optionValue;\n\n\t\t\t\tif ( shouldSelect ) {\n\t\t\t\t\toptionWasSelected = true;\n\t\t\t\t}\n\n\t\t\t\to.selected = shouldSelect;\n\t\t\t});\n\n\t\t\tif ( !optionWasSelected && !isMultiple ) {\n\t\t\t\tif ( options[0] ) {\n\t\t\t\t\toptions[0].selected = true;\n\t\t\t\t}\n\n\t\t\t\tif ( this.binding ) {\n\t\t\t\t\tthis.binding.forceUpdate();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Otherwise the value should be initialised according to which\n\t\t// <option> element is selected, if twoway binding is in effect\n\t\telse if ( this.binding ) {\n\t\t\tthis.binding.forceUpdate();\n\t\t}\n\t}\n\n\tupdate () {\n\t\tsuper.update();\n\t\tthis.sync();\n\t}\n}\n","import { doc } from 'config/environment';\nimport { TEXT } from 'config/types';\nimport { escapeHtml } from 'utils/html';\nimport Item from './shared/Item';\n\nexport default class Text extends Item {\n\tconstructor ( options ) {\n\t\tsuper( options );\n\t\tthis.type = TEXT;\n\t}\n\n\tbind () {\n\t\t// noop\n\t}\n\n\tdetach () {\n\t\tif ( !this.node.parentNode ) {\n\t\t\tthrow new Error( 'TODO an unexpected situation arose' );\n\t\t}\n\t\treturn this.node.parentNode.removeChild( this.node );\n\t}\n\n\tfirstNode () {\n\t\treturn this.node;\n\t}\n\n\trebind () {\n\t\t// noop\n\t}\n\n\trender ( target ) {\n\t\tthis.node = doc.createTextNode( this.template );\n\t\ttarget.appendChild( this.node );\n\t\tthis.rendered = true;\n\t}\n\n\ttoString ( escape ) {\n\t\treturn escape ? escapeHtml( this.template ) : this.template;\n\t}\n\n\tunbind () {\n\t\t// noop\n\t}\n\n\tunrender ( shouldDestroy ) {\n\t\tif ( this.rendered && shouldDestroy ) this.detach();\n\t\tthis.rendered = false;\n\t}\n\n\tupdate () {\n\t\t// noop\n\t}\n\n\tvalueOf () {\n\t\treturn this.template;\n\t}\n}\n","import { svg } from 'config/namespaces';\nimport { createElement } from 'utils/dom';\n\nvar elementCache = {}, ieBug, ieBlacklist;\n\ntry {\n\tcreateElement( 'table' ).innerHTML = 'foo';\n} catch ( err ) {\n\tieBug = true;\n\n\tieBlacklist = {\n\t\tTABLE:  [ '<table class=\"x\">', '</table>' ],\n\t\tTHEAD:  [ '<table><thead class=\"x\">', '</thead></table>' ],\n\t\tTBODY:  [ '<table><tbody class=\"x\">', '</tbody></table>' ],\n\t\tTR:     [ '<table><tr class=\"x\">', '</tr></table>' ],\n\t\tSELECT: [ '<select class=\"x\">', '</select>' ]\n\t};\n}\n\nexport default function ( html, node, docFrag ) {\n\tvar container, nodes = [], wrapper, selectedOption, child, i;\n\n\t// render 0 and false\n\tif ( html != null && html !== '' ) {\n\t\tif ( ieBug && ( wrapper = ieBlacklist[ node.tagName ] ) ) {\n\t\t\tcontainer = element( 'DIV' );\n\t\t\tcontainer.innerHTML = wrapper[0] + html + wrapper[1];\n\t\t\tcontainer = container.querySelector( '.x' );\n\n\t\t\tif ( container.tagName === 'SELECT' ) {\n\t\t\t\tselectedOption = container.options[ container.selectedIndex ];\n\t\t\t}\n\t\t}\n\n\t\telse if ( node.namespaceURI === svg ) {\n\t\t\tcontainer = element( 'DIV' );\n\t\t\tcontainer.innerHTML = '<svg class=\"x\">' + html + '</svg>';\n\t\t\tcontainer = container.querySelector( '.x' );\n\t\t}\n\n\t\telse {\n\t\t\tcontainer = element( node.tagName );\n\t\t\tcontainer.innerHTML = html;\n\n\t\t\tif ( container.tagName === 'SELECT' ) {\n\t\t\t\tselectedOption = container.options[ container.selectedIndex ];\n\t\t\t}\n\t\t}\n\n\t\twhile ( child = container.firstChild ) {\n\t\t\tnodes.push( child );\n\t\t\tdocFrag.appendChild( child );\n\t\t}\n\n\t\t// This is really annoying. Extracting <option> nodes from the\n\t\t// temporary container <select> causes the remaining ones to\n\t\t// become selected. So now we have to deselect them. IE8, you\n\t\t// amaze me. You really do\n\t\t// ...and now Chrome too\n\t\tif ( node.tagName === 'SELECT' ) {\n\t\t\ti = nodes.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( nodes[i] !== selectedOption ) {\n\t\t\t\t\tnodes[i].selected = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn nodes;\n}\n\nfunction element ( tagName ) {\n\treturn elementCache[ tagName ] || ( elementCache[ tagName ] = createElement( tagName ) );\n}\n","import { createDocumentFragment, matches } from 'utils/dom';\nimport Mustache from './shared/Mustache';\nimport insertHtml from './triple/insertHtml';\nimport { decodeCharacterReferences } from 'utils/html';\n\nexport default class Triple extends Mustache {\n\tconstructor ( options ) {\n\t\tsuper( options );\n\t}\n\n\tdetach () {\n\t\tconst docFrag = createDocumentFragment();\n\t\tthis.nodes.forEach( node => docFrag.appendChild( node ) );\n\t\treturn docFrag;\n\t}\n\n\tfind ( selector ) {\n\t\tconst len = this.nodes.length;\n\t\tlet i;\n\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tconst node = this.nodes[i];\n\n\t\t\tif ( node.nodeType !== 1 ) continue;\n\n\t\t\tif ( matches( node, selector ) ) return node;\n\n\t\t\tconst queryResult = node.querySelector( selector );\n\t\t\tif ( queryResult ) return queryResult;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tfindAll ( selector, query ) {\n\t\tconst len = this.nodes.length;\n\t\tlet i;\n\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tconst node = this.nodes[i];\n\n\t\t\tif ( node.nodeType !== 1 ) continue;\n\n\t\t\tif ( query.test( node ) ) query.add( node );\n\n\t\t\tconst queryAllResult = node.querySelectorAll( selector );\n\t\t\tif ( queryAllResult ) {\n\t\t\t\tconst numNodes = queryAllResult.length;\n\t\t\t\tlet j;\n\n\t\t\t\tfor ( j = 0; j < numNodes; j += 1 ) {\n\t\t\t\t\tquery.add( queryAllResult[j] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfindComponent () {\n\t\treturn null;\n\t}\n\n\tfirstNode () {\n\t\treturn this.nodes[0];\n\t}\n\n\trender ( target ) {\n\t\tconst html = this.model ? this.model.get() : '';\n\t\tthis.nodes = insertHtml( html, this.parentFragment.findParentNode(), target );\n\t\tthis.rendered = true;\n\t}\n\n\ttoString () {\n\t\treturn this.model && this.model.get() != null ? decodeCharacterReferences( '' + this.model.get() ) : '';\n\t}\n\n\tunrender () {\n\t\tif ( this.nodes ) this.nodes.forEach( node => node.parentNode.removeChild( node ) );\n\t\tthis.rendered = false;\n\t}\n\n\tupdate () {\n\t\tif ( this.rendered && this.dirty ) {\n\t\t\tthis.unrender();\n\t\t\tconst docFrag = createDocumentFragment();\n\t\t\tthis.render( docFrag );\n\n\t\t\tconst parentNode = this.parentFragment.findParentNode();\n\t\t\tconst anchor = this.parentFragment.findNextNode( this );\n\n\t\t\tparentNode.insertBefore( docFrag, anchor );\n\n\t\t\tthis.dirty = false;\n\t\t}\n\t}\n}\n","import Item from './shared/Item';\nimport Fragment from '../Fragment';\nimport parse from 'parse/_parse';\nimport { warnIfDebug } from 'utils/log';\nimport { removeFromArray } from 'utils/array';\n\nexport default class Yielder extends Item {\n\tconstructor ( options ) {\n\t\tsuper( options );\n\n\t\tthis.container = options.parentFragment.ractive;\n\t\tthis.component = this.container.component;\n\n\t\tthis.containerFragment = options.parentFragment;\n\t\tthis.parentFragment = this.component.parentFragment;\n\n\t\t// {{yield}} is equivalent to {{yield content}}\n\t\tthis.name = options.template.n || '';\n\t}\n\n\tbind () {\n\t\tconst name = this.name;\n\n\t\t( this.component.yielders[ name ] || ( this.component.yielders[ name ] = [] ) ).push( this );\n\n\t\t// TODO don't parse here\n\t\tlet template = this.container._inlinePartials[ name || 'content' ];\n\n\t\tif ( typeof template === 'string' ) {\n\t\t\ttemplate = parse( template ).t;\n\t\t}\n\n\t\tif ( !template ) {\n\t\t\twarnIfDebug( `Could not find template for partial \"${name}\"`, { ractive: this.ractive });\n\t\t\ttemplate = [];\n\t\t}\n\n\t\tthis.fragment = new Fragment({\n\t\t\towner: this,\n\t\t\tractive: this.container.parent,\n\t\t\ttemplate\n\t\t}).bind();\n\t}\n\n\tdetach () {\n\t\treturn this.fragment.detach();\n\t}\n\n\tfind ( selector ) {\n\t\treturn this.fragment.find( selector );\n\t}\n\n\tfindAll ( selector, queryResult ) {\n\t\tthis.fragment.find( selector, queryResult );\n\t}\n\n\tfindComponent ( name ) {\n\t\treturn this.fragment.findComponent( name );\n\t}\n\n\tfindAllComponents ( name, queryResult ) {\n\t\tthis.fragment.findAllComponents( name, queryResult );\n\t}\n\n\tfirstNode () {\n\t\treturn this.fragment.firstNode();\n\t}\n\n\trebind () {\n\t\tthrow new Error( 'Yielder$rebind is not yet implemented!' );\n\t}\n\n\trender ( target ) {\n\t\treturn this.fragment.render( target );\n\t}\n\n\tsetTemplate ( name ) {\n\t\tlet template = this.parentFragment.ractive.partials[ name ];\n\n\t\tif ( typeof template === 'string' ) {\n\t\t\ttemplate = parse( template ).t;\n\t\t}\n\n\t\tthis.partialTemplate = template || []; // TODO warn on missing partial\n\t}\n\n\ttoString ( escape ) {\n\t\treturn this.fragment.toString( escape );\n\t}\n\n\tunbind () {\n\t\tthis.fragment.unbind();\n\t\tremoveFromArray( this.component.yielders[ this.name ], this );\n\t}\n\n\tunrender ( shouldDestroy ) {\n\t\tthis.fragment.unrender( shouldDestroy );\n\t}\n}\n","import { DOCTYPE, ELEMENT, INTERPOLATOR, PARTIAL, SECTION, TRIPLE, YIELDER } from '../../config/types';\nimport Component from './Component';\nimport Doctype from './Doctype';\nimport Form from './element/specials/Form';\nimport Element from './Element';\nimport Interpolator from './Interpolator';\nimport Input from './element/specials/Input';\nimport Option from './element/specials/Option';\nimport Partial from './Partial';\nimport Section from './Section';\nimport Select from './element/specials/Select';\nimport Text from './Text';\nimport Triple from './Triple';\nimport Yielder from './Yielder';\nimport getComponentConstructor from './component/getComponentConstructor';\n\nconst constructors = {\n\t[ DOCTYPE ]: Doctype,\n\t[ INTERPOLATOR ]: Interpolator,\n\t[ PARTIAL ]: Partial,\n\t[ SECTION ]: Section,\n\t[ TRIPLE ]: Triple,\n\t[ YIELDER ]: Yielder\n};\n\nconst specialElements = {\n\tdoctype: Doctype,\n\tform: Form,\n\tinput: Input,\n\toption: Option,\n\tselect: Select,\n\ttextarea: Input // it may turn out we need a separate Textarea class, but until then...\n};\n\nexport default function createItem ( options ) {\n\tif ( typeof options.template === 'string' ) {\n\t\treturn new Text( options );\n\t}\n\n\tif ( options.template.t === ELEMENT ) {\n\t\t// could be component or element\n\t\tconst ComponentConstructor = getComponentConstructor( options.parentFragment.ractive, options.template.e );\n\t\tif ( ComponentConstructor ) {\n\t\t\treturn new Component( options, ComponentConstructor );\n\t\t}\n\n\t\tconst tagName = options.template.e.toLowerCase();\n\n\t\tconst ElementConstructor = specialElements[ tagName ] || Element;\n\t\treturn new ElementConstructor( options );\n\t}\n\n\tconst Item = constructors[ options.template.t ];\n\n\tif ( !Item ) throw new Error( `Unrecognised item type ${options.template.t}` );\n\n\treturn new Item( options );\n}\n","import { normalise } from 'shared/keypaths';\nimport { removeFromArray } from 'utils/array';\nimport resolveAmbiguousReference from './resolveAmbiguousReference';\n\nexport default class ReferenceResolver {\n\tconstructor ( fragment, reference, callback ) {\n\t\tthis.fragment = fragment;\n\t\tthis.reference = normalise( reference );\n\t\tthis.callback = callback;\n\n\t\tthis.keys = reference.split( '.' );\n\t\tthis.resolved = false;\n\n\t\t// TODO the consumer should take care of addUnresolved\n\t\t// we attach to all the contexts between here and the root\n\t\t// - whenever their values change, they can quickly\n\t\t// check to see if we can resolve\n\t\twhile ( fragment ) {\n\t\t\tif ( fragment.context ) {\n\t\t\t\tfragment.context.addUnresolved( this.keys[0], this );\n\t\t\t}\n\n\t\t\tfragment = fragment.componentParent || fragment.parent;\n\t\t}\n\t}\n\n\tattemptResolution () {\n\t\tif ( this.resolved ) return;\n\n\t\tconst model = resolveAmbiguousReference( this.fragment, this.reference );\n\n\t\tif ( model ) {\n\t\t\tthis.resolved = true;\n\t\t\tthis.callback( model );\n\t\t}\n\t}\n\n\tforceResolution () {\n\t\tif ( this.resolved ) return;\n\n\t\tconst model = this.fragment.findContext().joinAll( this.keys );\n\t\tthis.callback( model );\n\t\tthis.resolved = true;\n\t}\n\n\tunbind () {\n\t\tremoveFromArray( this.fragment.unresolved, this );\n\t}\n}\n","import { ELEMENT } from 'config/types';\nimport runloop from 'global/runloop';\nimport createItem from './items/createItem';\nimport ReferenceResolver from './resolvers/ReferenceResolver';\nimport { bind, rebind, toEscapedString, toString, unbind, unrender, update } from 'shared/methodCallers';\nimport processItems from './helpers/processItems';\nimport parseJSON from 'utils/parseJSON';\nimport { createDocumentFragment } from 'utils/dom';\n\nfunction unrenderAndDestroy ( item ) {\n\titem.unrender( true );\n}\n\nexport default class Fragment {\n\tconstructor ( options ) {\n\t\tthis.owner = options.owner; // The item that owns this fragment - an element, section, partial, or attribute\n\n\t\tthis.isRoot = !options.owner.parentFragment;\n\t\tthis.parent = this.isRoot ? null : this.owner.parentFragment;\n\t\tthis.ractive = options.ractive || ( this.isRoot ? options.owner : this.parent.ractive );\n\n\t\tthis.componentParent = ( this.isRoot && this.ractive.component ) ? this.ractive.component.parentFragment : null;\n\n\t\tthis.context = null;\n\t\tthis.rendered = false;\n\t\tthis.indexRefs = options.indexRefs || ( this.parent ? this.parent.indexRefs : [] );\n\t\tthis.keyRefs = options.keyRefs || ( this.parent ? this.parent.keyRefs : {} );\n\n\t\t// encapsulated styles should be inherited until they get applied by an element\n\t\tthis.cssIds = 'cssIds' in options ? options.cssIds : ( this.parent ? this.parent.cssIds : null );\n\n\t\tthis.resolvers = [];\n\n\t\tthis.dirty = false;\n\t\tthis.dirtyArgs = this.dirtyValue = true; // TODO getArgsList is nonsense - should deprecate legacy directives style\n\n\t\tthis.template = options.template || [];\n\t\tthis.createItems();\n\t}\n\n\tbind ( context ) {\n\t\tthis.context = context;\n\t\tthis.items.forEach( bind );\n\t\tthis.bound = true;\n\n\t\t// in rare cases, a forced resolution (or similar) will cause the\n\t\t// fragment to be dirty before it's even finished binding. In those\n\t\t// cases we update immediately\n\t\tif ( this.dirty ) this.update();\n\n\t\treturn this;\n\t}\n\n\tbubble () {\n\t\tthis.dirtyArgs = this.dirtyValue = true;\n\n\t\tif ( !this.dirty ) {\n\t\t\tthis.dirty = true;\n\n\t\t\tif ( this.isRoot ) { // TODO encapsulate 'is component root, but not overall root' check?\n\t\t\t\tif ( this.ractive.component ) {\n\t\t\t\t\tthis.ractive.component.bubble();\n\t\t\t\t} else if ( this.bound ) {\n\t\t\t\t\trunloop.addFragment( this );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.owner.bubble();\n\t\t\t}\n\t\t}\n\t}\n\n\tcreateItems () {\n\t\tthis.items = this.template.map( ( template, index ) => {\n\t\t\treturn createItem({ parentFragment: this, template, index });\n\t\t});\n\t}\n\n\tdetach () {\n\t\tconst docFrag = createDocumentFragment();\n\t\tthis.items.forEach( item => docFrag.appendChild( item.detach() ) );\n\t\treturn docFrag;\n\t}\n\n\tfind ( selector ) {\n\t\tconst len = this.items.length;\n\t\tlet i;\n\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tconst found = this.items[i].find( selector );\n\t\t\tif ( found ) return found;\n\t\t}\n\t}\n\n\tfindAll ( selector, query ) {\n\t\tif ( this.items ) {\n\t\t\tconst len = this.items.length;\n\t\t\tlet i;\n\n\t\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\t\tconst item = this.items[i];\n\n\t\t\t\tif ( item.findAll ) {\n\t\t\t\t\titem.findAll( selector, query );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn query;\n\t}\n\n\tfindComponent ( name ) {\n\t\tconst len = this.items.length;\n\t\tlet i;\n\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tconst found = this.items[i].findComponent( name );\n\t\t\tif ( found ) return found;\n\t\t}\n\t}\n\n\tfindAllComponents ( name, query ) {\n\t\tif ( this.items ) {\n\t\t\tconst len = this.items.length;\n\t\t\tlet i;\n\n\t\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\t\tconst item = this.items[i];\n\n\t\t\t\tif ( item.findAllComponents ) {\n\t\t\t\t\titem.findAllComponents( name, query );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn query;\n\t}\n\n\tfindContext () {\n\t\tlet fragment = this;\n\t\twhile ( !fragment.context ) fragment = fragment.parent;\n\t\treturn fragment.context;\n\t}\n\n\tfindNextNode ( item ) {\n\t\tconst nextItem = this.items[ item.index + 1 ];\n\n\t\tif ( nextItem ) return nextItem.firstNode();\n\n\t\t// if this is the root fragment, and there are no more items,\n\t\t// it means we're at the end...\n\t\tif ( this.isRoot ) {\n\t\t\tif ( this.ractive.component ) {\n\t\t\t\treturn this.ractive.component.parentFragment.findNextNode( this.ractive.component );\n\t\t\t}\n\n\t\t\t// TODO possible edge case with other content\n\t\t\t// appended to this.ractive.el?\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.owner.findNextNode( this ); // the argument is in case the parent is a RepeatedFragment\n\t}\n\n\tfindParentNode () {\n\t\tlet fragment = this;\n\n\t\tdo {\n\t\t\tif ( fragment.owner.type === ELEMENT ) {\n\t\t\t\treturn fragment.owner.node;\n\t\t\t}\n\n\t\t\tif ( fragment.isRoot && !fragment.ractive.component ) { // TODO encapsulate check\n\t\t\t\treturn fragment.ractive.el;\n\t\t\t}\n\n\t\t\tfragment = fragment.componentParent || fragment.parent; // TODO ugh\n\t\t} while ( fragment );\n\n\t\tthrow new Error( 'Could not find parent node' ); // TODO link to issue tracker\n\t}\n\n\tfindRepeatingFragment () {\n\t\tlet fragment = this;\n\t\t// TODO better check than fragment.parent.iterations\n\t\twhile ( fragment.parent && !fragment.isIteration ) {\n\t\t\tfragment = fragment.parent || fragment.componentParent;\n\t\t}\n\n\t\treturn fragment;\n\t}\n\n\tfirstNode () {\n\t\treturn this.items[0] ? this.items[0].firstNode() : this.parent.findNextNode( this.owner );\n\t}\n\n\t// TODO ideally, this would be deprecated in favour of an\n\t// expression-like approach\n\tgetArgsList () {\n\t\tif ( this.dirtyArgs ) {\n\t\t\tconst values = {};\n\t\t\tconst source = processItems( this.items, values, this.ractive._guid );\n\t\t\tconst parsed = parseJSON( '[' + source + ']', values );\n\n\t\t\tthis.argsList = parsed ?\n\t\t\t\tparsed.value :\n\t\t\t\t[ this.toString() ];\n\n\t\t\tthis.dirtyArgs = false;\n\t\t}\n\n\t\treturn this.argsList;\n\t}\n\n\trebind ( context ) {\n\t\tthis.context = context;\n\n\t\tthis.items.forEach( rebind );\n\t}\n\n\trender ( target ) {\n\t\tif ( this.rendered ) throw new Error( 'Fragment is already rendered!' );\n\t\tthis.rendered = true;\n\n\t\tthis.items.forEach( item => item.render( target ) );\n\t}\n\n\tresetTemplate ( template ) {\n\t\tconst wasBound = this.bound;\n\t\tconst wasRendered = this.rendered;\n\n\t\t// TODO ensure transitions are disabled globally during reset\n\n\t\tif ( wasBound ) {\n\t\t\tif ( wasRendered ) this.unrender( true );\n\t\t\tthis.unbind();\n\t\t}\n\n\t\tthis.template = template;\n\t\tthis.createItems();\n\n\t\tif ( wasBound ) {\n\t\t\tthis.bind( this.context );\n\n\t\t\tif ( wasRendered ) {\n\t\t\t\tconst parentNode = this.findParentNode();\n\t\t\t\tconst anchor = this.parent ? this.parent.findNextNode( this.owner ) : null;\n\n\t\t\t\tif ( anchor ) {\n\t\t\t\t\tconst docFrag = createDocumentFragment();\n\t\t\t\t\tthis.render( docFrag );\n\t\t\t\t\tparentNode.insertBefore( docFrag, anchor );\n\t\t\t\t} else {\n\t\t\t\t\tthis.render( parentNode );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tresolve ( template, callback ) {\n\t\tif ( !this.context ) {\n\t\t\treturn this.parent.resolve( template, callback );\n\t\t}\n\n\t\tconst resolver = new ReferenceResolver( this, template, callback );\n\t\tthis.resolvers.push( resolver );\n\n\t\treturn resolver; // so we can e.g. force resolution\n\t}\n\n\ttoHtml () {\n\t\treturn this.toString();\n\t}\n\n\ttoString ( escape ) {\n\t\treturn this.items.map( escape ? toEscapedString : toString ).join( '' );\n\t}\n\n\tunbind () {\n\t\tthis.items.forEach( unbind );\n\t\tthis.bound = false;\n\n\t\treturn this;\n\t}\n\n\tunrender ( shouldDestroy ) {\n\t\tthis.items.forEach( shouldDestroy ? unrenderAndDestroy : unrender );\n\t\tthis.rendered = false;\n\t}\n\n\tupdate () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.items.forEach( update );\n\t\t\tthis.dirty = false;\n\t\t}\n\t}\n\n\tvalueOf () {\n\t\tif ( this.items.length === 1 ) {\n\t\t\treturn this.items[0].valueOf();\n\t\t}\n\n\t\tif ( this.dirtyValue ) {\n\t\t\tconst values = {};\n\t\t\tconst source = processItems( this.items, values, this.ractive._guid );\n\t\t\tconst parsed = parseJSON( source, values );\n\n\t\t\tthis.value = parsed ?\n\t\t\t\tparsed.value :\n\t\t\t\tthis.toString();\n\n\t\t\tthis.dirtyValue = false;\n\t\t}\n\n\t\treturn this.value;\n\t}\n}\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod( 'reverse' );\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod( 'shift' );\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod( 'sort' );\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod( 'splice' );\n","import Hook from 'events/Hook';\nimport Promise from 'utils/Promise';\nimport { removeFromArray } from 'utils/array';\nimport { cancel } from 'shared/methodCallers';\n\nvar teardownHook = new Hook( 'teardown' );\n\n// Teardown. This goes through the root fragment and all its children, removing observers\n// and generally cleaning up after itself\n\nexport default function Ractive$teardown () {\n\tvar promise;\n\n\tthis.fragment.unbind();\n\tthis.viewmodel.teardown();\n\n\tthis._observers.forEach( cancel );\n\n\tif ( this.fragment.rendered && this.el.__ractive_instances__ ) {\n\t\tremoveFromArray( this.el.__ractive_instances__, this );\n\t}\n\n\tthis.shouldDestroy = true;\n\tpromise = ( this.fragment.rendered ? this.unrender() : Promise.resolve() );\n\n\tteardownHook.fire( this );\n\n\tthis._boundFunctions.forEach( deleteFunctionCopy );\n\n\treturn promise;\n}\n\nfunction deleteFunctionCopy ( bound ) {\n\tdelete bound.fn[ bound.prop ];\n}\n","export default function Ractive$toHTML () {\n\treturn this.fragment.toString( true );\n}\n","import Hook from 'events/Hook';\nimport { warnIfDebug } from 'utils/log';\nimport Promise from 'utils/Promise';\nimport { removeFromArray } from 'utils/array';\nimport runloop from 'global/runloop';\n\nvar unrenderHook = new Hook( 'unrender' );\n\nexport default function Ractive$unrender () {\n\tvar promise, shouldDestroy;\n\n\tif ( !this.fragment.rendered ) {\n\t\twarnIfDebug( 'ractive.unrender() was called on a Ractive instance that was not rendered' );\n\t\treturn Promise.resolve();\n\t}\n\n\tpromise = runloop.start( this, true );\n\n\t// If this is a component, and the component isn't marked for destruction,\n\t// don't detach nodes from the DOM unnecessarily\n\tshouldDestroy = !this.component || this.component.shouldDestroy || this.shouldDestroy;\n\n\t// Cancel any animations in progress\n\twhile ( this._animations[0] ) {\n\t\tthis._animations[0].stop(); // it will remove itself from the index\n\t}\n\n\tthis.fragment.unrender( shouldDestroy );\n\n\tremoveFromArray( this.el.__ractive_instances__, this );\n\n\tunrenderHook.fire( this );\n\n\trunloop.end();\n\treturn promise;\n}\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod( 'unshift' );\n","import Hook from 'events/Hook';\nimport runloop from 'global/runloop';\nimport { splitKeypath } from 'shared/keypaths';\n\nvar updateHook = new Hook( 'update' );\n\nexport default function Ractive$update ( keypath ) {\n\tvar promise, model;\n\n\tmodel = keypath ?\n\t\tthis.viewmodel.joinAll( splitKeypath( keypath ) ) :\n\t\tthis.viewmodel;\n\n\tpromise = runloop.start( this, true );\n\tmodel.mark();\n\trunloop.end();\n\n\tupdateHook.fire( this, model );\n\n\treturn promise;\n}\n","import add from 'Ractive/prototype/add';\nimport animate from 'Ractive/prototype/animate';\nimport detach from 'Ractive/prototype/detach';\nimport find from 'Ractive/prototype/find';\nimport findAll from 'Ractive/prototype/findAll';\nimport findAllComponents from 'Ractive/prototype/findAllComponents';\nimport findComponent from 'Ractive/prototype/findComponent';\nimport findContainer from 'Ractive/prototype/findContainer';\nimport findParent from 'Ractive/prototype/findParent';\nimport fire from 'Ractive/prototype/fire';\nimport get from 'Ractive/prototype/get';\nimport insert from 'Ractive/prototype/insert';\nimport merge from 'Ractive/prototype/merge';\nimport observe from 'Ractive/prototype/observe';\nimport observeList from 'Ractive/prototype/observeList';\nimport observeOnce from 'Ractive/prototype/observeOnce';\nimport off from 'Ractive/prototype/off';\nimport on from 'Ractive/prototype/on';\nimport once from 'Ractive/prototype/once';\nimport pop from 'Ractive/prototype/pop';\nimport push from 'Ractive/prototype/push';\nimport render from 'Ractive/prototype/render';\nimport reset from 'Ractive/prototype/reset';\nimport resetPartial from 'Ractive/prototype/resetPartial';\nimport resetTemplate from 'Ractive/prototype/resetTemplate';\nimport reverse from 'Ractive/prototype/reverse';\nimport set from 'Ractive/prototype/set';\nimport shift from 'Ractive/prototype/shift';\nimport sort from 'Ractive/prototype/sort';\nimport splice from 'Ractive/prototype/splice';\nimport subtract from 'Ractive/prototype/subtract';\nimport teardown from 'Ractive/prototype/teardown';\nimport toggle from 'Ractive/prototype/toggle';\nimport toHTML from 'Ractive/prototype/toHTML';\nimport unrender from 'Ractive/prototype/unrender';\nimport unshift from 'Ractive/prototype/unshift';\nimport update from 'Ractive/prototype/update';\nimport updateModel from 'Ractive/prototype/updateModel';\n\nexport default {\n\tadd,\n\tanimate,\n\tdetach,\n\tfind,\n\tfindAll,\n\tfindAllComponents,\n\tfindComponent,\n\tfindContainer,\n\tfindParent,\n\tfire,\n\tget,\n\tinsert,\n\tmerge,\n\tobserve,\n\tobserveList,\n\tobserveOnce,\n\t// TODO reinstate these\n\t// observeListOnce,\n\toff,\n\ton,\n\tonce,\n\tpop,\n\tpush,\n\trender,\n\treset,\n\tresetPartial,\n\tresetTemplate,\n\treverse,\n\tset,\n\tshift,\n\tsort,\n\tsplice,\n\tsubtract,\n\tteardown,\n\ttoggle,\n\ttoHTML,\n\ttoHtml: toHTML,\n\tunrender,\n\tunshift,\n\tupdate,\n\tupdateModel\n};\n","export default function ( method, superMethod, force ) {\n\n\tif ( force || needsSuper( method, superMethod ) )  {\n\n\t\treturn function () {\n\n\t\t\tvar hasSuper = ( '_super' in this ), _super = this._super, result;\n\n\t\t\tthis._super = superMethod;\n\n\t\t\tresult = method.apply( this, arguments );\n\n\t\t\tif ( hasSuper ) {\n\t\t\t\tthis._super = _super;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t};\n\t}\n\n\telse {\n\t\treturn method;\n\t}\n}\n\nfunction needsSuper ( method, superMethod ) {\n\treturn typeof superMethod === 'function' && /_super/.test( method );\n}\n","import { create, defineProperties, extend as extendObj } from 'utils/object';\nimport config from 'Ractive/config/config';\nimport dataConfigurator from 'Ractive/config/custom/data';\nimport construct from 'Ractive/construct';\nimport initialise from 'Ractive/initialise';\nimport Ractive from 'Ractive';\nimport unwrapExtended from './unwrapExtended';\n\nexport default extend;\n\nfunction extend ( ...options ) {\n\tif( !options.length ) {\n\t\treturn extendOne( this );\n\t} else {\n\t\treturn options.reduce( extendOne, this );\n\t}\n}\n\nfunction extendOne ( Parent, options = {} ) {\n\tvar Child, proto;\n\n\t// if we're extending with another Ractive instance...\n\t//\n\t//   var Human = Ractive.extend(...), Spider = Ractive.extend(...);\n\t//   var Spiderman = Human.extend( Spider );\n\t//\n\t// ...inherit prototype methods and default options as well\n\tif ( options.prototype instanceof Ractive ) {\n\t\toptions = unwrapExtended( options );\n\t}\n\n\tChild = function ( options ) {\n\t\tif ( !( this instanceof Child ) ) return new Child( options );\n\n\t\tconstruct( this, options || {} );\n\t\tinitialise( this, options || {}, {} );\n\t};\n\n\tproto = create( Parent.prototype );\n\tproto.constructor = Child;\n\n\t// Static properties\n\tdefineProperties( Child, {\n\t\t// alias prototype as defaults\n\t\tdefaults: { value: proto },\n\n\t\t// extendable\n\t\textend: { value: extend, writable: true, configurable: true },\n\n\t\t// Parent - for IE8, can't use Object.getPrototypeOf\n\t\t_Parent: { value: Parent }\n\t});\n\n\t// extend configuration\n\tconfig.extend( Parent, proto, options );\n\n\tdataConfigurator.extend( Parent, proto, options );\n\n\tif ( options.computed ) {\n\t\tproto.computed = extendObj( create( Parent.prototype.computed ), options.computed );\n\t}\n\n\tChild.prototype = proto;\n\n\treturn Child;\n}\n","import { extend } from 'utils/object';\n\nexport default function( node ) {\n\tif ( !node || !node._ractive ) return {};\n\n\tconst storage = node._ractive;\n\n\treturn {\n\t\tractive: storage.ractive,\n\t\tkeypath: storage.context.getKeypath(),\n\t\tindex: extend( {}, storage.fragment.indexRefs ),\n\t\tkey: extend( {}, storage.fragment.keyRefs )\n\t};\n}\n","import defaults from 'Ractive/config/defaults';\nimport easing from 'Ractive/static/easing';\nimport interpolators from 'Ractive/static/interpolators';\nimport { magic, svg, win } from 'config/environment';\nimport { defineProperties, extend as extendObj } from 'utils/object';\nimport proto from 'Ractive/prototype';\nimport Promise from 'utils/Promise';\nimport extend from 'extend/_extend';\nimport parse from 'parse/_parse';\nimport getNodeInfo from 'Ractive/static/getNodeInfo';\nimport construct from 'Ractive/construct';\nimport initialise from 'Ractive/initialise';\n\n// Ractive.js makes liberal use of things like Array.prototype.indexOf. In\n// older browsers, these are made available via a shim - here, we do a quick\n// pre-flight check to make sure that either a) we're not in a shit browser,\n// or b) we're using a Ractive-legacy.js build\nconst FUNCTION = 'function';\n\nif (\n\ttypeof Date.now !== FUNCTION                 ||\n\ttypeof String.prototype.trim !== FUNCTION    ||\n\ttypeof Object.keys !== FUNCTION              ||\n\ttypeof Array.prototype.indexOf !== FUNCTION  ||\n\ttypeof Array.prototype.forEach !== FUNCTION  ||\n\ttypeof Array.prototype.map !== FUNCTION      ||\n\ttypeof Array.prototype.filter !== FUNCTION   ||\n\t( win && typeof win.addEventListener !== FUNCTION )\n) {\n\tthrow new Error( 'It looks like you\\'re attempting to use Ractive.js in an older browser. You\\'ll need to use one of the \\'legacy builds\\' in order to continue - see http://docs.ractivejs.org/latest/legacy-builds for more information.' );\n}\n\nexport default function Ractive ( options ) {\n\tif ( !( this instanceof Ractive ) ) return new Ractive( options );\n\n\tconstruct( this, options || {} );\n\tinitialise( this, options || {}, {} );\n}\n\nextendObj( Ractive.prototype, proto, defaults );\nRactive.prototype.constructor = Ractive;\n\n// alias prototype as `defaults`\nRactive.defaults = Ractive.prototype;\n\n// static properties\ndefineProperties( Ractive, {\n\n\t// debug flag\n\tDEBUG:          { writable: true, value: true },\n\tDEBUG_PROMISES: { writable: true, value: true },\n\n\t// static methods:\n\textend:         { value: extend },\n\tgetNodeInfo:    { value: getNodeInfo },\n\tparse:          { value: parse },\n\n\t// namespaced constructors\n\tPromise:        { value: Promise },\n\n\t// support\n\tsvg:            { value: svg },\n\tmagic:          { value: magic },\n\n\t// version\n\tVERSION:        { value: '<@version@>' },\n\n\t// plugins\n\tadaptors:       { writable: true, value: {} },\n\tcomponents:     { writable: true, value: {} },\n\tdecorators:     { writable: true, value: {} },\n\teasing:         { writable: true, value: easing },\n\tevents:         { writable: true, value: {} },\n\tinterpolators:  { writable: true, value: interpolators },\n\tpartials:       { writable: true, value: {} },\n\ttransitions:    { writable: true, value: {} }\n});\n","export default {\n\t'accept-charset': 'acceptCharset',\n\t'accesskey': 'accessKey',\n\t'bgcolor': 'bgColor',\n\t'class': 'className',\n\t'codebase': 'codeBase',\n\t'colspan': 'colSpan',\n\t'contenteditable': 'contentEditable',\n\t'datetime': 'dateTime',\n\t'dirname': 'dirName',\n\t'for': 'htmlFor',\n\t'http-equiv': 'httpEquiv',\n\t'ismap': 'isMap',\n\t'maxlength': 'maxLength',\n\t'novalidate': 'noValidate',\n\t'pubdate': 'pubDate',\n\t'readonly': 'readOnly',\n\t'rowspan': 'rowSpan',\n\t'tabindex': 'tabIndex',\n\t'usemap': 'useMap'\n};\n","import 'legacy';\n\n// https://github.com/kangax/html-minifier/issues/63#issuecomment-37763316\nexport const booleanAttributes = /^(allowFullscreen|async|autofocus|autoplay|checked|compact|controls|declare|default|defaultChecked|defaultMuted|defaultSelected|defer|disabled|enabled|formNoValidate|hidden|indeterminate|inert|isMap|itemScope|loop|multiple|muted|noHref|noResize|noShade|noValidate|noWrap|open|pauseOnExit|readOnly|required|reversed|scoped|seamless|selected|sortable|translate|trueSpeed|typeMustMatch|visible)$/i;\nexport const voidElementNames = /^(?:area|base|br|col|command|doctype|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)$/i;\n\nconst htmlEntities = { quot: 34, amp: 38, apos: 39, lt: 60, gt: 62, nbsp: 160, iexcl: 161, cent: 162, pound: 163, curren: 164, yen: 165, brvbar: 166, sect: 167, uml: 168, copy: 169, ordf: 170, laquo: 171, not: 172, shy: 173, reg: 174, macr: 175, deg: 176, plusmn: 177, sup2: 178, sup3: 179, acute: 180, micro: 181, para: 182, middot: 183, cedil: 184, sup1: 185, ordm: 186, raquo: 187, frac14: 188, frac12: 189, frac34: 190, iquest: 191, Agrave: 192, Aacute: 193, Acirc: 194, Atilde: 195, Auml: 196, Aring: 197, AElig: 198, Ccedil: 199, Egrave: 200, Eacute: 201, Ecirc: 202, Euml: 203, Igrave: 204, Iacute: 205, Icirc: 206, Iuml: 207, ETH: 208, Ntilde: 209, Ograve: 210, Oacute: 211, Ocirc: 212, Otilde: 213, Ouml: 214, times: 215, Oslash: 216, Ugrave: 217, Uacute: 218, Ucirc: 219, Uuml: 220, Yacute: 221, THORN: 222, szlig: 223, agrave: 224, aacute: 225, acirc: 226, atilde: 227, auml: 228, aring: 229, aelig: 230, ccedil: 231, egrave: 232, eacute: 233, ecirc: 234, euml: 235, igrave: 236, iacute: 237, icirc: 238, iuml: 239, eth: 240, ntilde: 241, ograve: 242, oacute: 243, ocirc: 244, otilde: 245, ouml: 246, divide: 247, oslash: 248, ugrave: 249, uacute: 250, ucirc: 251, uuml: 252, yacute: 253, thorn: 254, yuml: 255, OElig: 338, oelig: 339, Scaron: 352, scaron: 353, Yuml: 376, fnof: 402, circ: 710, tilde: 732, Alpha: 913, Beta: 914, Gamma: 915, Delta: 916, Epsilon: 917, Zeta: 918, Eta: 919, Theta: 920, Iota: 921, Kappa: 922, Lambda: 923, Mu: 924, Nu: 925, Xi: 926, Omicron: 927, Pi: 928, Rho: 929, Sigma: 931, Tau: 932, Upsilon: 933, Phi: 934, Chi: 935, Psi: 936, Omega: 937, alpha: 945, beta: 946, gamma: 947, delta: 948, epsilon: 949, zeta: 950, eta: 951, theta: 952, iota: 953, kappa: 954, lambda: 955, mu: 956, nu: 957, xi: 958, omicron: 959, pi: 960, rho: 961, sigmaf: 962, sigma: 963, tau: 964, upsilon: 965, phi: 966, chi: 967, psi: 968, omega: 969, thetasym: 977, upsih: 978, piv: 982, ensp: 8194, emsp: 8195, thinsp: 8201, zwnj: 8204, zwj: 8205, lrm: 8206, rlm: 8207, ndash: 8211, mdash: 8212, lsquo: 8216, rsquo: 8217, sbquo: 8218, ldquo: 8220, rdquo: 8221, bdquo: 8222, dagger: 8224, Dagger: 8225, bull: 8226, hellip: 8230, permil: 8240, prime: 8242, Prime: 8243, lsaquo: 8249, rsaquo: 8250, oline: 8254, frasl: 8260, euro: 8364, image: 8465, weierp: 8472, real: 8476, trade: 8482, alefsym: 8501, larr: 8592, uarr: 8593, rarr: 8594, darr: 8595, harr: 8596, crarr: 8629, lArr: 8656, uArr: 8657, rArr: 8658, dArr: 8659, hArr: 8660, forall: 8704, part: 8706, exist: 8707, empty: 8709, nabla: 8711, isin: 8712, notin: 8713, ni: 8715, prod: 8719, sum: 8721, minus: 8722, lowast: 8727, radic: 8730, prop: 8733, infin: 8734, ang: 8736, and: 8743, or: 8744, cap: 8745, cup: 8746, 'int': 8747, there4: 8756, sim: 8764, cong: 8773, asymp: 8776, ne: 8800, equiv: 8801, le: 8804, ge: 8805, sub: 8834, sup: 8835, nsub: 8836, sube: 8838, supe: 8839, oplus: 8853, otimes: 8855, perp: 8869, sdot: 8901, lceil: 8968, rceil: 8969, lfloor: 8970, rfloor: 8971, lang: 9001, rang: 9002, loz: 9674, spades: 9824, clubs: 9827, hearts: 9829, diams: 9830\t};\nconst controlCharacters = [ 8364, 129, 8218, 402, 8222, 8230, 8224, 8225, 710, 8240, 352, 8249, 338, 141, 381, 143, 144, 8216, 8217, 8220, 8221, 8226, 8211, 8212, 732, 8482, 353, 8250, 339, 157, 382, 376 ];\nconst entityPattern = new RegExp( '&(#?(?:x[\\\\w\\\\d]+|\\\\d+|' + Object.keys( htmlEntities ).join( '|' ) + '));?', 'g' );\n\nexport function decodeCharacterReferences ( html ) {\n\treturn html.replace( entityPattern, function ( match, entity ) {\n\t\tvar code;\n\n\t\t// Handle named entities\n\t\tif ( entity[0] !== '#' ) {\n\t\t\tcode = htmlEntities[ entity ];\n\t\t} else if ( entity[1] === 'x' ) {\n\t\t\tcode = parseInt( entity.substring( 2 ), 16 );\n\t\t} else {\n\t\t\tcode = parseInt( entity.substring( 1 ), 10 );\n\t\t}\n\n\t\tif ( !code ) {\n\t\t\treturn match;\n\t\t}\n\n\t\treturn String.fromCharCode( validateCode( code ) );\n\t});\n}\n\nconst lessThan = /</g;\nconst greaterThan = />/g;\nconst amp = /&/g;\n\nexport function escapeHtml ( str ) {\n\treturn str\n\t\t.replace( amp, '&amp;' )\n\t\t.replace( lessThan, '&lt;' )\n\t\t.replace( greaterThan, '&gt;' );\n}\n\n// some code points are verboten. If we were inserting HTML, the browser would replace the illegal\n// code points with alternatives in some cases - since we're bypassing that mechanism, we need\n// to replace them ourselves\n//\n// Source: http://en.wikipedia.org/wiki/Character_encodings_in_HTML#Illegal_characters\nfunction validateCode ( code ) {\n\tif ( !code ) {\n\t\treturn 65533;\n\t}\n\n\t// line feed becomes generic whitespace\n\tif ( code === 10 ) {\n\t\treturn 32;\n\t}\n\n\t// ASCII range. (Why someone would use HTML entities for ASCII characters I don't know, but...)\n\tif ( code < 128 ) {\n\t\treturn code;\n\t}\n\n\t// code points 128-159 are dealt with leniently by browsers, but they're incorrect. We need\n\t// to correct the mistake or we'll end up with missing € signs and so on\n\tif ( code <= 159 ) {\n\t\treturn controlCharacters[ code - 128 ];\n\t}\n\n\t// basic multilingual plane\n\tif ( code < 55296 ) {\n\t\treturn code;\n\t}\n\n\t// UTF-16 surrogate halves\n\tif ( code <= 57343 ) {\n\t\treturn 65533;\n\t}\n\n\t// rest of the basic multilingual plane\n\tif ( code <= 65535 ) {\n\t\treturn code;\n\t}\n\n\treturn 65533;\n}\n","import { INTERPOLATOR } from 'config/types';\nimport { html } from 'config/namespaces';\nimport Fragment from '../../Fragment';\nimport Item from '../shared/Item';\nimport getUpdateDelegate from './attribute/getUpdateDelegate';\nimport propertyNames from './attribute/propertyNames';\nimport { isArray } from 'utils/is';\nimport { safeToStringValue } from 'utils/dom';\nimport { booleanAttributes } from 'utils/html';\n\nexport default class Attribute extends Item {\n\tconstructor ( options ) {\n\t\tsuper( options );\n\n\t\tthis.name = options.name;\n\t\tthis.element = options.element;\n\t\tthis.parentFragment = options.element.parentFragment; // shared\n\t\tthis.ractive = this.parentFragment.ractive;\n\n\t\tthis.rendered = false;\n\t\tthis.updateDelegate = null;\n\t\tthis.fragment = null;\n\t\tthis.value = null;\n\n\t\tif ( !isArray( options.template ) ) {\n\t\t\tthis.value = options.template;\n\t\t\tif ( this.value === 0 ) {\n\t\t\t\tthis.value = '';\n\t\t\t}\n\t\t} else {\n\t\t\tthis.fragment = new Fragment({\n\t\t\t\towner: this,\n\t\t\t\ttemplate: options.template\n\t\t\t});\n\t\t}\n\n\t\tthis.interpolator = this.fragment &&\n\t\t                    this.fragment.items.length === 1 &&\n\t\t                    this.fragment.items[0].type === INTERPOLATOR &&\n\t\t                    this.fragment.items[0];\n\t}\n\n\tbind () {\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.bind();\n\t\t}\n\t}\n\n\tbubble () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.element.bubble();\n\t\t\tthis.dirty = true;\n\t\t}\n\t}\n\n\tgetString () {\n\t\treturn this.fragment ?\n\t\t\tthis.fragment.toString() :\n\t\t\tthis.value != null ? '' + this.value : '';\n\t}\n\n\t// TODO could getValue ever be called for a static attribute,\n\t// or can we assume that this.fragment exists?\n\tgetValue () {\n\t\treturn this.fragment ? this.fragment.valueOf() : booleanAttributes.test( this.name ) ? true : this.value;\n\t}\n\n\trebind () {\n\t\tthis.unbind();\n\t\tthis.bind();\n\t}\n\n\trender () {\n\t\tconst node = this.element.node;\n\t\tthis.node = node;\n\n\t\t// should we use direct property access, or setAttribute?\n\t\tif ( !node.namespaceURI || node.namespaceURI === html ) {\n\t\t\tconst propertyName = propertyNames[ this.name ] || this.name;\n\n\t\t\tif ( node[ propertyName ] !== undefined ) {\n\t\t\t\tthis.propertyName = propertyName;\n\t\t\t}\n\n\t\t\t// is attribute a boolean attribute or 'value'? If so we're better off doing e.g.\n\t\t\t// node.selected = true rather than node.setAttribute( 'selected', '' )\n\t\t\tif ( booleanAttributes.test( this.name ) || this.isTwoway ) {\n\t\t\t\tthis.useProperty = true;\n\t\t\t}\n\n\t\t\tif ( propertyName === 'value' ) {\n\t\t\t\tnode._ractive.value = this.value;\n\t\t\t}\n\t\t}\n\n\t\tthis.rendered = true;\n\t\tthis.updateDelegate = getUpdateDelegate( this );\n\t\tthis.updateDelegate();\n\t}\n\n\ttoString () {\n\t\tconst value = this.getValue();\n\n\t\t// Special case - select and textarea values (should not be stringified)\n\t\tif ( this.name === 'value' && ( this.element.getAttribute( 'contenteditable' ) !== undefined || ( this.element.name === 'select' || this.element.name === 'textarea' ) ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Special case – bound radio `name` attributes\n\t\tif ( this.name === 'name' && this.element.name === 'input' && this.interpolator ) {\n\t\t\treturn `name=\"{{${this.interpolator.model.getKeypath()}}}\"`;\n\t\t}\n\n\t\tif ( booleanAttributes.test( this.name ) ) return value ? this.name : '';\n\t\tif ( value == null ) return '';\n\n\t\tconst str = safeToStringValue( this.getString() )\n\t\t\t.replace( /&/g, '&amp;' )\n\t\t\t.replace( /\"/g, '&quot;' )\n\t\t\t.replace( /'/g, '&#39;' );\n\n\t\treturn str ?\n\t\t\t`${this.name}=\"${str}\"` :\n\t\t\tthis.name;\n\t}\n\n\tunbind () {\n\t\tif ( this.fragment ) this.fragment.unbind();\n\t}\n\n\tupdate () {\n\t\tif ( this.dirty ) {\n\t\t\tif ( this.fragment ) this.fragment.update();\n\t\t\tif ( this.rendered ) this.updateDelegate();\n\t\t\tthis.dirty = false;\n\t\t}\n\t}\n}\n","import { doc } from 'config/environment';\nimport { svg } from 'config/namespaces';\nimport { createElement } from 'utils/dom';\nimport { toArray } from 'utils/array';\nimport Fragment from 'view/Fragment';\nimport Item from '../shared/Item';\n\nconst div = doc ? createElement( 'div' ) : null;\n\nexport default class ConditionalAttribute extends Item {\n\tconstructor ( options ) {\n\t\tsuper( options );\n\n\t\tthis.attributes = [];\n\n\t\tthis.owner = options.owner;\n\n\t\tthis.fragment = new Fragment({\n\t\t\tractive: this.ractive,\n\t\t\towner: this,\n\t\t\ttemplate: [ this.template ]\n\t\t});\n\n\t\tthis.dirty = false;\n\t}\n\n\tbind () {\n\t\tthis.fragment.bind();\n\t}\n\n\tbubble () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.dirty = true;\n\t\t\tthis.owner.bubble();\n\t\t}\n\t}\n\n\trebind () {\n\t\tthrow new Error( 'ConditionalAttribute$rebind is not yet implemented' ); // TODO test\n\t}\n\n\trender () {\n\t\tthis.node = this.owner.node;\n\t\tthis.isSvg = this.node.namespaceURI === svg;\n\n\t\tthis.rendered = true;\n\t\tthis.dirty = true; // TODO this seems hacky, but necessary for tests to pass in browser AND node.js\n\t\tthis.update();\n\t}\n\n\ttoString () {\n\t\treturn this.fragment.toString();\n\t}\n\n\tunbind () {\n\t\tthis.fragment.unbind();\n\t}\n\n\tunrender () {\n\t\tthis.rendered = false;\n\t}\n\n\tupdate () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.fragment.update();\n\n\t\t\tif ( this.rendered ) {\n\t\t\t\tconst str = this.fragment.toString();\n\t\t\t\tconst attrs = parseAttributes( str, this.isSvg );\n\n\t\t\t\t// any attributes that previously existed but no longer do\n\t\t\t\t// must be removed\n\t\t\t\tthis.attributes.filter( a => notIn( attrs, a ) ).forEach( a => {\n\t\t\t\t\tthis.node.removeAttribute( a.name );\n\t\t\t\t});\n\n\t\t\t\tattrs.forEach( a => {\n\t\t\t\t\tthis.node.setAttribute( a.name, a.value );\n\t\t\t\t});\n\n\t\t\t\tthis.attributes = attrs;\n\t\t\t}\n\n\t\t\tthis.dirty = false;\n\t\t}\n\t}\n}\n\n\nfunction parseAttributes ( str, isSvg ) {\n\tconst tagName = isSvg ? 'svg' : 'div';\n\tdiv.innerHTML = `<${tagName} ${str}></${tagName}>`;\n\n\treturn toArray( div.childNodes[0].attributes );\n}\n\nfunction notIn ( haystack, needle ) {\n\tlet i = haystack.length;\n\n\twhile ( i-- ) {\n\t\tif ( haystack[i].name === needle.name ) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n","import { findInViewHierarchy } from 'shared/registry';\nimport { missingPlugin } from 'config/errors';\nimport Fragment from '../../Fragment';\nimport noop from 'utils/noop';\n\nconst missingDecorator = {\n\tupdate: noop,\n\tteardown: noop\n};\n\nexport default class Decorator {\n\tconstructor ( owner, template ) {\n\t\tthis.owner = owner;\n\t\tthis.template = template;\n\n\t\tthis.parentFragment = owner.parentFragment;\n\t\tthis.ractive = owner.ractive;\n\n\t\tthis.dynamicName = typeof template.n === 'object';\n\t\tthis.dynamicArgs = !!template.d;\n\n\t\tif ( this.dynamicName ) {\n\t\t\tthis.nameFragment = new Fragment({\n\t\t\t\towner: this,\n\t\t\t\ttemplate: template.n\n\t\t\t});\n\t\t} else {\n\t\t\tthis.name = template.n || template;\n\t\t}\n\n\t\tif ( this.dynamicArgs ) {\n\t\t\tthis.argsFragment = new Fragment({\n\t\t\t\towner: this,\n\t\t\t\ttemplate: template.d\n\t\t\t});\n\t\t} else {\n\t\t\tthis.args = template.a || [];\n\t\t}\n\n\t\tthis.node = null;\n\t\tthis.intermediary = null;\n\t}\n\n\tbind () {\n\t\tif ( this.dynamicName ) {\n\t\t\tthis.nameFragment.bind();\n\t\t\tthis.name = this.nameFragment.toString();\n\t\t}\n\n\t\tif ( this.dynamicArgs ) this.argsFragment.bind();\n\t}\n\n\tbubble () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.dirty = true;\n\t\t\tthis.owner.bubble();\n\t\t}\n\t}\n\n\trebind () {\n\t\tif ( this.dynamicName ) this.nameFragment.rebind();\n\t\tif ( this.dynamicArgs ) this.argsFragment.rebind();\n\t}\n\n\trender () {\n\t\tconst fn = findInViewHierarchy( 'decorators', this.ractive, this.name );\n\n\t\tif ( !fn ) {\n\t\t\tmissingPlugin( this.name, 'decorators' );\n\t\t\tthis.intermediary = missingDecorator;\n\t\t\treturn;\n\t\t}\n\n\t\tthis.node = this.owner.node;\n\n\t\tconst args = this.dynamicArgs ? this.argsFragment.getArgsList() : this.args;\n\t\tthis.intermediary = fn.apply( this.ractive, [ this.node ].concat( args ) );\n\n\t\tif ( !this.intermediary || !this.intermediary.teardown ) {\n\t\t\tthrow new Error( `The '${this.name}' decorator must return an object with a teardown method` );\n\t\t}\n\t}\n\n\tunbind () {\n\t\tif ( this.dynamicName ) this.nameFragment.unbind();\n\t\tif ( this.dynamicArgs ) this.argsFragment.unbind();\n\t}\n\n\tunrender () {\n\t\tthis.intermediary.teardown();\n\t}\n\n\tupdate () {\n\t\tif ( this.dynamicName ) {\n\t\t\tconst name = this.nameFragment.toString();\n\n\t\t\tif ( name !== this.name ) {\n\t\t\t\tthis.name = name;\n\t\t\t\tthis.unrender();\n\t\t\t\tthis.render();\n\t\t\t}\n\t\t}\n\n\t\telse if ( this.intermediary.update ) {\n\t\t\tconst args = this.dynamicArgs ? this.argsFragment.getArgsList() : this.args;\n\t\t\tthis.intermediary.update.apply( this.ractive, args );\n\t\t}\n\n\t\telse {\n\t\t\tthis.unrender();\n\t\t\tthis.render();\n\t\t}\n\t}\n}\n","import { fatal } from 'utils/log';\nimport { findInViewHierarchy } from 'shared/registry';\nimport { missingPlugin } from 'config/errors';\nimport { removeFromArray } from 'utils/array';\nimport fireEvent from 'events/fireEvent';\nimport Fragment from '../../Fragment';\nimport createFunction from 'shared/createFunction';\nimport { unbind } from 'shared/methodCallers';\nimport noop from 'utils/noop';\nimport resolveReference from 'view/resolvers/resolveReference';\n\nfunction defaultHandler ( event ) {\n\tconst handler = this._ractive.events[ event.type ];\n\n\thandler.fire({\n\t\tnode: this,\n\t\toriginal: event\n\t});\n}\n\nexport default class EventHandler {\n\tconstructor ( owner, name, template ) {\n\t\tif ( name.indexOf( '*' ) !== -1 ) {\n\t\t\tfatal( `Only component proxy-events may contain \"*\" wildcards, <${owner.name} on-${name}=\"...\"/> is not valid` );\n\t\t}\n\n\t\tthis.owner = owner;\n\t\tthis.name = name;\n\t\tthis.template = template;\n\n\t\tthis.ractive = owner.parentFragment.ractive;\n\t\tthis.parentFragment = owner.parentFragment;\n\t\tthis.node = null;\n\t}\n\n\tbind () {\n\t\tlet fragment = this.parentFragment;\n\t\twhile ( !fragment.context ) fragment = fragment.parent;\n\t\tthis.context = fragment.context;\n\n\t\tconst template = this.template;\n\n\t\tif ( template.m ) {\n\t\t\tthis.method = template.m;\n\n\t\t\tthis.resolvers = [];\n\t\t\tthis.models = template.a.r.map( ( ref, i ) => {\n\t\t\t\tif ( /^event(?:\\.(.+))?$/.test( ref ) ) {\n\t\t\t\t\t// on-click=\"foo(event.node)\"\n\t\t\t\t\treturn {\n\t\t\t\t\t\tevent: true,\n\t\t\t\t\t\tkeys: ref.length > 5 ? ref.slice( 6 ).split( '.' ) : [],\n\t\t\t\t\t\tunbind: noop\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tconst model = resolveReference( this.parentFragment, ref );\n\n\t\t\t\tif ( !model ) {\n\t\t\t\t\tconst resolver = this.parentFragment.resolve( ref, model => {\n\t\t\t\t\t\tthis.models[i] = model;\n\t\t\t\t\t\tremoveFromArray( this.resolvers, resolver );\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.resolvers.push( resolver );\n\t\t\t\t}\n\n\t\t\t\treturn model;\n\t\t\t});\n\n\t\t\tthis.argsFn = createFunction( template.a.s, template.a.r.length );\n\t\t}\n\n\t\telse {\n\t\t\t// TODO deprecate this style of directive\n\t\t\tthis.action = typeof template === 'string' ? // on-click='foo'\n\t\t\t\ttemplate :\n\t\t\t\ttypeof template.n === 'string' ? // on-click='{{dynamic}}'\n\t\t\t\t\ttemplate.n :\n\t\t\t\t\tnew Fragment({\n\t\t\t\t\t\towner: this,\n\t\t\t\t\t\ttemplate: template.n\n\t\t\t\t\t});\n\n\t\t\tthis.args = template.a ? // static arguments\n\t\t\t\t( typeof template.a === 'string' ? [ template.a ] : template.a ) :\n\t\t\t\ttemplate.d ? // dynamic arguments\n\t\t\t\t\tnew Fragment({\n\t\t\t\t\t\towner: this,\n\t\t\t\t\t\ttemplate: template.d\n\t\t\t\t\t}) :\n\t\t\t\t\t[]; // no arguments\n\t\t}\n\n\t\tif ( this.template.n && typeof this.template.n !== 'string' ) this.action.bind();\n\t\tif ( this.template.d ) this.args.bind();\n\t}\n\n\tbubble () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.dirty = true;\n\t\t\tthis.owner.bubble();\n\t\t}\n\t}\n\n\tfire ( event ) {\n\t\t// augment event object\n\t\tevent.keypath = this.context.getKeypath();\n\t\tevent.context = this.context.get();\n\t\tevent.index = this.parentFragment.indexRefs;\n\n\t\tif ( this.method ) {\n\t\t\tif ( typeof this.ractive[ this.method ] !== 'function' ) {\n\t\t\t\tthrow new Error( `Attempted to call a non-existent method (\"${this.method}\")` );\n\t\t\t}\n\n\t\t\tconst values = this.models.map( model => {\n\t\t\t\tif ( !model ) return undefined;\n\n\t\t\t\tif ( model.event ) {\n\t\t\t\t\tlet obj = event;\n\t\t\t\t\tlet keys = model.keys.slice();\n\n\t\t\t\t\twhile ( keys.length ) obj = obj[ keys.shift() ];\n\t\t\t\t\treturn obj;\n\t\t\t\t}\n\n\t\t\t\tif ( model.wrapper ) {\n\t\t\t\t\treturn model.wrapper.value;\n\t\t\t\t}\n\n\t\t\t\treturn model.get();\n\t\t\t});\n\n\t\t\t// make event available as `this.event`\n\t\t\tconst oldEvent = this.ractive.event;\n\t\t\tthis.ractive.event = event;\n\n\t\t\tconst args = this.argsFn.apply( null, values );\n\t\t\tthis.ractive[ this.method ].apply( this.ractive, args );\n\n\t\t\tthis.ractive.event = oldEvent;\n\t\t}\n\n\t\telse {\n\t\t\tconst action = this.action.toString();\n\t\t\tconst args = this.template.d ? this.args.getArgsList() : this.args;\n\n\t\t\tevent.name = action;\n\n\t\t\tfireEvent( this.ractive, action, {\n\t\t\t\tevent,\n\t\t\t\targs\n\t\t\t});\n\t\t}\n\t}\n\n\trebind () {\n\t\tthrow new Error( 'EventHandler$rebind not yet implemented!' ); // TODO add tests\n\t}\n\n\trender () {\n\t\tthis.node = this.owner.node;\n\n\t\tconst fn = findInViewHierarchy( 'events', this.ractive, this.name );\n\n\t\tif ( fn ) {\n\t\t\tconst fire = event => this.fire( event );\n\t\t\tthis.customHandler = fn( this.node, fire );\n\t\t} else {\n\t\t\t// no plugin - most likely a standard DOM event\n\t\t\tif ( !( `on${this.name}` in this.node ) ) {\n\t\t\t\tmissingPlugin( this.name, 'events' );\n\t\t\t}\n\n\t\t\tthis.node._ractive.events[ this.name ] = this;\n\t\t\tthis.node.addEventListener( this.name, defaultHandler, false );\n\t\t}\n\t}\n\n\tunbind () {\n\t\tconst template = this.template;\n\n\t\tif ( template.m ) {\n\t\t\tthis.resolvers.forEach( unbind );\n\t\t\tthis.resolvers = [];\n\n\t\t\tthis.models.forEach( model => {\n\t\t\t\tif ( model ) model.unbind();\n\t\t\t});\n\t\t}\n\n\t\telse {\n\t\t\t// TODO this is brittle and non-explicit, fix it\n\t\t\tif ( this.action.unbind ) this.action.unbind();\n\t\t\tif ( this.args.unbind ) this.args.unbind();\n\t\t}\n\t}\n\n\tunrender () {\n\t\tif ( this.customHandler ) {\n\t\t\tthis.customHandler.teardown();\n\t\t} else {\n\t\t\tthis.node.removeEventListener( this.name, defaultHandler, false );\n\t\t\tthis.node._ractive.events[ this.name ] = null;\n\t\t}\n\t}\n\n\tupdate () {\n\t\tif ( this.method ) return; // nothing to do\n\n\t\t// ugh legacy\n\t\tif ( this.action.update ) this.action.update();\n\t\tif ( this.template.d ) this.args.update();\n\t}\n}\n","export default function ( hyphenatedStr ) {\n\treturn hyphenatedStr.replace( /-([a-zA-Z])/g, function ( match, $1 ) {\n\t\treturn $1.toUpperCase();\n\t});\n}\n","import { isClient, vendors } from 'config/environment';\nimport { createElement } from 'utils/dom';\nimport camelCase from 'utils/camelCase';\n\nvar prefix, prefixCache, testStyle;\n\nif ( !isClient ) {\n\tprefix = null;\n} else {\n\tprefixCache = {};\n\ttestStyle = createElement( 'div' ).style;\n\n\tprefix = function ( prop ) {\n\t\tvar i, vendor, capped;\n\n\t\tprop = camelCase( prop );\n\n\t\tif ( !prefixCache[ prop ] ) {\n\t\t\tif ( testStyle[ prop ] !== undefined ) {\n\t\t\t\tprefixCache[ prop ] = prop;\n\t\t\t}\n\n\t\t\telse {\n\t\t\t\t// test vendors...\n\t\t\t\tcapped = prop.charAt( 0 ).toUpperCase() + prop.substring( 1 );\n\n\t\t\t\ti = vendors.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tvendor = vendors[i];\n\t\t\t\t\tif ( testStyle[ vendor + capped ] !== undefined ) {\n\t\t\t\t\t\tprefixCache[ prop ] = vendor + capped;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn prefixCache[ prop ];\n\t};\n}\n\nexport default prefix;\n","import { win, doc, vendors } from 'config/environment';\n\nexport let visible;\nlet hidden = 'hidden';\n\nif ( doc ) {\n\tlet prefix;\n\n\tif ( hidden in doc ) {\n\t\tprefix = '';\n\t} else {\n\t\tlet i = vendors.length;\n\t\twhile ( i-- ) {\n\t\t\tconst vendor = vendors[i];\n\t\t\thidden = vendor + 'Hidden';\n\n\t\t\tif ( hidden in doc ) {\n\t\t\t\tprefix = vendor;\n\t\t\t\tdoc.addEventListener( prefix + 'visibilitychange', onChange );\n\t\t\t\tonChange();\n\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif ( prefix === undefined ) {\n\t\t// gah, we're in an old browser\n\t\tif ( 'onfocusout' in doc ) {\n\t\t\tdoc.addEventListener( 'focusout', onHide );\n\t\t\tdoc.addEventListener( 'focusin', onShow );\n\t\t}\n\n\t\telse {\n\t\t\twin.addEventListener( 'pagehide', onHide );\n\t\t\twin.addEventListener( 'blur', onHide );\n\n\t\t\twin.addEventListener( 'pageshow', onShow );\n\t\t\twin.addEventListener( 'focus', onShow );\n\t\t}\n\n\t\tvisible = true; // until proven otherwise. Not ideal but hey\n\t}\n}\n\nfunction onChange () {\n\tvisible = !doc[ hidden ];\n}\n\nfunction onHide () {\n\tvisible = false;\n}\n\nfunction onShow () {\n\tvisible = true;\n}\n","import { warnOnceIfDebug } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport getTime from 'utils/getTime';\nimport animations from 'shared/animations';\n\n// TODO what happens if a transition is aborted?\n// TODO use this with Animation to dedupe some code?\n\nvar Ticker = function ( options ) {\n\tvar easing;\n\n\tthis.duration = options.duration;\n\tthis.step = options.step;\n\tthis.complete = options.complete;\n\n\t// easing\n\tif ( typeof options.easing === 'string' ) {\n\t\teasing = options.root.easing[ options.easing ];\n\n\t\tif ( !easing ) {\n\t\t\twarnOnceIfDebug( missingPlugin( options.easing, 'easing' ) );\n\t\t\teasing = linear;\n\t\t}\n\t} else if ( typeof options.easing === 'function' ) {\n\t\teasing = options.easing;\n\t} else {\n\t\teasing = linear;\n\t}\n\n\tthis.easing = easing;\n\n\tthis.start = getTime();\n\tthis.end = this.start + this.duration;\n\n\tthis.running = true;\n\tanimations.add( this );\n};\n\nTicker.prototype = {\n\ttick: function ( now ) {\n\t\tvar elapsed, eased;\n\n\t\tif ( !this.running ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif ( now > this.end ) {\n\t\t\tif ( this.step ) {\n\t\t\t\tthis.step( 1 );\n\t\t\t}\n\n\t\t\tif ( this.complete ) {\n\t\t\t\tthis.complete( 1 );\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\telapsed = now - this.start;\n\t\teased = this.easing( elapsed / this.duration );\n\n\t\tif ( this.step ) {\n\t\t\tthis.step( eased );\n\t\t}\n\n\t\treturn true;\n\t},\n\n\tstop: function () {\n\t\tif ( this.abort ) {\n\t\t\tthis.abort();\n\t\t}\n\n\t\tthis.running = false;\n\t}\n};\n\nexport default Ticker;\nfunction linear ( t ) { return t; }\n","import { vendors } from 'config/environment';\n\nvar unprefixPattern = new RegExp( '^-(?:' + vendors.join( '|' ) + ')-' );\n\nexport default function ( prop ) {\n\treturn prop.replace( unprefixPattern, '' );\n}\n","import { isClient } from 'config/environment';\nimport { warnIfDebug } from 'utils/log';\nimport { createElement } from 'utils/dom';\nimport camelCase from 'utils/camelCase';\nimport interpolate from 'shared/interpolate';\nimport Ticker from 'shared/Ticker';\nimport prefix from './prefix';\nimport unprefix from './unprefix';\nimport hyphenate from './hyphenate';\n\nvar createTransitions,\n\ttestStyle,\n\tTRANSITION,\n\tTRANSITIONEND,\n\tCSS_TRANSITIONS_ENABLED,\n\tTRANSITION_DURATION,\n\tTRANSITION_PROPERTY,\n\tTRANSITION_TIMING_FUNCTION,\n\tcanUseCssTransitions = {},\n\tcannotUseCssTransitions = {};\n\nif ( !isClient ) {\n\tcreateTransitions = null;\n} else {\n\ttestStyle = createElement( 'div' ).style;\n\n\t// determine some facts about our environment\n\t(function() {\n\t\tif ( testStyle.transition !== undefined ) {\n\t\t\tTRANSITION = 'transition';\n\t\t\tTRANSITIONEND = 'transitionend';\n\t\t\tCSS_TRANSITIONS_ENABLED = true;\n\t\t} else if ( testStyle.webkitTransition !== undefined ) {\n\t\t\tTRANSITION = 'webkitTransition';\n\t\t\tTRANSITIONEND = 'webkitTransitionEnd';\n\t\t\tCSS_TRANSITIONS_ENABLED = true;\n\t\t} else {\n\t\t\tCSS_TRANSITIONS_ENABLED = false;\n\t\t}\n\t}());\n\n\tif ( TRANSITION ) {\n\t\tTRANSITION_DURATION = TRANSITION + 'Duration';\n\t\tTRANSITION_PROPERTY = TRANSITION + 'Property';\n\t\tTRANSITION_TIMING_FUNCTION = TRANSITION + 'TimingFunction';\n\t}\n\n\tcreateTransitions = function ( t, to, options, changedProperties, resolve ) {\n\n\t\t// Wait a beat (otherwise the target styles will be applied immediately)\n\t\t// TODO use a fastdom-style mechanism?\n\t\tsetTimeout( function () {\n\n\t\t\tvar hashPrefix, jsTransitionsComplete, cssTransitionsComplete, checkComplete, transitionEndHandler;\n\n\t\t\tcheckComplete = function () {\n\t\t\t\tif ( jsTransitionsComplete && cssTransitionsComplete ) {\n\t\t\t\t\t// will changes to events and fire have an unexpected consequence here?\n\t\t\t\t\tt.root.fire( t.name + ':end', t.node, t.isIntro );\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// this is used to keep track of which elements can use CSS to animate\n\t\t\t// which properties\n\t\t\thashPrefix = ( t.node.namespaceURI || '' ) + t.node.tagName;\n\n\t\t\tt.node.style[ TRANSITION_PROPERTY ] = changedProperties.map( prefix ).map( hyphenate ).join( ',' );\n\t\t\tt.node.style[ TRANSITION_TIMING_FUNCTION ] = hyphenate( options.easing || 'linear' );\n\t\t\tt.node.style[ TRANSITION_DURATION ] = ( options.duration / 1000 ) + 's';\n\n\t\t\ttransitionEndHandler = function ( event ) {\n\t\t\t\tvar index;\n\n\t\t\t\tindex = changedProperties.indexOf( camelCase( unprefix( event.propertyName ) ) );\n\t\t\t\tif ( index !== -1 ) {\n\t\t\t\t\tchangedProperties.splice( index, 1 );\n\t\t\t\t}\n\n\t\t\t\tif ( changedProperties.length ) {\n\t\t\t\t\t// still transitioning...\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tt.node.removeEventListener( TRANSITIONEND, transitionEndHandler, false );\n\n\t\t\t\tcssTransitionsComplete = true;\n\t\t\t\tcheckComplete();\n\t\t\t};\n\n\t\t\tt.node.addEventListener( TRANSITIONEND, transitionEndHandler, false );\n\n\t\t\tsetTimeout( function () {\n\t\t\t\tvar i = changedProperties.length, hash, originalValue, index, propertiesToTransitionInJs = [], prop, suffix;\n\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tprop = changedProperties[i];\n\t\t\t\t\thash = hashPrefix + prop;\n\n\t\t\t\t\tif ( CSS_TRANSITIONS_ENABLED && !cannotUseCssTransitions[ hash ] ) {\n\t\t\t\t\t\tt.node.style[ prefix( prop ) ] = to[ prop ];\n\n\t\t\t\t\t\t// If we're not sure if CSS transitions are supported for\n\t\t\t\t\t\t// this tag/property combo, find out now\n\t\t\t\t\t\tif ( !canUseCssTransitions[ hash ] ) {\n\t\t\t\t\t\t\toriginalValue = t.getStyle( prop );\n\n\t\t\t\t\t\t\t// if this property is transitionable in this browser,\n\t\t\t\t\t\t\t// the current style will be different from the target style\n\t\t\t\t\t\t\tcanUseCssTransitions[ hash ] = ( t.getStyle( prop ) != to[ prop ] );\n\t\t\t\t\t\t\tcannotUseCssTransitions[ hash ] = !canUseCssTransitions[ hash ];\n\n\t\t\t\t\t\t\t// Reset, if we're going to use timers after all\n\t\t\t\t\t\t\tif ( cannotUseCssTransitions[ hash ] ) {\n\t\t\t\t\t\t\t\tt.node.style[ prefix( prop ) ] = originalValue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( !CSS_TRANSITIONS_ENABLED || cannotUseCssTransitions[ hash ] ) {\n\t\t\t\t\t\t// we need to fall back to timer-based stuff\n\t\t\t\t\t\tif ( originalValue === undefined ) {\n\t\t\t\t\t\t\toriginalValue = t.getStyle( prop );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// need to remove this from changedProperties, otherwise transitionEndHandler\n\t\t\t\t\t\t// will get confused\n\t\t\t\t\t\tindex = changedProperties.indexOf( prop );\n\t\t\t\t\t\tif ( index === -1 ) {\n\t\t\t\t\t\t\twarnIfDebug( 'Something very strange happened with transitions. Please raise an issue at https://github.com/ractivejs/ractive/issues - thanks!', { node: t.node });\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tchangedProperties.splice( index, 1 );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// TODO Determine whether this property is animatable at all\n\n\t\t\t\t\t\tsuffix = /[^\\d]*$/.exec( to[ prop ] )[0];\n\n\t\t\t\t\t\t// ...then kick off a timer-based transition\n\t\t\t\t\t\tpropertiesToTransitionInJs.push({\n\t\t\t\t\t\t\tname: prefix( prop ),\n\t\t\t\t\t\t\tinterpolator: interpolate( parseFloat( originalValue ), parseFloat( to[ prop ] ) ),\n\t\t\t\t\t\t\tsuffix: suffix\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\n\t\t\t\t// javascript transitions\n\t\t\t\tif ( propertiesToTransitionInJs.length ) {\n\t\t\t\t\tnew Ticker({\n\t\t\t\t\t\troot: t.root,\n\t\t\t\t\t\tduration: options.duration,\n\t\t\t\t\t\teasing: camelCase( options.easing || '' ),\n\t\t\t\t\t\tstep: function ( pos ) {\n\t\t\t\t\t\t\tvar prop, i;\n\n\t\t\t\t\t\t\ti = propertiesToTransitionInJs.length;\n\t\t\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\t\t\tprop = propertiesToTransitionInJs[i];\n\t\t\t\t\t\t\t\tt.node.style[ prop.name ] = prop.interpolator( pos ) + prop.suffix;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomplete: function () {\n\t\t\t\t\t\t\tjsTransitionsComplete = true;\n\t\t\t\t\t\t\tcheckComplete();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tjsTransitionsComplete = true;\n\t\t\t\t}\n\n\n\t\t\t\tif ( !changedProperties.length ) {\n\t\t\t\t\t// We need to cancel the transitionEndHandler, and deal with\n\t\t\t\t\t// the fact that it will never fire\n\t\t\t\t\tt.node.removeEventListener( TRANSITIONEND, transitionEndHandler, false );\n\t\t\t\t\tcssTransitionsComplete = true;\n\t\t\t\t\tcheckComplete();\n\t\t\t\t}\n\t\t\t}, 0 );\n\t\t}, options.delay || 0 );\n\t};\n}\n\nexport default createTransitions;\n","import { vendors } from 'config/environment';\n\nvar vendorPattern = new RegExp( '^(?:' + vendors.join( '|' ) + ')([A-Z])' );\n\nexport default function ( str ) {\n\tvar hyphenated;\n\n\tif ( !str ) {\n\t\treturn ''; // edge case\n\t}\n\n\tif ( vendorPattern.test( str ) ) {\n\t\tstr = '-' + str;\n\t}\n\n\thyphenated = str.replace( /[A-Z]/g, function ( match ) {\n\t\treturn '-' + match.toLowerCase();\n\t});\n\n\treturn hyphenated;\n}\n","import { win } from 'config/environment';\nimport legacy from 'legacy';\nimport { isArray } from 'utils/is';\nimport prefix from './transitions/prefix';\nimport { warnOnceIfDebug } from 'utils/log';\nimport { extend } from 'utils/object';\nimport { missingPlugin } from 'config/errors';\nimport Fragment from 'view/Fragment';\nimport { findInViewHierarchy } from 'shared/registry';\nimport { visible } from 'config/visibility';\nimport createTransitions from './transitions/createTransitions';\nimport resetStyle from './transitions/resetStyle';\nimport Promise from 'utils/Promise';\n\nconst getComputedStyle = win && ( win.getComputedStyle || legacy.getComputedStyle );\nconst resolved = Promise.resolve();\n\nexport default class Transition {\n\tconstructor ( owner, template, isIntro ) {\n\t\tthis.owner = owner;\n\t\tthis.isIntro = isIntro;\n\t\tthis.ractive = owner.ractive;\n\n\t\tconst ractive = owner.ractive;\n\n\t\tlet name = template.n || template;\n\n\t\tif ( typeof name !== 'string' ) {\n\t\t\tconst fragment = new Fragment({\n\t\t\t\towner,\n\t\t\t\ttemplate: name\n\t\t\t}).bind(); // TODO need a way to capture values without bind()\n\n\t\t\tname = fragment.toString();\n\t\t\tfragment.unbind();\n\n\t\t\tif ( name === '' ) {\n\t\t\t\t// empty string okay, just no transition\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.name = name;\n\n\t\tif ( template.a ) {\n\t\t\tthis.params = template.a;\n\t\t}\n\n\t\telse if ( template.d ) {\n\t\t\t// TODO is there a way to interpret dynamic arguments without all the\n\t\t\t// 'dependency thrashing'?\n\t\t\tconst fragment = new Fragment({\n\t\t\t\towner,\n\t\t\t\ttemplate: template.d\n\t\t\t}).bind();\n\n\t\t\tthis.params = fragment.getArgsList();\n\t\t\tfragment.unbind();\n\t\t}\n\n\t\tthis._fn = findInViewHierarchy( 'transitions', ractive, name );\n\n\t\tif ( !this._fn ) {\n\t\t\twarnOnceIfDebug( missingPlugin( name, 'transition' ), { ractive });\n\t\t}\n\t}\n\n\tanimateStyle ( style, value, options ) {\n\t\tif ( arguments.length === 4 ) {\n\t\t\tthrow new Error( 't.animateStyle() returns a promise - use .then() instead of passing a callback' );\n\t\t}\n\n\t\t// Special case - page isn't visible. Don't animate anything, because\n\t\t// that way you'll never get CSS transitionend events\n\t\tif ( !visible ) {\n\t\t\tthis.setStyle( style, value );\n\t\t\treturn resolved;\n\t\t}\n\n\t\tlet to;\n\n\t\tif ( typeof style === 'string' ) {\n\t\t\tto = {};\n\t\t\tto[ style ] = value;\n\t\t} else {\n\t\t\tto = style;\n\n\t\t\t// shuffle arguments\n\t\t\toptions = value;\n\t\t}\n\n\t\t// As of 0.3.9, transition authors should supply an `option` object with\n\t\t// `duration` and `easing` properties (and optional `delay`), plus a\n\t\t// callback function that gets called after the animation completes\n\n\t\t// TODO remove this check in a future version\n\t\tif ( !options ) {\n\t\t\twarnOnceIfDebug( 'The \"%s\" transition does not supply an options object to `t.animateStyle()`. This will break in a future version of Ractive. For more info see https://github.com/RactiveJS/Ractive/issues/340', this.name );\n\t\t\toptions = this;\n\t\t}\n\n\t\tvar promise = new Promise( resolve => {\n\t\t\tvar propertyNames, changedProperties, computedStyle, current, from, i, prop;\n\n\t\t\t// Edge case - if duration is zero, set style synchronously and complete\n\t\t\tif ( !options.duration ) {\n\t\t\t\tthis.setStyle( to );\n\t\t\t\tresolve();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Get a list of the properties we're animating\n\t\t\tpropertyNames = Object.keys( to );\n\t\t\tchangedProperties = [];\n\n\t\t\t// Store the current styles\n\t\t\tcomputedStyle = getComputedStyle( this.node );\n\n\t\t\tfrom = {};\n\t\t\ti = propertyNames.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tprop = propertyNames[i];\n\t\t\t\tcurrent = computedStyle[ prefix( prop ) ];\n\n\t\t\t\tif ( current === '0px' ) {\n\t\t\t\t\tcurrent = 0;\n\t\t\t\t}\n\n\t\t\t\t// we need to know if we're actually changing anything\n\t\t\t\tif ( current != to[ prop ] ) { // use != instead of !==, so we can compare strings with numbers\n\t\t\t\t\tchangedProperties.push( prop );\n\n\t\t\t\t\t// make the computed style explicit, so we can animate where\n\t\t\t\t\t// e.g. height='auto'\n\t\t\t\t\tthis.node.style[ prefix( prop ) ] = current;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// If we're not actually changing anything, the transitionend event\n\t\t\t// will never fire! So we complete early\n\t\t\tif ( !changedProperties.length ) {\n\t\t\t\tresolve();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcreateTransitions( this, to, options, changedProperties, resolve );\n\t\t});\n\n\t\treturn promise;\n\t}\n\n\tgetStyle ( props ) {\n\t\tvar computedStyle, styles, i, prop, value;\n\n\t\tcomputedStyle = getComputedStyle( this.node );\n\n\t\tif ( typeof props === 'string' ) {\n\t\t\tvalue = computedStyle[ prefix( props ) ];\n\t\t\tif ( value === '0px' ) {\n\t\t\t\tvalue = 0;\n\t\t\t}\n\t\t\treturn value;\n\t\t}\n\n\t\tif ( !isArray( props ) ) {\n\t\t\tthrow new Error( 'Transition$getStyle must be passed a string, or an array of strings representing CSS properties' );\n\t\t}\n\n\t\tstyles = {};\n\n\t\ti = props.length;\n\t\twhile ( i-- ) {\n\t\t\tprop = props[i];\n\t\t\tvalue = computedStyle[ prefix( prop ) ];\n\t\t\tif ( value === '0px' ) {\n\t\t\t\tvalue = 0;\n\t\t\t}\n\t\t\tstyles[ prop ] = value;\n\t\t}\n\n\t\treturn styles;\n\t}\n\n\tprocessParams ( params, defaults ) {\n\t\tif ( typeof params === 'number' ) {\n\t\t\tparams = { duration: params };\n\t\t}\n\n\t\telse if ( typeof params === 'string' ) {\n\t\t\tif ( params === 'slow' ) {\n\t\t\t\tparams = { duration: 600 };\n\t\t\t} else if ( params === 'fast' ) {\n\t\t\t\tparams = { duration: 200 };\n\t\t\t} else {\n\t\t\t\tparams = { duration: 400 };\n\t\t\t}\n\t\t} else if ( !params ) {\n\t\t\tparams = {};\n\t\t}\n\n\t\treturn extend( {}, defaults, params );\n\t}\n\n\tsetStyle ( style, value ) {\n\t\tvar prop;\n\n\t\tif ( typeof style === 'string' ) {\n\t\t\tthis.node.style[ prefix( style ) ] = value;\n\t\t}\n\n\t\telse {\n\t\t\tfor ( prop in style ) {\n\t\t\t\tif ( style.hasOwnProperty( prop ) ) {\n\t\t\t\t\tthis.node.style[ prefix( prop ) ] = style[ prop ];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tstart () {\n\t\tvar node, originalStyle, completed;\n\n\t\tnode = this.node = this.owner.node;\n\t\toriginalStyle = node.getAttribute( 'style' );\n\n\t\t// create t.complete() - we don't want this on the prototype,\n\t\t// because we don't want `this` silliness when passing it as\n\t\t// an argument\n\t\tthis.complete = noReset => {\n\t\t\tif ( completed ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( !noReset && this.isIntro ) {\n\t\t\t\tresetStyle( node, originalStyle);\n\t\t\t}\n\n\t\t\tthis._manager.remove( this );\n\n\t\t\tcompleted = true;\n\t\t};\n\n\t\t// If the transition function doesn't exist, abort\n\t\tif ( !this._fn ) {\n\t\t\tthis.complete();\n\t\t\treturn;\n\t\t}\n\n\t\tthis._fn.apply( this.root, [ this ].concat( this.params ) );\n\t}\n}\n","export default function updateLiveQueries ( element ) {\n\t// Does this need to be added to any live queries?\n\tconst node = element.node;\n\tlet instance = element.ractive;\n\n\tdo {\n\t\tconst liveQueries = instance._liveQueries;\n\n\t\tlet i = liveQueries.length;\n\t\twhile ( i-- ) {\n\t\t\tconst selector = liveQueries[i];\n\t\t\tconst query = liveQueries[ `_${selector}` ];\n\n\t\t\tif ( query.test( node ) ) {\n\t\t\t\tquery.add( node );\n\t\t\t\t// keep register of applicable selectors, for when we teardown\n\t\t\t\telement.liveQueries.push( query );\n\t\t\t}\n\t\t}\n\t} while ( instance = instance.parent );\n}\n","import runloop from 'global/runloop';\nimport { warnOnceIfDebug } from 'utils/log';\n\n// TODO element.parent currently undefined\nfunction findParentForm ( element ) {\n\twhile ( element = element.parent ) {\n\t\tif ( element.name === 'form' ) {\n\t\t\treturn element;\n\t\t}\n\t}\n}\n\nfunction warnAboutAmbiguity ( description, ractive ) {\n\twarnOnceIfDebug( `The ${description} being used for two-way binding is ambiguous, and may cause unexpected results. Consider initialising your data to eliminate the ambiguity`, { ractive });\n}\n\nexport default class Binding {\n\tconstructor ( element, name = 'value' ) {\n\t\tthis.element = element;\n\t\tthis.ractive = element.ractive;\n\t\tthis.attribute = element.attributeByName[ name ];\n\n\t\tconst interpolator = this.attribute.interpolator;\n\t\tinterpolator.twowayBinding = this;\n\n\t\tlet model = interpolator.model;\n\n\t\t// not bound?\n\t\tif ( !model ) {\n\t\t\t// try to force resolution\n\t\t\tinterpolator.resolver.forceResolution();\n\t\t\tmodel = interpolator.model;\n\n\t\t\twarnAboutAmbiguity( `'${interpolator.template.r}' reference`, this.ractive );\n\t\t}\n\n\t\telse if ( model.isUnresolved ) {\n\t\t\t// reference expressions (e.g. foo[bar])\n\t\t\tmodel.forceResolution();\n\t\t\twarnAboutAmbiguity( 'expression', this.ractive );\n\t\t}\n\n\t\t// TODO include index/key/keypath refs as read-only\n\t\telse if ( model.isReadonly ) {\n\t\t\tconst keypath = model.getKeypath().replace( /^@/, '' );\n\t\t\twarnOnceIfDebug( `Cannot use two-way binding on <${element.name}> element: ${keypath} is read-only. To suppress this warning use <${element.name} twoway='false'...>`, { ractive: this.ractive });\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.attribute.isTwoway = true;\n\t\tthis.model = model;\n\n\t\t// initialise value, if it's undefined\n\t\tlet value = model.get();\n\n\t\tif ( value === undefined && this.getInitialValue ) {\n\t\t\tvalue = this.getInitialValue();\n\t\t\tmodel.set( value );\n\t\t}\n\n\t\tconst parentForm = findParentForm( element );\n\t\tif ( parentForm ) {\n\t\t\tthis.resetValue = value;\n\t\t\tparentForm.formBindings.push( this );\n\t\t}\n\t}\n\n\tbind () {\n\t\tthis.model.registerTwowayBinding( this );\n\t}\n\n\thandleChange () {\n\t\trunloop.start( this.root );\n\t\tthis.attribute.locked = true;\n\t\tthis.model.set( this.getValue() );\n\t\trunloop.scheduleTask( () => this.attribute.locked = false );\n\t\trunloop.end();\n\t}\n\n\trebind () {\n\t\t// TODO what does this work with CheckboxNameBinding et al?\n\t\tthis.unbind();\n\t\tthis.model = this.attribute.interpolator.model;\n\t\tthis.bind();\n\t}\n\n\trender () {\n\t\tthis.node = this.element.node;\n\t\tthis.node._ractive.binding = this;\n\t\tthis.rendered = true; // TODO is this used anywhere?\n\t}\n\n\tunbind () {\n\t\tthis.model.unregisterTwowayBinding( this );\n\t}\n\n\tunrender () {\n\t\t// noop?\n\t}\n}\n","import Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class CheckboxBinding extends Binding {\n\tconstructor ( element ) {\n\t\tsuper( element, 'checked' );\n\t}\n\n\trender () {\n\t\tsuper.render();\n\n\t\tthis.node.addEventListener( 'change', handleDomEvent, false );\n\n\t\tif ( this.node.attachEvent ) {\n\t\t\tthis.node.addEventListener( 'click', handleDomEvent, false );\n\t\t}\n\t}\n\n\tunrender () {\n\t\tthis.node.removeEventListener( 'change', handleDomEvent, false );\n\t\tthis.node.removeEventListener( 'click', handleDomEvent, false );\n\t}\n\n\tgetInitialValue () {\n\t\treturn !!this.element.getAttribute( 'checked' );\n\t}\n\n\tgetValue () {\n\t\treturn this.node.checked;\n\t}\n}\n","import { removeFromArray } from 'utils/array';\n\nlet groups = {};\n\nexport default function getBindingGroup ( id, group, model, getValue ) {\n\tconst hash = id + group + model.getKeypath();\n\treturn groups[ hash ] || ( groups[ hash ] = new BindingGroup( model, getValue ) );\n}\n\nclass BindingGroup {\n\tconstructor ( model, getValue ) {\n\t\tthis.model = model;\n\t\tthis.getValue = getValue;\n\n\t\tthis.bindings = [];\n\t}\n\n\tadd ( binding ) {\n\t\tthis.bindings.push( binding );\n\t}\n\n\tbind () {\n\t\tthis.model.registerTwowayBinding( this );\n\t\tthis.bound = true;\n\t}\n\n\tremove ( binding ) {\n\t\tremoveFromArray( this.bindings, binding );\n\t\tif ( !this.bindings.length ) {\n\t\t\tthis.unbind();\n\t\t}\n\t}\n\n\tunbind () {\n\t\tthis.model.unregisterTwowayBinding( this );\n\t\tthis.bound = false;\n\t}\n}\n","import Binding from './Binding';\nimport { isArray } from 'utils/is';\nimport { arrayContains } from 'utils/array';\nimport getBindingGroup from './getBindingGroup';\nimport handleDomEvent from './handleDomEvent';\n\nfunction isChecked ( binding ) {\n\treturn binding.node.checked;\n}\n\nfunction getValue ( binding ) {\n\treturn binding.element.getAttribute( 'value' );\n}\n\nfunction getGroupValue () {\n\treturn this.bindings.filter( isChecked ).map( getValue );\n}\n\nconst push = [].push;\n\nexport default class CheckboxNameBinding extends Binding {\n\tconstructor ( element ) {\n\t\tsuper( element, 'name' );\n\n\t\tvar existingValue, bindingValue;\n\n\t\tthis.checkboxName = true; // so that ractive.updateModel() knows what to do with this\n\n\t\t// Each input has a reference to an array containing it and its\n\t\t// group, as two-way binding depends on being able to ascertain\n\t\t// the status of all inputs within the group\n\t\tthis.group = getBindingGroup( this.ractive._guid, 'checkboxes', this.model, getGroupValue );\n\t\tthis.group.add( this );\n\n\t\tif ( this.noInitialValue ) {\n\t\t\tthis.group.noInitialValue = true;\n\t\t}\n\n\t\t// If no initial value was set, and this input is checked, we\n\t\t// update the model\n\t\tif ( this.group.noInitialValue && this.element.getAttribute( 'checked' ) ) {\n\t\t\texistingValue = this.model.get();\n\t\t\tbindingValue = this.element.getAttribute( 'value' );\n\n\t\t\tpush.call( existingValue, bindingValue ); // to avoid triggering runloop with array adaptor\n\t\t}\n\t}\n\n\tbind () {\n\t\tif ( !this.group.bound ) {\n\t\t\tthis.group.bind();\n\t\t}\n\t}\n\n\tchanged () {\n\t\tvar wasChecked = !!this.isChecked;\n\t\tthis.isChecked = this.node.checked;\n\t\treturn this.isChecked === wasChecked;\n\t}\n\n\tgetInitialValue () {\n\t\t// This only gets called once per group (of inputs that\n\t\t// share a name), because it only gets called if there\n\t\t// isn't an initial value. By the same token, we can make\n\t\t// a note of that fact that there was no initial value,\n\t\t// and populate it using any `checked` attributes that\n\t\t// exist (which users should avoid, but which we should\n\t\t// support anyway to avoid breaking expectations)\n\t\tthis.noInitialValue = true;\n\t\treturn [];\n\t}\n\n\tgetValue () {\n\t\treturn this.group.getValue();\n\t}\n\n\thandleChange () {\n\t\tthis.isChecked = this.element.node.checked;\n\t\tsuper.handleChange();\n\t}\n\n\trender () {\n\t\tsuper.render();\n\n\t\tconst node = this.node;\n\n\t\tconst existingValue = this.model.get();\n\t\tconst bindingValue = this.element.getAttribute( 'value' );\n\n\t\tif ( isArray( existingValue ) ) {\n\t\t\tthis.isChecked = arrayContains( existingValue, bindingValue );\n\t\t} else {\n\t\t\tthis.isChecked = existingValue == bindingValue;\n\t\t}\n\n\t\tnode.name = '{{' + this.model.getKeypath() + '}}';\n\t\tnode.checked = this.isChecked;\n\n\t\tnode.addEventListener( 'change', handleDomEvent, false );\n\n\t\t// in case of IE emergency, bind to click event as well\n\t\tif ( node.attachEvent ) {\n\t\t\tnode.addEventListener( 'click', handleDomEvent, false );\n\t\t}\n\t}\n\n\tunbind () {\n\t\tthis.group.remove( this );\n\t}\n\n\tunrender () {\n\t\tvar node = this.element.node;\n\n\t\tnode.removeEventListener( 'change', handleDomEvent, false );\n\t\tnode.removeEventListener( 'click', handleDomEvent, false );\n\t}\n}\n","import Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class ContentEditableBinding extends Binding {\n\tgetInitialValue () {\n\t\treturn this.element.fragment ? this.element.fragment.toString() : '';\n\t}\n\n\trender () {\n\t\tsuper.render();\n\n\t\tconst node = this.node;\n\n\t\tnode.addEventListener( 'change', handleDomEvent, false );\n\t\tnode.addEventListener( 'blur', handleDomEvent, false );\n\n\t\tif ( !this.ractive.lazy ) {\n\t\t\tnode.addEventListener( 'input', handleDomEvent, false );\n\n\t\t\tif ( node.attachEvent ) {\n\t\t\t\tnode.addEventListener( 'keyup', handleDomEvent, false );\n\t\t\t}\n\t\t}\n\t}\n\n\tunrender () {\n\t\tconst node = this.node;\n\n\t\tnode.removeEventListener( 'blur', handleDomEvent, false );\n\t\tnode.removeEventListener( 'change', handleDomEvent, false );\n\t\tnode.removeEventListener( 'input', handleDomEvent, false );\n\t\tnode.removeEventListener( 'keyup', handleDomEvent, false );\n\t}\n\n\tgetValue () {\n\t\treturn this.element.node.innerHTML;\n\t}\n}\n","import Binding from './Binding';\n\nexport default class FileListBinding extends Binding {\n\n}\n","import Binding from './Binding';\nimport { isNumeric } from 'utils/is';\nimport handleDomEvent from './handleDomEvent';\n\nfunction handleBlur () {\n\tvar value;\n\n\thandleDomEvent.call( this );\n\n\tvalue = this._ractive.binding.model.get();\n\tthis.value = value == undefined ? '' : value;\n}\n\nfunction handleDelay ( delay ) {\n\tlet timeout;\n\n\treturn function () {\n\t\tif ( timeout ) clearTimeout( timeout );\n\n\t\ttimeout = setTimeout( () => {\n\t\t\tconst binding = this._ractive.binding;\n\t\t\tif ( binding.rendered ) handleDomEvent.call( this );\n\t\t\ttimeout = null;\n\t\t}, delay );\n\t};\n}\n\nexport default class GenericBinding extends Binding {\n\tgetInitialValue () {\n\t\treturn '';\n\t}\n\n\tgetValue () {\n\t\treturn this.node.value;\n\t}\n\n\trender () {\n\t\tsuper.render();\n\n\t\t// any lazy setting for this element overrides the root\n\t\t// if the value is a number, it's a timeout\n\t\tlet lazy = this.ractive.lazy;\n\t\tlet timeout = false;\n\n\t\t// TODO handle at parse time\n\t\tif ( this.element.template.a && ( 'lazy' in this.element.template.a ) ) {\n\t\t\tlazy = this.element.template.a.lazy;\n\t\t\tif ( lazy === 0 ) lazy = true; // empty attribute\n\t\t}\n\n\t\t// TODO handle this at parse time as well?\n\t\tif ( lazy === 'false' ) lazy = false;\n\n\t\tif ( isNumeric( lazy ) ) {\n\t\t\ttimeout = +lazy;\n\t\t\tlazy = false;\n\t\t}\n\n\t\tthis.handler = timeout ? handleDelay( timeout ) : handleDomEvent;\n\n\t\tconst node = this.node;\n\n\t\tnode.addEventListener( 'change', handleDomEvent, false );\n\n\t\tif ( !lazy ) {\n\t\t\tnode.addEventListener( 'input', this.handler, false );\n\n\t\t\tif ( node.attachEvent ) {\n\t\t\t\tnode.addEventListener( 'keyup', this.handler, false );\n\t\t\t}\n\t\t}\n\n\t\tnode.addEventListener( 'blur', handleBlur, false );\n\t}\n\n\tunrender () {\n\t\tvar node = this.element.node;\n\t\tthis.rendered = false;\n\n\t\tnode.removeEventListener( 'change', handleDomEvent, false );\n\t\tnode.removeEventListener( 'input', this.handler, false );\n\t\tnode.removeEventListener( 'keyup', this.handler, false );\n\t\tnode.removeEventListener( 'blur', handleBlur, false );\n\t}\n}\n","import runloop from 'global/runloop';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\nimport { arrayContentsMatch } from 'utils/array';\n\nexport default class MultipleSelectBinding extends Binding {\n\tforceUpdate () {\n\t\tvar value = this.getValue();\n\n\t\tif ( value !== undefined ) {\n\t\t\tthis.attribute.locked = true;\n\t\t\trunloop.scheduleTask( () => this.attribute.locked = false );\n\t\t\tthis.model.set( value );\n\t\t}\n\t}\n\n\tgetInitialValue () {\n\t\treturn this.element.options\n\t\t\t.filter( option => option.getAttribute( 'selected' ) )\n\t\t\t.map( option => option.getAttribute( 'value' ) );\n\t}\n\n\tgetValue () {\n\t\tconst options = this.element.node.options;\n\t\tconst len = options.length;\n\n\t\tlet selectedValues = [];\n\n\t\tfor ( let i = 0; i < len; i += 1 ) {\n\t\t\tconst option = options[i];\n\n\t\t\tif ( option.selected ) {\n\t\t\t\tconst optionValue = option._ractive ? option._ractive.value : option.value;\n\t\t\t\tselectedValues.push( optionValue );\n\t\t\t}\n\t\t}\n\n\t\treturn selectedValues;\n\t}\n\n\thandleChange () {\n\t\tconst attribute = this.attribute;\n\t\tconst previousValue = attribute.getValue();\n\n\t\tconst value = this.getValue();\n\n\t\tif ( previousValue === undefined || !arrayContentsMatch( value, previousValue ) ) {\n\t\t\tsuper.handleChange();\n\t\t}\n\n\t\treturn this;\n\t}\n\n\trender () {\n\t\tsuper.render();\n\n\t\tthis.node.addEventListener( 'change', handleDomEvent, false );\n\n\t\tif ( this.model.get() === undefined ) {\n\t\t\t// get value from DOM, if possible\n\t\t\tthis.handleChange();\n\t\t}\n\t}\n\n\tsetValue () {\n\t\tthrow new Error( 'TODO not implemented yet' );\n\t}\n\n\tunrender () {\n\t\tthis.node.removeEventListener( 'change', handleDomEvent, false );\n\t}\n\n\tupdateModel () {\n\t\tif ( this.attribute.value === undefined || !this.attribute.value.length ) {\n\t\t\tthis.keypath.set( this.initialValue );\n\t\t}\n\t}\n}\n","import Binding from './Binding';\n\nexport default class NumericBinding extends Binding {\n\tgetInitialValue () {\n\t\treturn undefined;\n\t}\n\t\n\tgetValue () {\n\t\tconst value = parseFloat( this.node.value );\n\t\treturn isNaN( value ) ? undefined : value;\n\t}\n}\n","import runloop from 'global/runloop';\nimport { removeFromArray } from 'utils/array';\nimport Binding from './Binding';\nimport getBindingGroup from './getBindingGroup';\nimport handleDomEvent from './handleDomEvent';\n\nlet siblings = {};\n\nfunction getSiblings ( hash ) {\n\treturn siblings[ hash ] || ( siblings[ hash ] = [] );\n}\n\nexport default class RadioBinding extends Binding {\n\tconstructor ( element ) {\n\t\tsuper( element, 'checked' );\n\n\t\t// TODO this should use getBindingGroup\n\t\tthis.siblings = getSiblings( this.ractive._guid + this.element.getAttribute( 'name' ) );\n\t\tthis.siblings.push( this );\n\t}\n\n\tgetValue () {\n\t\treturn this.node.checked;\n\t}\n\n\thandleChange () {\n\t\trunloop.start( this.root );\n\n\t\tthis.siblings.forEach( binding => {\n\t\t\tbinding.model.set( binding.getValue() );\n\t\t});\n\n\t\trunloop.end();\n\t}\n\n\trender () {\n\t\tsuper.render();\n\n\t\tthis.node.addEventListener( 'change', handleDomEvent, false );\n\n\t\tif ( this.node.attachEvent ) {\n\t\t\tthis.node.addEventListener( 'click', handleDomEvent, false );\n\t\t}\n\t}\n\n\tunbind () {\n\t\tremoveFromArray( this.siblings, this );\n\t}\n\n\tunrender () {\n\t\tthis.node.removeEventListener( 'change', handleDomEvent, false );\n\t\tthis.node.removeEventListener( 'click', handleDomEvent, false );\n\t}\n}\n","import Binding from './Binding';\nimport getBindingGroup from './getBindingGroup';\nimport handleDomEvent from './handleDomEvent';\n\nfunction getGroupValue () {\n\tlet i = this.bindings.length;\n\twhile ( i-- ) {\n\t\tconst binding = this.bindings[i];\n\t\tif ( binding.node.checked ) return binding.element.getAttribute( 'value' );\n\t}\n}\n\nexport default class RadioNameBinding extends Binding {\n\tconstructor ( element ) {\n\t\tsuper( element, 'name' );\n\n\t\tthis.group = getBindingGroup( this.ractive._guid, 'radioname', this.model, getGroupValue );\n\t\tthis.group.add( this );\n\t}\n\n\tbind () {\n\t\tif ( !this.group.bound ) {\n\t\t\tthis.group.bind();\n\t\t}\n\n\t\t// update name keypath when necessary\n\t\tthis.nameAttributeBinding = {\n\t\t\thandleChange: () => this.node.name = `{{${this.model.getKeypath()}}}`\n\t\t};\n\n\t\tthis.model.getKeypathModel().register( this.nameAttributeBinding );\n\t}\n\n\tgetInitialValue () {\n\t\tif ( this.element.getAttribute( 'checked' ) ) {\n\t\t\treturn this.element.getAttribute( 'value' );\n\t\t}\n\t}\n\n\tgetValue () {\n\t\treturn this.element.getAttribute( 'value' );\n\t}\n\n\thandleChange () {\n\t\t// If this <input> is the one that's checked, then the value of its\n\t\t// `name` model gets set to its value\n\t\tif ( this.node.checked ) {\n\t\t\tsuper.handleChange();\n\t\t}\n\t}\n\n\trender () {\n\t\tsuper.render();\n\n\t\tconst node = this.node;\n\n\t\tnode.name = `{{${this.model.getKeypath()}}}`;\n\t\tnode.checked = this.model.get() == this.element.getAttribute( 'value' );\n\n\t\tnode.addEventListener( 'change', handleDomEvent, false );\n\n\t\tif ( node.attachEvent ) {\n\t\t\tnode.addEventListener( 'click', handleDomEvent, false );\n\t\t}\n\t}\n\n\tunbind () {\n\t\tthis.group.remove( this );\n\n\t\tthis.model.getKeypathModel().unregister( this.nameAttributeBinding );\n\t}\n\n\tunrender () {\n\t\tvar node = this.node;\n\n\t\tnode.removeEventListener( 'change', handleDomEvent, false );\n\t\tnode.removeEventListener( 'click', handleDomEvent, false );\n\t}\n}\n","import runloop from 'global/runloop';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class SingleSelectBinding extends Binding {\n\tforceUpdate () {\n\t\tconst value = this.getValue();\n\n\t\tif ( value !== undefined ) {\n\t\t\tthis.attribute.locked = true;\n\t\t\trunloop.scheduleTask( () => this.attribute.locked = false );\n\t\t\tthis.model.set( value );\n\t\t}\n\t}\n\n\tgetInitialValue () {\n\t\tif ( this.element.getAttribute( 'value' ) !== undefined ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst options = this.element.options;\n\t\tconst len = options.length;\n\n\t\tif ( !len ) return;\n\n\t\tlet value;\n\t\tlet optionWasSelected;\n\t\tlet i = len;\n\n\t\t// take the final selected option...\n\t\twhile ( i-- ) {\n\t\t\tconst option = options[i];\n\n\t\t\tif ( option.getAttribute( 'selected' ) ) {\n\t\t\t\tif ( !option.getAttribute( 'disabled' ) ) {\n\t\t\t\t\tvalue = option.getAttribute( 'value' );\n\t\t\t\t}\n\n\t\t\t\toptionWasSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\t// or the first non-disabled option, if none are selected\n\t\tif ( !optionWasSelected ) {\n\t\t\twhile ( ++i < len ) {\n\t\t\t\tif ( !options[i].getAttribute( 'disabled' ) ) {\n\t\t\t\t\tvalue = options[i].getAttribute( 'value' );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// This is an optimisation (aka hack) that allows us to forgo some\n\t\t// other more expensive work\n\t\t// TODO does it still work? seems at odds with new architecture\n\t\tif ( value !== undefined ) {\n\t\t\tthis.element.attributeByName.value.value = value;\n\t\t}\n\n\t\treturn value;\n\t}\n\n\tgetValue () {\n\t\tvar options, i, len, option, optionValue;\n\n\t\toptions = this.node.options;\n\t\tlen = options.length;\n\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\toption = options[i];\n\n\t\t\tif ( options[i].selected && !options[i].disabled ) {\n\t\t\t\toptionValue = option._ractive ? option._ractive.value : option.value;\n\t\t\t\treturn optionValue;\n\t\t\t}\n\t\t}\n\t}\n\n\trender () {\n\t\tsuper.render();\n\t\tthis.node.addEventListener( 'change', handleDomEvent, false );\n\t}\n\n\t// TODO this method is an anomaly... is it necessary?\n\tsetValue ( value ) {\n\t\tthis.model.set( value );\n\t}\n\n\tunrender () {\n\t\tthis.node.removeEventListener( 'change', handleDomEvent, false );\n\t}\n}\n","import { ELEMENT } from 'config/types';\nimport runloop from 'global/runloop';\nimport Item from './shared/Item';\nimport Fragment from '../Fragment';\nimport Attribute from './element/Attribute';\nimport ConditionalAttribute from './element/ConditionalAttribute';\nimport Decorator from './element/Decorator';\nimport EventHandler from './element/EventHandler';\nimport Transition from './element/Transition';\nimport updateLiveQueries from './element/updateLiveQueries';\nimport { escapeHtml, voidElementNames } from 'utils/html';\nimport { bind, rebind, render, unbind, unrender, update } from 'shared/methodCallers';\nimport { createElement, matches } from 'utils/dom';\nimport { html, svg } from 'config/namespaces';\nimport { defineProperty } from 'utils/object';\nimport selectBinding from './element/binding/selectBinding';\n\nfunction makeDirty ( query ) {\n\tquery.makeDirty();\n}\n\nexport default class Element extends Item {\n\tconstructor ( options ) {\n\t\tsuper( options );\n\n\t\tthis.liveQueries = []; // TODO rare case. can we handle differently?\n\n\t\tthis.name = options.template.e.toLowerCase();\n\t\tthis.isVoid = voidElementNames.test( this.name );\n\n\t\t// find parent element\n\t\tlet fragment = this.parentFragment;\n\t\twhile ( fragment ) {\n\t\t\tif ( fragment.owner.type === ELEMENT ) {\n\t\t\t\tthis.parent = fragment.owner;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tfragment = fragment.parent;\n\t\t}\n\n\t\t// create attributes\n\t\tthis.attributeByName = {};\n\t\tthis.attributes = [];\n\n\t\tif ( this.template.a ) {\n\t\t\tObject.keys( this.template.a ).forEach( name => {\n\t\t\t\t// TODO process this at parse time\n\t\t\t\tif ( name === 'twoway' || name === 'lazy' ) return;\n\n\t\t\t\tconst attribute = new Attribute({\n\t\t\t\t\tname,\n\t\t\t\t\telement: this,\n\t\t\t\t\tparentFragment: this.parentFragment,\n\t\t\t\t\ttemplate: this.template.a[ name ]\n\t\t\t\t});\n\n\t\t\t\tthis.attributeByName[ name ] = attribute;\n\n\t\t\t\tif ( name !== 'value' && name !== 'type' ) this.attributes.push( attribute );\n\t\t\t});\n\n\t\t\tif ( this.attributeByName.type ) this.attributes.unshift( this.attributeByName.type );\n\t\t\tif ( this.attributeByName.value ) this.attributes.push( this.attributeByName.value );\n\t\t}\n\n\t\t// create conditional attributes\n\t\tthis.conditionalAttributes = ( this.template.m || [] ).map( template => {\n\t\t\treturn new ConditionalAttribute({\n\t\t\t\towner: this,\n\t\t\t\tparentFragment: this.parentFragment,\n\t\t\t\ttemplate\n\t\t\t});\n\t\t});\n\n\t\t// create decorator\n\t\tif ( this.template.o ) {\n\t\t\tthis.decorator = new Decorator( this, this.template.o );\n\t\t}\n\n\t\t// attach event handlers\n\t\tthis.eventHandlers = [];\n\t\tif ( this.template.v ) {\n\t\t\tObject.keys( this.template.v ).forEach( key => {\n\t\t\t\tconst eventNames = key.split( '-' );\n\t\t\t\tconst template = this.template.v[ key ];\n\n\t\t\t\teventNames.forEach( eventName => {\n\t\t\t\t\tthis.eventHandlers.push( new EventHandler( this, eventName, template ) );\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\t// create children\n\t\tif ( options.template.f ) {\n\t\t\tthis.fragment = new Fragment({\n\t\t\t\ttemplate: options.template.f,\n\t\t\t\towner: this,\n\t\t\t\tcssIds: null\n\t\t\t});\n\t\t}\n\n\t\tthis.binding = null; // filled in later\n\t}\n\n\tbind () {\n\t\tthis.attributes.forEach( bind );\n\t\tthis.conditionalAttributes.forEach( bind );\n\t\tthis.eventHandlers.forEach( bind );\n\n\t\tif ( this.decorator ) this.decorator.bind();\n\t\tif ( this.fragment ) this.fragment.bind();\n\n\t\t// create two-way binding if necessary\n\t\tif ( this.binding = this.createTwowayBinding() ) this.binding.bind();\n\t}\n\n\tcreateTwowayBinding () {\n\t\tconst attributes = this.template.a;\n\n\t\tif ( !attributes ) return null;\n\n\t\tconst shouldBind = 'twoway' in attributes ?\n\t\t\tattributes.twoway === 0 || attributes.twoway === 'true' : // covers `twoway` and `twoway='true'`\n\t\t\tthis.ractive.twoway;\n\n\t\tif ( !shouldBind ) return null;\n\n\t\tconst Binding = selectBinding( this );\n\n\t\tif ( !Binding ) return null;\n\n\t\tconst binding = new Binding( this );\n\n\t\treturn binding && binding.model ?\n\t\t\tbinding :\n\t\t\tnull;\n\t}\n\n\tdetach () {\n\t\tif ( this.decorator ) this.decorator.unrender();\n\n\t\tconst parentNode = this.node.parentNode;\n\t\tif ( parentNode ) parentNode.removeChild( this.node );\n\n\t\treturn this.node;\n\t}\n\n\tfind ( selector ) {\n\t\tif ( matches( this.node, selector ) ) return this.node;\n\t\tif ( this.fragment ) {\n\t\t\treturn this.fragment.find( selector );\n\t\t}\n\t}\n\n\tfindAll ( selector, query ) {\n\t\t// Add this node to the query, if applicable, and register the\n\t\t// query on this element\n\t\tconst matches = query.test( this.node );\n\t\tif ( matches ) {\n\t\t\tquery.add( this.node );\n\t\t\tif ( query.live ) this.liveQueries.push( query );\n\t\t}\n\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.findAll( selector, query );\n\t\t}\n\t}\n\n\tfindComponent ( name ) {\n\t\tif ( this.fragment ) {\n\t\t\treturn this.fragment.findComponent( name );\n\t\t}\n\t}\n\n\tfindAllComponents ( name, query ) {\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.findAllComponents( name, query );\n\t\t}\n\t}\n\n\tfindNextNode () {\n\t\treturn null;\n\t}\n\n\tfirstNode () {\n\t\treturn this.node;\n\t}\n\n\tgetAttribute ( name ) {\n\t\tconst attribute = this.attributeByName[ name ];\n\t\treturn attribute ? attribute.getValue() : undefined;\n\t}\n\n\trebind () {\n\t\tthis.attributes.forEach( rebind );\n\t\tthis.conditionalAttributes.forEach( rebind );\n\t\tif ( this.decorator ) this.decorator.rebind();\n\t\tif ( this.fragment ) this.fragment.rebind();\n\t\tif ( this.binding ) this.binding.rebind();\n\n\t\tthis.liveQueries.forEach( makeDirty );\n\t}\n\n\trender ( target ) {\n\t\t// TODO determine correct namespace\n\t\tthis.namespace = getNamespace( this );\n\n\t\tconst node = createElement( this.template.e, this.namespace );\n\t\tthis.node = node;\n\n\t\tconst context = this.parentFragment.findContext();\n\n\t\tdefineProperty( node, '_ractive', {\n\t\t\tvalue: {\n\t\t\t\tproxy: this,\n\t\t\t\tractive: this.ractive,\n\t\t\t\tfragment: this.parentFragment,\n\t\t\t\tevents: {},\n\t\t\t\tcontext,\n\t\t\t\tkeypath: context.getKeypath()\n\t\t\t}\n\t\t});\n\n\t\t// Is this a top-level node of a component? If so, we may need to add\n\t\t// a data-ractive-css attribute, for CSS encapsulation\n\t\tif ( this.parentFragment.cssIds ) {\n\t\t\tnode.setAttribute( 'data-ractive-css', this.parentFragment.cssIds.map( x => `{${x}}` ).join( ' ' ) );\n\t\t}\n\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.render( node );\n\t\t}\n\n\t\tthis.attributes.forEach( render );\n\t\tthis.conditionalAttributes.forEach( render );\n\n\t\tif ( this.decorator ) runloop.scheduleTask( () => this.decorator.render(), true );\n\t\tif ( this.binding ) this.binding.render();\n\n\t\tthis.eventHandlers.forEach( render );\n\n\t\tupdateLiveQueries( this );\n\n\t\t// transitions\n\t\tconst transitionTemplate = this.template.t0 || this.template.t1;\n\t\tif ( transitionTemplate && this.ractive.transitionsEnabled ) {\n\t\t\tconst transition = new Transition( this, transitionTemplate, true );\n\t\t\trunloop.registerTransition( transition );\n\n\t\t\tthis._introTransition = transition; // so we can abort if it gets removed\n\t\t}\n\n\t\ttarget.appendChild( node );\n\n\t\tthis.rendered = true;\n\t}\n\n\ttoString () {\n\t\tconst tagName = this.template.e;\n\n\t\tlet attrs = this.attributes.map( stringifyAttribute ).join( '' ) +\n\t\t            this.conditionalAttributes.map( stringifyAttribute ).join( '' );\n\n\t\t// Special case - selected options\n\t\tif ( this.name === 'option' && this.isSelected() ) {\n\t\t\tattrs += ' selected';\n\t\t}\n\n\t\t// Special case - two-way radio name bindings\n\t\tif ( this.name === 'input' && inputIsCheckedRadio( this ) ) {\n\t\t\tattrs += ' checked';\n\t\t}\n\n\t\tlet str = `<${tagName}${attrs}>`;\n\n\t\tif ( this.isVoid ) return str;\n\n\t\t// Special case - textarea\n\t\tif ( this.name === 'textarea' && this.getAttribute( 'value' ) !== undefined ) {\n\t\t\tstr += escapeHtml( this.getAttribute( 'value' ) );\n\t\t}\n\n\t\t// Special case - contenteditable\n\t\telse if ( this.getAttribute( 'contenteditable' ) !== undefined ) {\n\t\t\tstr += ( this.getAttribute( 'value' ) || '' );\n\t\t}\n\n\t\tif ( this.fragment ) {\n\t\t\tstr += this.fragment.toString( !/^(?:script|style)$/i.test( this.template.e ) ); // escape text unless script/style\n\t\t}\n\n\t\tstr += `</${tagName}>`;\n\t\treturn str;\n\t}\n\n\tunbind () {\n\t\tthis.attributes.forEach( unbind );\n\t\tthis.conditionalAttributes.forEach( unbind );\n\n\t\tif ( this.decorator ) this.decorator.unbind();\n\t\tif ( this.fragment ) this.fragment.unbind();\n\t}\n\n\tunrender ( shouldDestroy ) {\n\t\tif ( !this.rendered ) return;\n\t\tthis.rendered = false;\n\n\t\t// unrendering before intro completed? complete it now\n\t\t// TODO should be an API for aborting transitions\n\t\tlet transition = this._introTransition;\n\t\tif ( transition ) transition.complete();\n\n\t\t// Detach as soon as we can\n\t\tif ( this.name === 'option' ) {\n\t\t\t// <option> elements detach immediately, so that\n\t\t\t// their parent <select> element syncs correctly, and\n\t\t\t// since option elements can't have transitions anyway\n\t\t\tthis.detach();\n\t\t} else if ( shouldDestroy ) {\n\t\t\trunloop.detachWhenReady( this );\n\t\t}\n\n\t\tif ( this.fragment ) this.fragment.unrender();\n\n\t\tthis.eventHandlers.forEach( unrender );\n\n\t\tif ( this.binding ) this.binding.unrender();\n\t\tif ( !shouldDestroy && this.decorator ) this.decorator.unrender();\n\n\t\t// outro transition\n\t\tconst transitionTemplate = this.template.t0 || this.template.t2;\n\t\tif ( transitionTemplate && this.ractive.transitionsEnabled ) {\n\t\t\tconst transition = new Transition( this, transitionTemplate, false );\n\t\t\trunloop.registerTransition( transition );\n\t\t}\n\n\t\t// special case\n\t\tconst id = this.attributeByName.id;\n\t\tif ( id  ) {\n\t\t\tdelete this.ractive.nodes[ id.getValue() ];\n\t\t}\n\n\t\tremoveFromLiveQueries( this );\n\t\t// TODO forms are a special case\n\t}\n\n\tupdate () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.attributes.forEach( update );\n\t\t\tthis.conditionalAttributes.forEach( update );\n\t\t\tthis.eventHandlers.forEach( update );\n\n\t\t\tif ( this.decorator ) this.decorator.update();\n\t\t\tif ( this.fragment ) this.fragment.update();\n\n\t\t\tthis.dirty = false;\n\t\t}\n\t}\n}\n\nfunction inputIsCheckedRadio ( element ) {\n\tconst attributes = element.attributeByName;\n\n\tconst typeAttribute  = attributes.type;\n\tconst valueAttribute = attributes.value;\n\tconst nameAttribute  = attributes.name;\n\n\tif ( !typeAttribute || ( typeAttribute.value !== 'radio' ) || !valueAttribute || !nameAttribute.interpolator ) {\n\t\treturn;\n\t}\n\n\tif ( valueAttribute.getValue() === nameAttribute.interpolator.model.get() ) {\n\t\treturn true;\n\t}\n}\n\nfunction stringifyAttribute ( attribute ) {\n\tconst str = attribute.toString();\n\treturn str ? ' ' + str : '';\n}\n\nfunction removeFromLiveQueries ( element ) {\n\tlet i = element.liveQueries.length;\n\twhile ( i-- ) {\n\t\tconst query = element.liveQueries[i];\n\t\tquery.remove( element.node );\n\t}\n}\n\nfunction getNamespace ( element ) {\n\t// Use specified namespace...\n\tconst xmlns = element.getAttribute( 'xmlns' );\n\tif ( xmlns ) return xmlns;\n\n\t// ...or SVG namespace, if this is an <svg> element\n\tif ( element.name === 'svg' ) return svg;\n\n\tconst parent = element.parent;\n\n\tif ( parent ) {\n\t\t// ...or HTML, if the parent is a <foreignObject>\n\t\tif ( parent.name === 'foreignobject' ) return html;\n\n\t\t// ...or inherit from the parent node\n\t\treturn parent.node.namespaceURI;\n\t}\n\n\treturn element.ractive.el.namespaceURI;\n}\n","import runloop from 'global/runloop';\nimport Element from '../../Element';\n\nexport default class Form extends Element {\n\tconstructor ( options ) {\n\t\tsuper( options );\n\t\tthis.formBindings = [];\n\t}\n\n\trender ( target ) {\n\t\tsuper.render( target );\n\t\tthis.node.addEventListener( 'reset', handleReset, false );\n\t}\n\n\tunrender () {\n\t\tthis.node.removeEventListener( 'reset', handleReset, false );\n\t}\n}\n\nfunction handleReset () {\n\tvar element = this._ractive.proxy;\n\n\trunloop.start();\n\telement.formBindings.forEach( updateModel );\n\trunloop.end();\n}\n\nfunction updateModel ( binding ) {\n\tbinding.model.set( binding.resetValue );\n}\n","import runloop from 'global/runloop';\nimport { isEqual, isObject } from 'utils/is';\nimport { splitKeypath } from 'shared/keypaths';\nimport { cancel } from 'shared/methodCallers';\nimport resolveReference from 'view/resolvers/resolveReference';\n\nexport default function observe ( keypath, callback, options ) {\n\tlet observers = [];\n\n\tif ( isObject( keypath ) ) {\n\t\tconst map = keypath;\n\t\toptions = callback || {};\n\n\t\tObject.keys( map ).forEach( keypath => {\n\t\t\tconst callback = map[ keypath ];\n\n\t\t\tkeypath.split( ' ' ).forEach( keypath => {\n\t\t\t\tobservers.push( createObserver( this, keypath, callback, options ) );\n\t\t\t});\n\t\t});\n\t}\n\n\telse {\n\t\tlet keypaths;\n\n\t\tif ( typeof keypath === 'function' ) {\n\t\t\toptions = callback;\n\t\t\tcallback = keypath;\n\t\t\tkeypaths = [ '' ];\n\t\t} else {\n\t\t\tkeypaths = keypath.split( ' ' );\n\t\t}\n\n\t\tkeypaths.forEach( keypath => {\n\t\t\tobservers.push( createObserver( this, keypath, callback, options || {} ) );\n\t\t});\n\t}\n\n\t// add observers to the Ractive instance, so they can be\n\t// cancelled on ractive.teardown()\n\tthis._observers.push.apply( this._observers, observers );\n\n\treturn {\n\t\tcancel () {\n\t\t\tobservers.forEach( cancel );\n\t\t}\n\t};\n}\n\nfunction createObserver ( ractive, keypath, callback, options ) {\n\tconst viewmodel = ractive.viewmodel;\n\n\tconst keys = splitKeypath( keypath );\n\tconst wildcardIndex = keys.indexOf( '*' );\n\n\t// normal keypath - no wildcards\n\tif ( !~wildcardIndex ) {\n\t\tconst key = keys[0];\n\n\t\tif ( !viewmodel.has( key ) ) {\n\t\t\t// if this is an inline component, we may need to create an implicit mapping\n\t\t\tif ( ractive.component ) {\n\t\t\t\tconst model = resolveReference( ractive.component.parentFragment, key );\n\t\t\t\tif ( model ) viewmodel.map( key, model );\n\t\t\t}\n\t\t}\n\n\t\tconst model = viewmodel.joinAll( keys );\n\t\treturn new Observer( ractive, model, callback, options );\n\t}\n\n\t// pattern observers - more complex case\n\tconst baseModel = wildcardIndex === 0 ?\n\t\tviewmodel :\n\t\tviewmodel.joinAll( keys.slice( 0, wildcardIndex ) );\n\n\treturn new PatternObserver( ractive, baseModel, keys.splice( wildcardIndex ), callback, options );\n}\n\nclass Observer {\n\tconstructor ( context, model, callback, options ) {\n\t\tthis.context = context;\n\t\tthis.model = model;\n\t\tthis.keypath = model.getKeypath();\n\t\tthis.callback = callback;\n\n\t\tthis.oldValue = undefined;\n\t\tthis.newValue = model.get();\n\n\t\tthis.defer = options.defer;\n\t\tthis.once = options.once;\n\t\tthis.strict = options.strict;\n\n\t\tthis.dirty = false;\n\n\t\tif ( options.init !== false ) {\n\t\t\tthis.dispatch();\n\t\t} else {\n\t\t\tthis.oldValue = this.newValue;\n\t\t}\n\n\t\tmodel.register( this );\n\t}\n\n\tcancel () {\n\t\tthis.model.unregister( this );\n\t}\n\n\tdispatch () {\n\t\tthis.callback.call( this.context, this.newValue, this.oldValue, this.keypath );\n\t\tthis.oldValue = this.newValue;\n\t\tthis.dirty = false;\n\t}\n\n\thandleChange () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.newValue = this.model.get();\n\n\t\t\tif ( this.strict && this.newValue === this.oldValue ) return;\n\n\t\t\trunloop.addObserver( this, this.defer );\n\t\t\tthis.dirty = true;\n\n\t\t\tif ( this.once ) this.cancel();\n\t\t}\n\t}\n}\n\nclass PatternObserver {\n\tconstructor ( context, baseModel, keys, callback, options ) {\n\t\tthis.context = context;\n\t\tthis.baseModel = baseModel;\n\t\tthis.keys = keys;\n\t\tthis.callback = callback;\n\n\t\tconst pattern = keys.join( '\\\\.' ).replace( /\\*/g, '(.+)' );\n\t\tconst baseKeypath = baseModel.getKeypath();\n\t\tthis.pattern = new RegExp( `^${baseKeypath ? baseKeypath + '.' : ''}${pattern}$` );\n\n\t\tthis.oldValues = {};\n\t\tthis.newValues = {};\n\n\t\tthis.defer = options.defer;\n\t\tthis.once = options.once;\n\t\tthis.strict = options.strict;\n\n\t\tthis.dirty = false;\n\n\t\tthis.baseModel.findMatches( this.keys ).forEach( model => {\n\t\t\tthis.newValues[ model.getKeypath() ] = model.get();\n\t\t});\n\n\t\tif ( options.init !== false ) {\n\t\t\tthis.dispatch();\n\t\t} else {\n\t\t\tthis.oldValues = this.newValues;\n\t\t}\n\n\t\tbaseModel.register( this );\n\t}\n\n\tcancel () {\n\t\tthis.baseModel.unregister( this );\n\t}\n\n\tdispatch () {\n\t\tObject.keys( this.newValues ).forEach( keypath => {\n\t\t\tconst newValue = this.newValues[ keypath ];\n\t\t\tconst oldValue = this.oldValues[ keypath ];\n\n\t\t\tif ( this.strict && newValue === oldValue ) return;\n\t\t\tif ( isEqual( newValue, oldValue ) ) return;\n\n\t\t\tconst wildcards = this.pattern.exec( keypath ).slice( 1 );\n\t\t\tconst args = [ newValue, oldValue, keypath ].concat( wildcards );\n\n\t\t\tthis.callback.apply( this.context, args );\n\t\t});\n\n\t\tthis.oldValues = this.newValues;\n\t\tthis.dirty = false;\n\t}\n\n\thandleChange () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.newValues = {};\n\n\t\t\t// handle case where previously extant keypath no longer exists -\n\t\t\t// observer should still fire, with undefined as new value\n\t\t\t// TODO huh. according to the test suite that's not the case...\n\t\t\t// Object.keys( this.oldValues ).forEach( keypath => {\n\t\t\t// \tthis.newValues[ keypath ] = undefined;\n\t\t\t// });\n\n\t\t\tthis.baseModel.findMatches( this.keys ).forEach( model => {\n\t\t\t\tconst keypath = model.getKeypath();\n\t\t\t\tthis.newValues[ keypath ] = model.get();\n\t\t\t});\n\n\t\t\trunloop.addObserver( this, this.defer );\n\t\t\tthis.dirty = true;\n\n\t\t\tif ( this.once ) this.cancel();\n\t\t}\n\t}\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport { isArray } from 'utils/is';\n\nexport default function observeList ( keypath, callback, options ) {\n\tif ( typeof keypath !== 'string' ) {\n\t\tthrow new Error( 'ractive.observeList() must be passed a string as its first argument' );\n\t}\n\n\tconst model = this.viewmodel.joinAll( splitKeypath( keypath ) );\n\tconst observer = new ListObserver( this, model, callback, options || {} );\n\n\t// add observer to the Ractive instance, so it can be\n\t// cancelled on ractive.teardown()\n\tthis._observers.push( observer );\n\n\treturn {\n\t\tcancel () {\n\t\t\tobserver.cancel();\n\t\t}\n\t};\n}\n\nfunction negativeOne () {\n\treturn -1;\n}\n\nclass ListObserver {\n\tconstructor ( context, model, callback, options ) {\n\t\tthis.context = context;\n\t\tthis.model = model;\n\t\tthis.keypath = model.getKeypath();\n\t\tthis.callback = callback;\n\n\t\tthis.pending = null;\n\n\t\tmodel.register( this );\n\n\t\tif ( options.init !== false ) {\n\t\t\tthis.sliced = [];\n\t\t\tthis.shuffle([]);\n\t\t\tthis.handleChange();\n\t\t} else {\n\t\t\tthis.sliced = this.slice();\n\t\t}\n\t}\n\n\thandleChange () {\n\t\tif ( this.pending ) {\n\t\t\t// post-shuffle\n\t\t\tthis.callback( this.pending );\n\t\t\tthis.pending = null;\n\t\t}\n\n\t\telse {\n\t\t\t// entire array changed\n\t\t\tthis.shuffle( this.sliced.map( negativeOne ) );\n\t\t\tthis.handleChange();\n\t\t}\n\t}\n\n\tshuffle ( newIndices ) {\n\t\tconst newValue = this.slice();\n\n\t\tlet inserted = [];\n\t\tlet deleted = [];\n\t\tlet start;\n\n\t\tlet hadIndex = {};\n\n\t\tnewIndices.forEach( ( newIndex, oldIndex ) => {\n\t\t\thadIndex[ newIndex ] = true;\n\n\t\t\tif ( newIndex !== oldIndex && start === undefined ) {\n\t\t\t\tstart = oldIndex;\n\t\t\t}\n\n\t\t\tif ( newIndex === -1 ) {\n\t\t\t\tdeleted.push( this.sliced[ oldIndex ] );\n\t\t\t}\n\t\t});\n\n\t\tif ( start === undefined ) start = newIndices.length;\n\n\t\tlet len = newValue.length;\n\t\tfor ( let i = 0; i < len; i += 1 ) {\n\t\t\tif ( !hadIndex[i] ) inserted.push( newValue[i] );\n\t\t}\n\n\t\tthis.pending = { inserted, deleted, start };\n\t\tthis.sliced = newValue;\n\t}\n\n\tslice () {\n\t\tconst value = this.model.get();\n\t\treturn isArray( value ) ? value.slice() : [];\n\t}\n}\n","import { isObject } from 'utils/is';\nimport { extend } from 'utils/object';\n\nconst onceOptions = { init: false, once: true };\n\nexport default function observeOnce ( keypath, callback, options ) {\n\tif ( isObject( keypath ) || typeof keypath === 'function' ) {\n\t\toptions = extend( callback || {}, onceOptions );\n\t\treturn this.observe( keypath, options );\n\t}\n\n\toptions = extend( options || {}, onceOptions );\n\treturn this.observe( keypath, callback, options );\n}\n","export default str => str.trim();\n","export default str => str !== '';\n","export default function Ractive$once ( eventName, handler ) {\n\n\tvar listener = this.on( eventName, function () {\n\t\thandler.apply( this, arguments );\n\t\tlistener.cancel();\n\t});\n\n\t// so we can still do listener.cancel() manually\n\treturn listener;\n}\n","import { isArray } from 'utils/is';\nimport { normalise } from 'shared/keypaths';\nimport runloop from 'global/runloop';\nimport getNewIndices from 'shared/getNewIndices';\n\nvar arrayProto = Array.prototype;\n\nexport default function ( methodName ) {\n\treturn function ( keypath, ...args ) {\n\t\tconst model = this.viewmodel.joinAll( normalise( keypath ).split( '.' ) );\n\t\tconst array = model.get();\n\n\t\tif ( !isArray( array ) ) {\n\t\t\tthrow new Error( `shuffle array method ${methodName} called on non-array at ${keypath.getKeypath()}` );\n\t\t}\n\n\t\tconst newIndices = getNewIndices( array.length, methodName, args );\n\t\tconst result = arrayProto[ methodName ].apply( array, args );\n\n\t\tconst promise = runloop.start( this, true ).then( () => result );\n\n\t\tif ( newIndices ) {\n\t\t\tmodel.shuffle( newIndices );\n\t\t} else {\n\t\t\tmodel.set( result );\n\t\t}\n\n\t\trunloop.end();\n\n\t\treturn promise;\n\t};\n}\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod( 'pop' );\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod( 'push' );\n","import { doc } from 'config/environment';\nimport noop from 'utils/noop';\n\nvar css,\n\tupdate,\n\tstyleElement,\n\thead,\n\tstyleSheet,\n\tinDom,\n\tprefix = '/* Ractive.js component styles */\\n',\n\tstyles = [],\n\tdirty = false;\n\nif ( !doc ) {\n\t// TODO handle encapsulated CSS in server-rendered HTML!\n\tcss = {\n\t\tadd: noop,\n\t\tapply: noop\n\t};\n} else {\n\tstyleElement = doc.createElement( 'style' );\n\tstyleElement.type = 'text/css';\n\n\thead = doc.getElementsByTagName( 'head' )[0];\n\n\tinDom = false;\n\n\t// Internet Exploder won't let you use styleSheet.innerHTML - we have to\n\t// use styleSheet.cssText instead\n\tstyleSheet = styleElement.styleSheet;\n\n\tupdate = function () {\n\t\tlet css = prefix + styles.map( s => `\\n/* {${s.id}} */\\n${s.styles}` ).join( '\\n' );\n\n\t\tif ( styleSheet ) {\n\t\t\tstyleSheet.cssText = css;\n\t\t} else {\n\t\t\tstyleElement.innerHTML = css;\n\t\t}\n\n\t\tif ( !inDom ) {\n\t\t\thead.appendChild( styleElement );\n\t\t\tinDom = true;\n\t\t}\n\t};\n\n\tcss = {\n\t\tadd ( s ) {\n\t\t\tstyles.push( s );\n\t\t\tdirty = true;\n\t\t},\n\n\t\tapply () {\n\t\t\tif ( dirty ) {\n\t\t\t\tupdate();\n\t\t\t\tdirty = false;\n\t\t\t}\n\t\t}\n\t};\n}\n\nexport default css;\n","import { create } from 'utils/object';\nimport 'legacy';\n\nvar registryNames, Registry, registries;\n\nregistryNames = [\n\t'adaptors',\n\t'components',\n\t'computed',\n\t'decorators',\n\t'easing',\n\t'events',\n\t'interpolators',\n\t'partials',\n\t'transitions'\n];\n\nRegistry = function ( name, useDefaults ) {\n\tthis.name = name;\n\tthis.useDefaults = useDefaults;\n};\n\nRegistry.prototype = {\n\tconstructor: Registry,\n\n \textend: function ( Parent, proto, options ) {\n\t\tthis.configure(\n\t\t\tthis.useDefaults ? Parent.defaults : Parent,\n\t\t\tthis.useDefaults ? proto : proto.constructor,\n\t\t\toptions );\n\t},\n\n\tinit: function () {\n\t\t/*this.configure(\n\t\t\tthis.useDefaults ? Parent.defaults : Parent,\n\t\t\tractive,\n\t\t\toptions );*/\n\t},\n\n\tconfigure: function ( Parent, target, options ) {\n\t\tvar name = this.name, option = options[ name ], registry;\n\n\t\tregistry = create( Parent[name] );\n\n\t\tfor ( let key in option ) {\n\t\t\tregistry[ key ] = option[ key ];\n\t\t}\n\n\t\ttarget[ name ] = registry;\n\t},\n\n\treset: function ( ractive ) {\n\t\tvar registry = ractive[ this.name ];\n\t\tvar changed = false;\n\t\tObject.keys( registry ).forEach( key => {\n\t\t\tvar item = registry[key];\n\t\t\tif ( item._fn ) {\n\t\t\t\tif ( item._fn.isOwner ) {\n\t\t\t\t\tregistry[key] = item._fn;\n\t\t\t\t} else {\n\t\t\t\t\tdelete registry[key];\n\t\t\t\t}\n\t\t\t\tchanged = true;\n\t\t\t}\n\t\t});\n\t\treturn changed;\n\t}\n};\n\nregistries = registryNames.map( name => new Registry( name, name === 'computed' ) );\n\nexport default registries;\n","import { doc } from 'config/environment';\nimport css from 'global/css';\nimport Hook from 'events/Hook';\nimport { getElement } from 'utils/dom';\nimport runloop from 'global/runloop';\n\nconst renderHook = new Hook( 'render' );\nconst completeHook = new Hook( 'complete' );\n\nexport default function render ( ractive, target, anchor ) {\n\t// if `noIntro` is `true`, temporarily disable transitions\n\tconst transitionsEnabled = ractive.transitionsEnabled;\n\tif ( ractive.noIntro ) ractive.transitionsEnabled = false;\n\n\tconst promise = runloop.start( ractive, true );\n\trunloop.scheduleTask( () => renderHook.fire( ractive ), true );\n\n\tif ( ractive.fragment.rendered ) {\n\t\tthrow new Error( 'You cannot call ractive.render() on an already rendered instance! Call ractive.unrender() first' );\n\t}\n\n\tanchor = getElement( anchor ) || ractive.anchor;\n\n\tractive.el = target;\n\tractive.anchor = anchor;\n\n\t// ensure encapsulated CSS is up-to-date\n\tif ( ractive.cssId ) css.apply();\n\n\tif ( target ) {\n\t\t( target.__ractive_instances__ || ( target.__ractive_instances__ = [] ) ).push( ractive );\n\n\t\tif ( anchor ) {\n\t\t\tconst docFrag = doc.createDocumentFragment();\n\t\t\tractive.fragment.render( docFrag );\n\t\t\ttarget.insertBefore( docFrag, anchor );\n\t\t} else {\n\t\t\tractive.fragment.render( target );\n\t\t}\n\t}\n\n\trunloop.end();\n\tractive.transitionsEnabled = transitionsEnabled;\n\n\treturn promise.then( () => completeHook.fire( ractive ) );\n}\n","import { ensureArray } from 'utils/array';\n\nvar adaptConfigurator = {\n\textend: ( Parent, proto, options ) => {\n\t\tproto.adapt = combine( proto.adapt, ensureArray( options.adapt ) );\n\t},\n\n\tinit () {}\n};\n\nexport default adaptConfigurator;\n\nfunction combine ( a, b ) {\n\tvar c = a.slice(), i = b.length;\n\n\twhile ( i-- ) {\n\t\tif ( !~c.indexOf( b[i] ) ) {\n\t\t\tc.push( b[i] );\n\t\t}\n\t}\n\n\treturn c;\n}","var selectorsPattern = /(?:^|\\})?\\s*([^\\{\\}]+)\\s*\\{/g,\n\tcommentsPattern = /\\/\\*.*?\\*\\//g,\n\tselectorUnitPattern = /((?:(?:\\[[^\\]+]\\])|(?:[^\\s\\+\\>\\~:]))+)((?::[^\\s\\+\\>\\~\\(]+(?:\\([^\\)]+\\))?)?\\s*[\\s\\+\\>\\~]?)\\s*/g,\n\tmediaQueryPattern = /^@media/,\n\tdataRvcGuidPattern = /\\[data-ractive-css~=\"\\{[a-z0-9-]+\\}\"]/g;\n\nexport default function transformCss( css, id ) {\n\tvar transformed, dataAttr, addGuid;\n\n\tdataAttr = `[data-ractive-css~=\"{${id}}\"]`;\n\n\taddGuid = function ( selector ) {\n\t\tvar selectorUnits, match, unit, base, prepended, appended, i, transformed = [];\n\n\t\tselectorUnits = [];\n\n\t\twhile ( match = selectorUnitPattern.exec( selector ) ) {\n\t\t\tselectorUnits.push({\n\t\t\t\tstr: match[0],\n\t\t\t\tbase: match[1],\n\t\t\t\tmodifiers: match[2]\n\t\t\t});\n\t\t}\n\n\t\t// For each simple selector within the selector, we need to create a version\n\t\t// that a) combines with the id, and b) is inside the id\n\t\tbase = selectorUnits.map( extractString );\n\n\t\ti = selectorUnits.length;\n\t\twhile ( i-- ) {\n\t\t\tappended = base.slice();\n\n\t\t\t// Pseudo-selectors should go after the attribute selector\n\t\t\tunit = selectorUnits[i];\n\t\t\tappended[i] = unit.base + dataAttr + unit.modifiers || '';\n\n\t\t\tprepended = base.slice();\n\t\t\tprepended[i] = dataAttr + ' ' + prepended[i];\n\n\t\t\ttransformed.push( appended.join( ' ' ), prepended.join( ' ' ) );\n\t\t}\n\n\t\treturn transformed.join( ', ' );\n\t};\n\n\tif ( dataRvcGuidPattern.test( css ) ) {\n\t\ttransformed = css.replace( dataRvcGuidPattern, dataAttr );\n\t} else {\n\t\ttransformed = css\n\t\t.replace( commentsPattern, '' )\n\t\t.replace( selectorsPattern, function ( match, $1 ) {\n\t\t\tvar selectors, transformed;\n\n\t\t\t// don't transform media queries!\n\t\t\tif ( mediaQueryPattern.test( $1 ) ) return match;\n\n\t\t\tselectors = $1.split( ',' ).map( trim );\n\t\t\ttransformed = selectors.map( addGuid ).join( ', ' ) + ' ';\n\n\t\t\treturn match.replace( $1, transformed );\n\t\t});\n\t}\n\n\treturn transformed;\n}\n\nfunction trim ( str ) {\n\tif ( str.trim ) {\n\t\treturn str.trim();\n\t}\n\n\treturn str.replace( /^\\s+/, '' ).replace( /\\s+$/, '' );\n}\n\nfunction extractString ( unit ) {\n\treturn unit.str;\n}\n","import css from 'global/css';\nimport transformCss from './transform';\n\nlet uid = 1;\n\nvar cssConfigurator = {\n\tname: 'css',\n\n\textend: ( Parent, proto, options ) => {\n\t\tif ( options.css ) {\n\t\t\tlet id = uid++;\n\t\t\tlet styles = options.noCssTransform ? options.css : transformCss( options.css, id );\n\n\t\t\tproto.cssId = id;\n\t\t\tcss.add({ id, styles });\n\t\t}\n\t},\n\n\tinit: () => {}\n};\n\nexport default cssConfigurator;\n","import { fatal, warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { isObject, isArray } from 'utils/is';\n\nfunction validate ( data ) {\n\t// Warn if userOptions.data is a non-POJO\n\tif ( data && data.constructor !== Object ) {\n\t\tif ( typeof data === 'function' ) {\n\t\t\t// TODO do we need to support this in the new Ractive() case?\n\t\t} else if ( typeof data !== 'object' ) {\n\t\t\tfatal( `data option must be an object or a function, \\`${data}\\` is not valid` );\n\t\t} else {\n\t\t\twarnIfDebug( 'If supplied, options.data should be a plain JavaScript object - using a non-POJO as the root object may work, but is discouraged' );\n\t\t}\n\t}\n}\n\nvar dataConfigurator = {\n\tname: 'data',\n\n\textend: ( Parent, proto, options ) => {\n\t\tlet key, value;\n\n\t\t// check for non-primitives, which could cause mutation-related bugs\n\t\tif ( options.data && isObject( options.data ) ) {\n\t\t\tfor ( key in options.data ) {\n\t\t\t\tvalue = options.data[ key ];\n\n\t\t\t\tif ( value && typeof value === 'object' ) {\n\t\t\t\t\tif ( isObject( value ) || isArray( value ) ) {\n\t\t\t\t\t\twarnIfDebug( `Passing a \\`data\\` option with object and array properties to Ractive.extend() is discouraged, as mutating them is likely to cause bugs. Consider using a data function instead:\n\n  // this...\n  data: function () {\n    return {\n      myObject: {}\n    };\n  })\n\n  // instead of this:\n  data: {\n    myObject: {}\n  }` );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tproto.data = combine( proto.data, options.data );\n\t},\n\n\tinit: ( Parent, ractive, options ) => {\n\t\tvar result = combine( Parent.prototype.data, options.data );\n\n\t\tif ( typeof result === 'function' ) {\n\t\t\tresult = result.call( ractive );\n\t\t}\n\n\t\treturn result || {};\n\t},\n\n\treset: function ( ractive ) {\n\t\tvar result = this.init( ractive.constructor, ractive, ractive.viewmodel );\n\t\tractive.viewmodel.root.set( result );\n\t\treturn true;\n\t}\n};\n\nexport default dataConfigurator;\n\nfunction combine ( parentValue, childValue ) {\n\tvalidate( childValue );\n\n\tlet parentIsFn = typeof parentValue === 'function';\n\tlet childIsFn = typeof childValue === 'function';\n\n\t// Very important, otherwise child instance can become\n\t// the default data object on Ractive or a component.\n\t// then ractive.set() ends up setting on the prototype!\n\tif ( !childValue && !parentIsFn ) {\n\t\tchildValue = {};\n\t}\n\n\t// Fast path, where we just need to copy properties from\n\t// parent to child\n\tif ( !parentIsFn && !childIsFn ) {\n\t\treturn fromProperties( childValue, parentValue );\n\t}\n\n\treturn function () {\n\t\tlet child = childIsFn ? callDataFunction( childValue, this ) : childValue;\n\t\tlet parent = parentIsFn ? callDataFunction( parentValue, this ) : parentValue;\n\n\t\treturn fromProperties( child, parent );\n\t};\n}\n\nfunction callDataFunction ( fn, context ) {\n\tlet data = fn.call( context );\n\n\tif ( !data ) return;\n\n\tif ( typeof data !== 'object' ) {\n\t\tfatal( 'Data function must return an object' );\n\t}\n\n\tif ( data.constructor !== Object ) {\n\t\twarnOnceIfDebug( 'Data function returned something other than a plain JavaScript object. This might work, but is strongly discouraged' );\n\t}\n\n\treturn data;\n}\n\nfunction fromProperties ( primary, secondary ) {\n\tif ( primary && secondary ) {\n\t\tfor ( let key in secondary ) {\n\t\t\tif ( !( key in primary ) ) {\n\t\t\t\tprimary[ key ] = secondary[ key ];\n\t\t\t}\n\t\t}\n\n\t\treturn primary;\n\t}\n\n\treturn primary || secondary;\n}\n","export default null;","import { doc } from 'config/environment';\nimport parse from 'parse/_parse';\nimport { create } from 'utils/object';\n\nvar parseOptions = [\n \t'preserveWhitespace',\n\t'sanitize',\n\t'stripComments',\n\t'delimiters',\n\t'tripleDelimiters',\n\t'interpolate'\n];\n\nvar parser = {\n\tfromId, isHashedId, isParsed, getParseOptions, createHelper,\n\tparse: doParse\n};\n\nfunction createHelper ( parseOptions ) {\n\tvar helper = create( parser );\n\thelper.parse = ( template, options ) => doParse( template, options || parseOptions );\n\treturn helper;\n}\n\nfunction doParse ( template, parseOptions ) {\n\tif ( !parse ) {\n\t\tthrow new Error( 'Missing Ractive.parse - cannot parse template. Either preparse or use the version that includes the parser' );\n\t}\n\n\treturn parse( template, parseOptions || this.options );\n}\n\nfunction fromId ( id, options ) {\n\tvar template;\n\n\tif ( !doc ) {\n\t\tif ( options && options.noThrow ) { return; }\n\t\tthrow new Error( `Cannot retrieve template #${id} as Ractive is not running in a browser.` );\n\t}\n\n\tif ( isHashedId( id ) ) {\n\t\tid = id.substring( 1 );\n\t}\n\n\tif ( !( template = doc.getElementById( id ) )) {\n\t\tif ( options && options.noThrow ) { return; }\n\t\tthrow new Error( `Could not find template element with id #${id}` );\n\t}\n\n\tif ( template.tagName.toUpperCase() !== 'SCRIPT' ) {\n\t\tif ( options && options.noThrow ) { return; }\n\t\tthrow new Error( `Template element with id #${id}, must be a <script> element` );\n\t}\n\n\treturn ( 'textContent' in template ? template.textContent : template.innerHTML );\n}\n\nfunction isHashedId ( id ) {\n\treturn ( id && id[0] === '#' );\n}\n\nfunction isParsed ( template) {\n\treturn !( typeof template === 'string' );\n}\n\nfunction getParseOptions ( ractive ) {\n\t// Could be Ractive or a Component\n\tif ( ractive.defaults ) { ractive = ractive.defaults; }\n\n\treturn parseOptions.reduce( ( val, key ) => {\n\t\tval[ key ] = ractive[ key ];\n\t\treturn val;\n\t}, {});\n}\n\nexport default parser;\n","import { TEMPLATE_VERSION } from 'config/template';\nimport { create } from 'utils/object';\nimport parser from './parser';\nimport parse from 'parse/_parse';\n\nvar templateConfigurator = {\n\tname: 'template',\n\n\textend: function extend ( Parent, proto, options ) {\n\t\tvar template;\n\n\t\t// only assign if exists\n\t\tif ( 'template' in options ) {\n\t\t\ttemplate = options.template;\n\n\t\t\tif ( typeof template === 'function' ) {\n\t\t\t\tproto.template = template;\n\t\t\t} else {\n\t\t\t\tproto.template = parseIfString( template, proto );\n\t\t\t}\n\t\t}\n\t},\n\n\tinit: function init ( Parent, ractive, options ) {\n\t\tvar template, fn;\n\n\t\t// TODO because of prototypal inheritance, we might just be able to use\n\t\t// ractive.template, and not bother passing through the Parent object.\n\t\t// At present that breaks the test mocks' expectations\n\t\ttemplate = 'template' in options ? options.template : Parent.prototype.template;\n\n\t\tif ( typeof template === 'function' ) {\n\t\t\tfn = template;\n\t\t\ttemplate = getDynamicTemplate( ractive, fn );\n\n\t\t\tractive._config.template = {\n\t\t\t\tfn: fn,\n\t\t\t\tresult: template\n\t\t\t};\n\t\t}\n\n\t\ttemplate = parseIfString( template, ractive );\n\n\t\t// TODO the naming of this is confusing - ractive.template refers to [...],\n\t\t// but Component.prototype.template refers to {v:1,t:[],p:[]}...\n\t\t// it's unnecessary, because the developer never needs to access\n\t\t// ractive.template\n\t\tractive.template = template.t;\n\n\t\tif ( template.p ) {\n\t\t\textendPartials( ractive.partials, template.p );\n\t\t}\n\t},\n\n\treset: function ( ractive ) {\n\t\tvar result = resetValue( ractive ), parsed;\n\n\t\tif ( result ) {\n\t\t\tparsed = parseIfString( result, ractive );\n\n\t\t\tractive.template = parsed.t;\n\t\t\textendPartials( ractive.partials, parsed.p, true );\n\n\t\t\treturn true;\n\t\t}\n\t}\n};\n\nfunction resetValue ( ractive ) {\n\tvar initial = ractive._config.template, result;\n\n\t// If this isn't a dynamic template, there's nothing to do\n\tif ( !initial || !initial.fn ) {\n\t\treturn;\n\t}\n\n\tresult = getDynamicTemplate( ractive, initial.fn );\n\n\t// TODO deep equality check to prevent unnecessary re-rendering\n\t// in the case of already-parsed templates\n\tif ( result !== initial.result ) {\n\t\tinitial.result = result;\n\t\tresult = parseIfString( result, ractive );\n\t\treturn result;\n\t}\n}\n\nfunction getDynamicTemplate ( ractive, fn ) {\n\tvar helper = createHelper( parser.getParseOptions( ractive ) );\n\treturn fn.call( ractive, helper );\n}\n\nfunction createHelper ( parseOptions ) {\n\tvar helper = create( parser );\n\thelper.parse = function ( template, options ){\n\t\treturn parser.parse( template, options || parseOptions );\n\t};\n\treturn helper;\n}\n\nfunction parseIfString ( template, ractive ) {\n\tif ( typeof template === 'string' ) {\n\t\t// ID of an element containing the template?\n\t\tif ( template[0] === '#' ) {\n\t\t\ttemplate = parser.fromId( template );\n\t\t}\n\n\t\ttemplate = parse( template, parser.getParseOptions( ractive ) );\n\t}\n\n\t// Check that the template even exists\n\telse if ( template == undefined ) {\n\t\tthrow new Error( `The template cannot be ${template}.` );\n\t}\n\n\t// Check the parsed template has a version at all\n\telse if ( typeof template.v !== 'number' ) {\n\t\tthrow new Error( 'The template parser was passed a non-string template, but the template doesn\\'t have a version.  Make sure you\\'re passing in the template you think you are.' );\n\t}\n\n\t// Check we're using the correct version\n\telse if ( template.v !== TEMPLATE_VERSION ) {\n\t\tthrow new Error( `Mismatched template version (expected ${TEMPLATE_VERSION}, got ${template.v}) Please ensure you are using the latest version of Ractive.js in your build process as well as in your app` );\n\t}\n\n\treturn template;\n}\n\nfunction extendPartials ( existingPartials, newPartials, overwrite ) {\n\tif ( !newPartials ) return;\n\n\t// TODO there's an ambiguity here - we need to overwrite in the `reset()`\n\t// case, but not initially...\n\n\tfor ( let key in newPartials ) {\n\t\tif ( overwrite || !existingPartials.hasOwnProperty( key ) ) {\n\t\t\texistingPartials[ key ] = newPartials[ key ];\n\t\t}\n\t}\n}\n\nexport default templateConfigurator;\n","import { warnIfDebug } from 'utils/log';\nimport adaptConfigurator from './custom/adapt';\nimport cssConfigurator from './custom/css/css';\nimport dataConfigurator from './custom/data';\nimport templateConfigurator from './custom/template/template';\nimport defaults from './defaults';\nimport registries from './registries';\nimport wrapPrototype from './wrapPrototypeMethod';\nimport deprecate from './deprecate';\n\nvar config, order, defaultKeys, custom, isBlacklisted, isStandardKey;\n\ncustom = {\n\tadapt: adaptConfigurator,\n\tcss: cssConfigurator,\n\tdata: dataConfigurator,\n\ttemplate: templateConfigurator\n};\n\ndefaultKeys = Object.keys( defaults );\n\nisStandardKey = makeObj( defaultKeys.filter( key => !custom[ key ] ) );\n\n// blacklisted keys that we don't double extend\nisBlacklisted = makeObj( defaultKeys.concat( registries.map( r => r.name ) ) );\n\norder = [].concat(\n\tdefaultKeys.filter( key => !registries[ key ] && !custom[ key ] ),\n\tregistries,\n\t//custom.data,\n\tcustom.template,\n\tcustom.css\n);\n\nconfig = {\n\textend: ( Parent, proto, options ) => configure( 'extend', Parent, proto, options ),\n\n\tinit: ( Parent, ractive, options ) => configure( 'init', Parent, ractive, options ),\n\n\treset: ractive => {\n\t\treturn order.filter( c => {\n\t\t\treturn c.reset && c.reset( ractive );\n\t\t}).map( c => c.name );\n\t},\n\n\t// this defines the order. TODO this isn't used anywhere in the codebase,\n\t// only in the test suite - should get rid of it\n\torder\n};\n\nfunction configure ( method, Parent, target, options ) {\n\tdeprecate( options );\n\n\tfor ( let key in options ) {\n\t\tif ( isStandardKey.hasOwnProperty( key ) ) {\n\t\t\tlet value = options[ key ];\n\n\t\t\t// warn the developer if they passed a function and ignore its value\n\n\t\t\t// NOTE: we allow some functions on \"el\" because we duck type element lists\n\t\t\t// and some libraries or ef'ed-up virtual browsers (phantomJS) return a\n\t\t\t// function object as the result of querySelector methods\n\t\t\tif ( key !== 'el' && typeof value === 'function' ) {\n\t\t\t\twarnIfDebug( `${ key } is a Ractive option that does not expect a function and will be ignored`,\n\t\t\t\t\tmethod === 'init' ? target : null );\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttarget[ key ] = value;\n\t\t\t}\n\t\t}\n\t}\n\n\tregistries.forEach( registry => {\n\t\tregistry[ method ]( Parent, target, options );\n\t});\n\n\tadaptConfigurator[ method ]( Parent, target, options );\n\ttemplateConfigurator[ method ]( Parent, target, options );\n\tcssConfigurator[ method ]( Parent, target, options );\n\n\textendOtherMethods( Parent.prototype, target, options );\n}\n\nfunction extendOtherMethods ( parent, target, options ) {\n\tfor ( let key in options ) {\n\t\tif ( !isBlacklisted[ key ] && options.hasOwnProperty( key ) ) {\n\t\t\tlet member = options[ key ];\n\n\t\t\t// if this is a method that overwrites a method, wrap it:\n\t\t\tif ( typeof member === 'function' ) {\n\t\t\t\tmember = wrapPrototype( parent, key, member );\n\t\t\t}\n\n\t\t\ttarget[ key ] = member;\n\t\t}\n\t}\n}\n\nfunction makeObj ( array ) {\n\tvar obj = {};\n\tarray.forEach( x => obj[x] = true );\n\treturn obj;\n}\n\nexport default config;\n","import config from 'Ractive/config/config';\nimport Hook from 'events/Hook';\nimport runloop from 'global/runloop';\nimport dataConfigurator from 'Ractive/config/custom/data';\n\nconst shouldRerender = [ 'template', 'partials', 'components', 'decorators', 'events' ];\n\nconst completeHook = new Hook( 'complete' );\nconst resetHook = new Hook( 'reset' );\nconst renderHook = new Hook( 'render' );\nconst unrenderHook = new Hook( 'unrender' );\n\nexport default function Ractive$reset ( data ) {\n\tdata = data || {};\n\n\tif ( typeof data !== 'object' ) {\n\t\tthrow new Error( 'The reset method takes either no arguments, or an object containing new data' );\n\t}\n\n\t// TEMP need to tidy this up\n\tdata = dataConfigurator.init( this.constructor, this, { data });\n\n\tlet promise = runloop.start( this, true );\n\n\t// If the root object is wrapped, try and use the wrapper's reset value\n\tconst wrapper = this.viewmodel.wrapper;\n\tif ( wrapper && wrapper.reset ) {\n\t\tif ( wrapper.reset( data ) === false ) {\n\t\t\t// reset was rejected, we need to replace the object\n\t\t\tthis.viewmodel.set( data );\n\t\t}\n\t} else {\n\t\tthis.viewmodel.set( data );\n\t}\n\n\t// reset config items and track if need to rerender\n\tconst changes = config.reset( this );\n\tlet rerender;\n\n\tlet i = changes.length;\n\twhile ( i-- ) {\n\t\tif ( shouldRerender.indexOf( changes[i] ) > -1 ) {\n\t\t\trerender = true;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif ( rerender ) {\n\t\tunrenderHook.fire( this );\n\t\tthis.fragment.resetTemplate( this.template );\n\t\trenderHook.fire( this );\n\t\tcompleteHook.fire( this );\n\t}\n\n\trunloop.end();\n\n\tresetHook.fire( this, data );\n\n\treturn promise;\n}\n","export var TEXT              = 1;\nexport var INTERPOLATOR      = 2;\nexport var TRIPLE            = 3;\nexport var SECTION           = 4;\nexport var INVERTED          = 5;\nexport var CLOSING           = 6;\nexport var ELEMENT           = 7;\nexport var PARTIAL           = 8;\nexport var COMMENT           = 9;\nexport var DELIMCHANGE       = 10;\nexport var ATTRIBUTE         = 13;\nexport var CLOSING_TAG       = 14;\nexport var COMPONENT         = 15;\nexport var YIELDER           = 16;\nexport var INLINE_PARTIAL    = 17;\nexport var DOCTYPE           = 18;\n\nexport var NUMBER_LITERAL    = 20;\nexport var STRING_LITERAL    = 21;\nexport var ARRAY_LITERAL     = 22;\nexport var OBJECT_LITERAL    = 23;\nexport var BOOLEAN_LITERAL   = 24;\nexport var REGEXP_LITERAL    = 25;\n\nexport var GLOBAL            = 26;\nexport var KEY_VALUE_PAIR    = 27;\n\n\nexport var REFERENCE         = 30;\nexport var REFINEMENT        = 31;\nexport var MEMBER            = 32;\nexport var PREFIX_OPERATOR   = 33;\nexport var BRACKETED         = 34;\nexport var CONDITIONAL       = 35;\nexport var INFIX_OPERATOR    = 36;\n\nexport var INVOCATION        = 40;\n\nexport var SECTION_IF        = 50;\nexport var SECTION_UNLESS    = 51;\nexport var SECTION_EACH      = 52;\nexport var SECTION_WITH      = 53;\nexport var SECTION_IF_WITH   = 54;\n\nexport var ELSE              = 60;\nexport var ELSEIF            = 61;\n","import { isArray } from 'utils/is';\nimport runloop from 'global/runloop';\nimport { PARTIAL, COMPONENT, ELEMENT } from 'config/types';\n\nfunction collect( source, name, dest ) {\n\tsource.forEach( item => {\n\t\t// queue to rerender if the item is a partial and the current name matches\n\t\tif ( item.type === PARTIAL && item.name === name ) {\n\t\t\tdest.push( item );\n\t\t\treturn; // go no further\n\t\t}\n\n\t\t// if it has a fragment, process its items\n\t\tif ( item.fragment ) {\n\t\t\tcollect( item.fragment.iterations || item.fragment.items, name, dest );\n\t\t}\n\n\t\t// or if it is itself a fragment, process its items\n\t\telse if ( isArray( item.items ) ) {\n\t\t\tcollect( item.items, name, dest );\n\t\t}\n\n\t\t// or if it is a component, step in and process its items\n\t\telse if ( item.type === COMPONENT && item.instance ) {\n\t\t\t// ...unless the partial is shadowed\n\t\t\tif ( item.instance.partials[ name ] ) return;\n\t\t\tcollect( item.instance.fragment.items, name, dest );\n\t\t}\n\n\t\t// if the item is an element, process its attributes too\n\t\tif ( item.type === ELEMENT ) {\n\t\t\tif ( isArray( item.attributes ) ) {\n\t\t\t\tcollect( item.attributes, name, dest );\n\t\t\t}\n\n\t\t\tif ( isArray( item.conditionalAttributes ) ) {\n\t\t\t\tcollect( item.conditionalAttributes, name, dest );\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction forceResetTemplate ( partial ) {\n\tpartial.forceResetTemplate();\n}\n\nexport default function ( name, partial ) {\n\tlet collection = [];\n\tcollect( this.fragment.items, name, collection );\n\n\tconst promise = runloop.start( this, true );\n\n\tthis.partials[ name ] = partial;\n\tcollection.forEach( forceResetTemplate );\n\n\trunloop.end();\n\n\treturn promise;\n}\n","export default class Item {\n\tconstructor ( options ) {\n\t\tthis.parentFragment = options.parentFragment;\n\t\tthis.ractive = options.parentFragment.ractive;\n\n\t\tthis.template = options.template;\n\t\tthis.index = options.index;\n\t\tthis.type = options.template.t;\n\n\t\tthis.dirty = false;\n\t}\n\n\tbubble () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.dirty = true;\n\t\t\tthis.parentFragment.bubble();\n\t\t}\n\t}\n\n\tfind () {\n\t\treturn null;\n\t}\n\n\tfindAll () {\n\t\t// noop\n\t}\n\n\tfindComponent () {\n\t\treturn null;\n\t}\n\n\tfindAllComponents () {\n\t\t// noop;\n\t}\n\n\tfindNextNode () {\n\t\treturn this.parentFragment.findNextNode( this );\n\t}\n}\n","export default function ( wrapper, array, methodName, newIndices ) {\n\tvar { __model } = wrapper;\n\n\tif ( !!newIndices ) {\n\t\t__model.shuffle( newIndices );\n\t} else {\n\t\t// If this is a sort or reverse, we just do root.set()...\n\t\t// TODO use merge logic?\n\t\t//root.viewmodel.mark( keypath );\n\t}\n}\n","import runloop from 'global/runloop';\nimport { defineProperty } from 'utils/object';\nimport getNewIndices from 'shared/getNewIndices';\nimport processWrapper from './processWrapper';\n\nconst mutatorMethods = [ 'pop', 'push', 'reverse', 'shift', 'sort', 'splice', 'unshift' ];\nlet patchedArrayProto = [];\n\nmutatorMethods.forEach( function ( methodName ) {\n\tconst method = function ( ...args ) {\n\t\tconst newIndices = getNewIndices( this.length, methodName, args );\n\n\t\t// apply the underlying method\n\t\tconst result = Array.prototype[ methodName ].apply( this, arguments );\n\n\t\t// trigger changes\n\t\trunloop.start();\n\n\t\tthis._ractive.setting = true;\n\t\tlet i = this._ractive.wrappers.length;\n\t\twhile ( i-- ) {\n\t\t\tprocessWrapper( this._ractive.wrappers[i], this, methodName, newIndices );\n\t\t}\n\n\t\trunloop.end();\n\n\t\tthis._ractive.setting = false;\n\t\treturn result;\n\t};\n\n\tdefineProperty( patchedArrayProto, methodName, {\n\t\tvalue: method\n\t});\n});\n\nlet patchArrayMethods;\nlet unpatchArrayMethods;\n\n// can we use prototype chain injection?\n// http://perfectionkills.com/how-ecmascript-5-still-does-not-allow-to-subclass-an-array/#wrappers_prototype_chain_injection\nif ( ({}).__proto__ ) {\n\t// yes, we can\n\tpatchArrayMethods = array => array.__proto__ = patchedArrayProto;\n\tunpatchArrayMethods = array => array.__proto__ = Array.prototype;\n}\n\nelse {\n\t// no, we can't\n\tpatchArrayMethods = array => {\n\t\tlet i = mutatorMethods.length;\n\t\twhile ( i-- ) {\n\t\t\tconst methodName = mutatorMethods[i];\n\t\t\tdefineProperty( array, methodName, {\n\t\t\t\tvalue: patchedArrayProto[ methodName ],\n\t\t\t\tconfigurable: true\n\t\t\t});\n\t\t}\n\t};\n\n\tunpatchArrayMethods = array => {\n\t\tlet i = mutatorMethods.length;\n\t\twhile ( i-- ) {\n\t\t\tdelete array[ mutatorMethods[i] ];\n\t\t}\n\t};\n}\n\npatchArrayMethods.unpatch = unpatchArrayMethods; // TODO export separately?\nexport default patchArrayMethods;\n","import { defineProperty } from 'utils/object';\nimport { isArray } from 'utils/is';\nimport patch from './patch';\n\nconst errorMessage = 'Something went wrong in a rather interesting way';\n\nexport default {\n\tfilter ( object ) {\n\t\t// wrap the array if a) b) it's an array, and b) either it hasn't been wrapped already,\n\t\t// or the array didn't trigger the get() itself\n\t\treturn isArray( object ) && ( !object._ractive || !object._ractive.setting );\n\t},\n\twrap ( ractive, array, keypath ) {\n\t\treturn new ArrayWrapper( ractive, array, keypath );\n\t}\n};\n\nclass ArrayWrapper {\n\tconstructor ( ractive, array ) {\n\t\tthis.root = ractive;\n\t\tthis.value = array;\n\t\tthis.__model = null; // filled in later\n\n\t\t// if this array hasn't already been ractified, ractify it\n\t\tif ( !array._ractive ) {\n\t\t\t// define a non-enumerable _ractive property to store the wrappers\n\t\t\tdefineProperty( array, '_ractive', {\n\t\t\t\tvalue: {\n\t\t\t\t\twrappers: [],\n\t\t\t\t\tinstances: [],\n\t\t\t\t\tsetting: false\n\t\t\t\t},\n\t\t\t\tconfigurable: true\n\t\t\t});\n\n\t\t\tpatch( array );\n\t\t}\n\n\t\t// store the ractive instance, so we can handle transitions later\n\t\tif ( !array._ractive.instances[ ractive._guid ] ) {\n\t\t\tarray._ractive.instances[ ractive._guid ] = 0;\n\t\t\tarray._ractive.instances.push( ractive );\n\t\t}\n\n\t\tarray._ractive.instances[ ractive._guid ] += 1;\n\t\tarray._ractive.wrappers.push( this );\n\t}\n\n\tget () {\n\t\treturn this.value;\n\t}\n\n\tteardown () {\n\t\tvar array, storage, wrappers, instances, index;\n\n\t\tarray = this.value;\n\t\tstorage = array._ractive;\n\t\twrappers = storage.wrappers;\n\t\tinstances = storage.instances;\n\n\t\t// if teardown() was invoked because we're clearing the cache as a result of\n\t\t// a change that the array itself triggered, we can save ourselves the teardown\n\t\t// and immediate setup\n\t\tif ( storage.setting ) {\n\t\t\treturn false; // so that we don't remove it from cached wrappers\n\t\t}\n\n\t\tindex = wrappers.indexOf( this );\n\t\tif ( index === -1 ) {\n\t\t\tthrow new Error( errorMessage );\n\t\t}\n\n\t\twrappers.splice( index, 1 );\n\n\t\t// if nothing else depends on this array, we can revert it to its\n\t\t// natural state\n\t\tif ( !wrappers.length ) {\n\t\t\tdelete array._ractive;\n\t\t\tpatch.unpatch( this.value );\n\t\t}\n\n\t\telse {\n\t\t\t// remove ractive instance if possible\n\t\t\tinstances[ this.root._guid ] -= 1;\n\t\t\tif ( !instances[ this.root._guid ] ) {\n\t\t\t\tindex = instances.indexOf( this.root );\n\n\t\t\t\tif ( index === -1 ) {\n\t\t\t\t\tthrow new Error( errorMessage );\n\t\t\t\t}\n\n\t\t\t\tinstances.splice( index, 1 );\n\t\t\t}\n\t\t}\n\t}\n}\n","let magicAdaptor;\n\ntry {\n\tObject.defineProperty({}, 'test', { value: 0 });\n\n\tmagicAdaptor = {\n\t\tfilter ( value ) {\n\t\t\treturn value && typeof value === 'object';\n\t\t},\n\t\twrap ( ractive, value, keypath ) {\n\t\t\treturn new MagicWrapper( ractive, value, keypath );\n\t\t}\n\t};\n} catch ( err ) {\n\tmagicAdaptor = false;\n}\n\nexport default magicAdaptor;\n\nfunction createOrWrapDescriptor ( originalDescriptor, ractive, keypath ) {\n\tif ( originalDescriptor.set && originalDescriptor.set.__magic ) {\n\t\toriginalDescriptor.set.__magic.dependants.push({ ractive, keypath });\n\t\treturn originalDescriptor;\n\t}\n\n\tlet setting;\n\n\tlet dependants = [{ ractive, keypath }];\n\n\tconst descriptor = {\n\t\tget: () => {\n\t\t\treturn 'value' in originalDescriptor ? originalDescriptor.value : originalDescriptor.get();\n\t\t},\n\t\tset: value => {\n\t\t\tif ( setting ) return;\n\n\t\t\tif ( 'value' in originalDescriptor ) {\n\t\t\t\toriginalDescriptor.value = value;\n\t\t\t} else {\n\t\t\t\toriginalDescriptor.set( value );\n\t\t\t}\n\n\t\t\tsetting = true;\n\t\t\tdependants.forEach( ({ ractive, keypath }) => {\n\t\t\t\tractive.set( keypath, value );\n\t\t\t});\n\t\t\tsetting = false;\n\t\t},\n\t\tenumerable: true\n\t};\n\n\tdescriptor.set.__magic = { dependants, originalDescriptor };\n\n\treturn descriptor;\n}\n\nfunction revert ( descriptor, ractive, keypath ) {\n\tif ( !descriptor.set || !descriptor.set.__magic ) return true;\n\n\tlet dependants = descriptor.set.__magic;\n\tlet i = dependants.length;\n\twhile ( i-- ) {\n\t\tconst dependant = dependants[i];\n\t\tif ( dependant.ractive === ractive && dependant.keypath === keypath ) {\n\t\t\tdependants.splice( i, 1 );\n\t\t\treturn false;\n\t\t}\n\t}\n}\n\nclass MagicWrapper {\n\tconstructor ( ractive, value, keypath ) {\n\t\tthis.ractive = ractive;\n\t\tthis.value = value;\n\t\tthis.keypath = keypath;\n\n\t\tthis.originalDescriptors = {};\n\n\t\t// wrap all properties with getters\n\t\tObject.keys( value ).forEach( key => {\n\t\t\tconst originalDescriptor = Object.getOwnPropertyDescriptor( this.value, key );\n\t\t\tthis.originalDescriptors[ key ] = originalDescriptor;\n\n\t\t\tconst childKeypath = keypath ? `${keypath}.${key}` : key;\n\n\t\t\tconst descriptor = createOrWrapDescriptor( originalDescriptor, ractive, childKeypath );\n\n\n\n\t\t\tObject.defineProperty( this.value, key, descriptor );\n\t\t});\n\t}\n\n\tget () {\n\t\treturn this.value;\n\t}\n\n\treset () {\n\t\tthrow new Error( 'TODO magic adaptor reset' ); // does this ever happen?\n\t}\n\n\tset ( key, value ) {\n\t\tthis.value[ key ] = value;\n\t}\n\n\tteardown () {\n\t\tObject.keys( this.value ).forEach( key => {\n\t\t\tconst descriptor = Object.getOwnPropertyDescriptor( this.value, key );\n\t\t\tif ( !descriptor.set || !descriptor.set.__magic ) return;\n\n\t\t\trevert( descriptor );\n\n\t\t\tif ( descriptor.set.__magic.dependants.length === 1 ) {\n\t\t\t\tObject.defineProperty( this.value, key, descriptor.set.__magic.originalDescriptor );\n\t\t\t}\n\t\t});\n\t}\n}\n","import magicAdaptor from './magic';\nimport arrayAdaptor from './array/index';\n\nvar magicArrayAdaptor, MagicArrayWrapper;\n\nif ( magicAdaptor ) {\n\tmagicArrayAdaptor = {\n\t\tfilter: function ( object, keypath, ractive ) {\n\t\t\treturn magicAdaptor.filter( object, keypath, ractive ) && arrayAdaptor.filter( object );\n\t\t},\n\n\t\twrap: function ( ractive, array, keypath ) {\n\t\t\treturn new MagicArrayWrapper( ractive, array, keypath );\n\t\t}\n\t};\n\n\tMagicArrayWrapper = function ( ractive, array, keypath ) {\n\t\tthis.value = array;\n\n\t\tthis.magic = true;\n\n\t\tthis.magicWrapper = magicAdaptor.wrap( ractive, array, keypath );\n\t\tthis.arrayWrapper = arrayAdaptor.wrap( ractive, array, keypath );\n\n\t\t// ugh, this really is a terrible hack\n\t\tObject.defineProperty( this, '__model', {\n\t\t\tget () {\n\t\t\t\treturn this.arrayWrapper.__model;\n\t\t\t},\n\t\t\tset ( model ) {\n\t\t\t\tthis.arrayWrapper.__model = model;\n\t\t\t}\n\t\t});\n\t};\n\n\tMagicArrayWrapper.prototype = {\n\t\tget: function () {\n\t\t\treturn this.value;\n\t\t},\n\t\tteardown: function () {\n\t\t\tthis.arrayWrapper.teardown();\n\t\t\tthis.magicWrapper.teardown();\n\t\t},\n\t\treset: function ( value ) {\n\t\t\treturn this.magicWrapper.reset( value );\n\t\t}\n\t};\n}\n\nexport default magicArrayAdaptor;\n","let stack = [];\nlet captureGroup;\n\nexport function startCapturing () {\n\tstack.push( captureGroup = [] );\n}\n\nexport function stopCapturing () {\n\treturn stack.pop();\n}\n\nexport function capture ( model ) {\n\tif ( captureGroup ) {\n\t\tcaptureGroup.push( model );\n\t}\n}\n","import { create, hasOwn } from 'utils/object';\n\nvar Parser, ParseError, leadingWhitespace = /^\\s+/;\n\nParseError = function ( message ) {\n\tthis.name = 'ParseError';\n\tthis.message = message;\n\ttry {\n\t\tthrow new Error(message);\n\t} catch (e) {\n\t\tthis.stack = e.stack;\n\t}\n};\n\nParseError.prototype = Error.prototype;\n\nParser = function ( str, options ) {\n\tvar items, item, lineStart = 0;\n\n\tthis.str = str;\n\tthis.options = options || {};\n\tthis.pos = 0;\n\n\tthis.lines = this.str.split( '\\n' );\n\tthis.lineEnds = this.lines.map( line => {\n\t\tvar lineEnd = lineStart + line.length + 1; // +1 for the newline\n\n\t\tlineStart = lineEnd;\n\t\treturn lineEnd;\n\t}, 0 );\n\n\t// Custom init logic\n\tif ( this.init ) this.init( str, options );\n\n\titems = [];\n\n\twhile ( ( this.pos < this.str.length ) && ( item = this.read() ) ) {\n\t\titems.push( item );\n\t}\n\n\tthis.leftover = this.remaining();\n\tthis.result = this.postProcess ? this.postProcess( items, options ) : items;\n};\n\nParser.prototype = {\n\tread: function ( converters ) {\n\t\tvar pos, i, len, item;\n\n\t\tif ( !converters ) converters = this.converters;\n\n\t\tpos = this.pos;\n\n\t\tlen = converters.length;\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tthis.pos = pos; // reset for each attempt\n\n\t\t\tif ( item = converters[i]( this ) ) {\n\t\t\t\treturn item;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t},\n\n\tgetLinePos: function ( char ) {\n\t\tvar lineNum = 0, lineStart = 0, columnNum;\n\n\t\twhile ( char >= this.lineEnds[ lineNum ] ) {\n\t\t\tlineStart = this.lineEnds[ lineNum ];\n\t\t\tlineNum += 1;\n\t\t}\n\n\t\tcolumnNum = char - lineStart;\n\t\treturn [ lineNum + 1, columnNum + 1, char ]; // line/col should be one-based, not zero-based!\n\t},\n\n\terror: function ( message ) {\n\t\tlet pos = this.getLinePos( this.pos );\n\t\tlet lineNum = pos[0];\n\t\tlet columnNum = pos[1];\n\n\t\tlet line = this.lines[ pos[0] - 1 ];\n\t\tlet numTabs = 0;\n\t\tlet annotation = line.replace( /\\t/g, ( match, char ) => {\n\t\t\tif ( char < pos[1] ) {\n\t\t\t\tnumTabs += 1;\n\t\t\t}\n\n\t\t\treturn '  ';\n\t\t}) + '\\n' + new Array( pos[1] + numTabs ).join( ' ' ) + '^----';\n\n\t\tlet error = new ParseError( `${message} at line ${lineNum} character ${columnNum}:\\n${annotation}` );\n\n\t\terror.line = pos[0];\n\t\terror.character = pos[1];\n\t\terror.shortMessage = message;\n\n\t\tthrow error;\n\t},\n\n\tmatchString: function ( string ) {\n\t\tif ( this.str.substr( this.pos, string.length ) === string ) {\n\t\t\tthis.pos += string.length;\n\t\t\treturn string;\n\t\t}\n\t},\n\n\tmatchPattern: function ( pattern ) {\n\t\tvar match;\n\n\t\tif ( match = pattern.exec( this.remaining() ) ) {\n\t\t\tthis.pos += match[0].length;\n\t\t\treturn match[1] || match[0];\n\t\t}\n\t},\n\n\tallowWhitespace: function () {\n\t\tthis.matchPattern( leadingWhitespace );\n\t},\n\n\tremaining: function () {\n\t\treturn this.str.substring( this.pos );\n\t},\n\n\tnextChar: function () {\n\t\treturn this.str.charAt( this.pos );\n\t}\n};\n\nParser.extend = function ( proto ) {\n\tvar Parent = this, Child, key;\n\n\tChild = function ( str, options ) {\n\t\tParser.call( this, str, options );\n\t};\n\n\tChild.prototype = create( Parent.prototype );\n\n\tfor ( key in proto ) {\n\t\tif ( hasOwn.call( proto, key ) ) {\n\t\t\tChild.prototype[ key ] = proto[ key ];\n\t\t}\n\t}\n\n\tChild.extend = Parser.extend;\n\treturn Child;\n};\n\nexport default Parser;\n","let prefixers = {};\n\n// TODO this is legacy. sooner we can replace the old adaptor API the better\nfunction prefixKeypath ( obj, prefix ) {\n\tvar prefixed = {}, key;\n\n\tif ( !prefix ) {\n\t\treturn obj;\n\t}\n\n\tprefix += '.';\n\n\tfor ( key in obj ) {\n\t\tif ( obj.hasOwnProperty( key ) ) {\n\t\t\tprefixed[ prefix + key ] = obj[ key ];\n\t\t}\n\t}\n\n\treturn prefixed;\n}\n\nexport default function getPrefixer ( rootKeypath ) {\n\tvar rootDot;\n\n\tif ( !prefixers[ rootKeypath ] ) {\n\t\trootDot = rootKeypath ? rootKeypath + '.' : '';\n\n\t\tprefixers[ rootKeypath ] = function ( relativeKeypath, value ) {\n\t\t\tvar obj;\n\n\t\t\tif ( typeof relativeKeypath === 'string' ) {\n\t\t\t\tobj = {};\n\t\t\t\tobj[ rootDot + relativeKeypath ] = value;\n\t\t\t\treturn obj;\n\t\t\t}\n\n\t\t\tif ( typeof relativeKeypath === 'object' ) {\n\t\t\t\t// 'relativeKeypath' is in fact a hash, not a keypath\n\t\t\t\treturn rootDot ? prefixKeypath( relativeKeypath, rootKeypath ) : relativeKeypath;\n\t\t\t}\n\t\t};\n\t}\n\n\treturn prefixers[ rootKeypath ];\n}\n","import { removeFromArray } from 'utils/array';\nimport { handleChange } from 'shared/methodCallers';\n\nexport default class KeyModel {\n\tconstructor ( key ) {\n\t\tthis.value = key;\n\t\tthis.isReadonly = true;\n\t\tthis.dependants = [];\n\t}\n\n\tget () {\n\t\treturn this.value;\n\t}\n\n\tgetKeypath () {\n\t\treturn this.value;\n\t}\n\n\trebind ( key ) {\n\t\tthis.value = key;\n\t\tthis.dependants.forEach( handleChange );\n\t}\n\n\tregister ( dependant ) {\n\t\tthis.dependants.push( dependant );\n\t}\n\n\tunregister ( dependant ) {\n\t\tremoveFromArray( this.dependants, dependant );\n\t}\n}\n","import { removeFromArray } from 'utils/array';\nimport { handleChange } from 'shared/methodCallers';\n\nexport default class KeypathModel {\n\tconstructor ( parent ) {\n\t\tthis.parent = parent;\n\t\tthis.value = parent.getKeypath();\n\t\tthis.dependants = [];\n\t}\n\n\tget () {\n\t\treturn this.value;\n\t}\n\n\thandleChange () {\n\t\tthis.value = this.parent.getKeypath();\n\t\tthis.dependants.forEach( handleChange );\n\t}\n\n\tregister ( dependant ) {\n\t\tthis.dependants.push( dependant );\n\t}\n\n\tunregister ( dependant ) {\n\t\tremoveFromArray( this.dependants, dependant );\n\t}\n}\n","import { capture } from 'global/capture';\nimport { isEqual, isNumeric } from 'utils/is';\nimport { removeFromArray } from 'utils/array';\nimport { handleChange, mark, teardown } from 'shared/methodCallers';\nimport getPrefixer from './helpers/getPrefixer';\nimport { isArray, isObject } from 'utils/is';\nimport KeyModel from './specials/KeyModel';\nimport KeypathModel from './specials/KeypathModel';\n\nconst hasProp = Object.prototype.hasOwnProperty;\n\nfunction updateFromBindings ( model ) {\n\tmodel.updateFromBindings( true );\n}\n\nfunction updateKeypathDependants ( model ) {\n\tmodel.updateKeypathDependants();\n}\n\nlet originatingModel = null;\n\nexport default class Model {\n\tconstructor ( parent, key ) {\n\t\tthis.deps = [];\n\n\t\tthis.children = [];\n\t\tthis.childByKey = {};\n\n\t\tthis.indexModels = [];\n\n\t\tthis.unresolved = [];\n\t\tthis.unresolvedByKey = {};\n\n\t\tthis.bindings = [];\n\n\t\tthis.value = undefined;\n\n\t\tif ( parent ) {\n\t\t\tthis.parent = parent;\n\t\t\tthis.root = parent.root;\n\t\t\tthis.key = key;\n\n\t\t\tif ( parent.value ) {\n\t\t\t\tthis.value = parent.value[ this.key ];\n\t\t\t\tthis.adapt();\n\t\t\t}\n\t\t}\n\t}\n\n\tadapt () {\n\t\tconst adaptors = this.root.adaptors;\n\t\tconst value = this.value;\n\t\tconst len = adaptors.length;\n\n\t\t// TODO remove this legacy nonsense\n\t\tconst ractive = this.root.ractive;\n\t\tconst keypath = this.getKeypath();\n\n\t\tlet i;\n\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tconst adaptor = adaptors[i];\n\t\t\tif ( adaptor.filter( value, keypath, ractive ) ) {\n\t\t\t\tthis.wrapper = adaptor.wrap( ractive, value, keypath, getPrefixer( keypath ) );\n\t\t\t\tthis.wrapper.value = this.value;\n\t\t\t\tthis.wrapper.__model = this; // massive temporary hack to enable array adaptor\n\n\t\t\t\tthis.value = this.wrapper.get();\n\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\taddUnresolved ( key, resolver ) {\n\t\tif ( !this.unresolvedByKey[ key ] ) {\n\t\t\tthis.unresolved.push( key );\n\t\t\tthis.unresolvedByKey[ key ] = [];\n\t\t}\n\n\t\tthis.unresolvedByKey[ key ].push( resolver );\n\t}\n\n\tclearUnresolveds ( specificKey ) {\n\t\tlet i = this.unresolved.length;\n\n\t\twhile ( i-- ) {\n\t\t\tconst key = this.unresolved[i];\n\n\t\t\tif ( specificKey && key !== specificKey ) continue;\n\n\t\t\tconst resolvers = this.unresolvedByKey[ key ];\n\t\t\tconst hasKey = this.has( key );\n\n\t\t\tlet j = resolvers.length;\n\t\t\twhile ( j-- ) {\n\t\t\t\tif ( hasKey ) resolvers[j].attemptResolution();\n\t\t\t\tif ( resolvers[j].resolved ) resolvers.splice( j, 1 );\n\t\t\t}\n\n\t\t\tif ( !resolvers.length ) {\n\t\t\t\tthis.unresolved.splice( i, 1 );\n\t\t\t\tthis.unresolvedByKey[ key ] = null;\n\t\t\t}\n\t\t}\n\t}\n\n\tcreateBranch ( key ) {\n\t\tconst branch = isNumeric( key ) ? [] : {};\n\t\tthis.set( branch );\n\n\t\treturn branch;\n\t}\n\n\tdiscard () {\n\t\tthis.deps.forEach( d => { if ( d.boundsSensitive ) this.unregister( d ); } );\n\t}\n\n\tfindMatches ( keys ) {\n\t\tconst len = keys.length;\n\n\t\tlet existingMatches = [ this ];\n\t\tlet matches;\n\t\tlet i;\n\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tconst key = keys[i];\n\n\t\t\tif ( key === '*' ) {\n\t\t\t\tmatches = [];\n\t\t\t\texistingMatches.forEach( model => {\n\t\t\t\t\tif ( isArray( model.value ) ) {\n\t\t\t\t\t\t// special case - array.length. This is a horrible kludge, but\n\t\t\t\t\t\t// it'll do for now. Alternatives welcome\n\t\t\t\t\t\tif ( originatingModel && originatingModel.parent === model && originatingModel.key === 'length' ) {\n\t\t\t\t\t\t\tmatches.push( originatingModel );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tmodel.value.forEach( ( member, i ) => {\n\t\t\t\t\t\t\tmatches.push( model.joinKey( i ) );\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\telse if ( isObject( model.value ) || typeof model.value === 'function' ) {\n\t\t\t\t\t\tObject.keys( model.value ).forEach( key => {\n\t\t\t\t\t\t\tmatches.push( model.joinKey( key ) );\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// special case - computed properties. TODO mappings also?\n\t\t\t\t\t\tif ( model.isRoot ) {\n\t\t\t\t\t\t\tObject.keys( model.computations ).forEach( key => {\n\t\t\t\t\t\t\t\tmatches.push( model.joinKey( key ) );\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tmatches = existingMatches.map( model => model.joinKey( key ) );\n\t\t\t}\n\n\t\t\texistingMatches = matches;\n\t\t}\n\n\t\treturn matches;\n\t}\n\n\tget ( shouldCapture ) {\n\t\tif ( shouldCapture ) capture( this );\n\t\treturn this.value;\n\t}\n\n\tgetIndexModel ( fragmentIndex ) {\n\t\tconst indexModels = this.parent.indexModels;\n\n\t\t// non-numeric keys are a special of a numeric index in a object iteration\n\t\tif ( typeof this.key === 'string' && fragmentIndex !== undefined ) {\n\t\t\treturn new KeyModel( fragmentIndex );\n\t\t} else if ( !indexModels[ this.key ] ) {\n\t\t\tindexModels[ this.key ] = new KeyModel( this.key );\n\t\t}\n\n\t\treturn indexModels[ this.key ];\n\t}\n\n\tgetKeyModel () {\n\t\t// TODO... different to IndexModel because key can never change\n\t\treturn new KeyModel( this.key );\n\t}\n\n\tgetKeypathModel () {\n\t\treturn this.keypathModel || ( this.keypathModel = new KeypathModel( this ) );\n\t}\n\n\tgetKeypath () {\n\t\t// TODO keypaths inside components... tricky\n\t\treturn this.parent.isRoot ? this.key : this.parent.getKeypath() + '.' + this.key;\n\t}\n\n\thas ( key ) {\n\t\treturn this.value && hasProp.call( this.value, key );\n\t}\n\n\tjoinKey ( key ) {\n\t\tif ( key === undefined || key === '' ) return this;\n\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\n\t\t\tconst child = new Model( this, key );\n\t\t\tthis.children.push( child );\n\t\t\tthis.childByKey[ key ] = child;\n\t\t}\n\n\t\treturn this.childByKey[ key ];\n\t}\n\n\tjoinAll ( keys ) {\n\t\tlet model = this;\n\t\tfor ( let i = 0; i < keys.length; i += 1 ) {\n\t\t\tmodel = model.joinKey( keys[i] );\n\t\t}\n\n\t\treturn model;\n\t}\n\n\tmark () {\n\t\tconst value = this.retrieve();\n\n\t\tif ( !isEqual( value, this.value ) ) {\n\t\t\tthis.value = value;\n\n\t\t\tthis.children.forEach( mark );\n\n\t\t\tthis.deps.forEach( handleChange );\n\t\t\tthis.clearUnresolveds();\n\t\t}\n\t}\n\n\tmerge ( array, comparator ) {\n\t\tconst oldArray = comparator ? this.value.map( comparator ) : this.value;\n\t\tconst newArray = comparator ? array.map( comparator ) : array;\n\n\t\tconst oldLength = oldArray.length;\n\n\t\tlet usedIndices = {};\n\t\tlet firstUnusedIndex = 0;\n\n\t\tconst newIndices = oldArray.map( item => {\n\t\t\tlet index;\n\t\t\tlet start = firstUnusedIndex;\n\n\t\t\tdo {\n\t\t\t\tindex = newArray.indexOf( item, start );\n\n\t\t\t\tif ( index === -1 ) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\n\t\t\t\tstart = index + 1;\n\t\t\t} while ( ( usedIndices[ index ] === true ) && start < oldLength );\n\n\t\t\t// keep track of the first unused index, so we don't search\n\t\t\t// the whole of newArray for each item in oldArray unnecessarily\n\t\t\tif ( index === firstUnusedIndex ) {\n\t\t\t\tfirstUnusedIndex += 1;\n\t\t\t}\n\t\t\t// allow next instance of next \"equal\" to be found item\n\t\t\tusedIndices[ index ] = true;\n\t\t\treturn index;\n\t\t});\n\n\t\tthis.parent.value[ this.key ] = array;\n\t\tthis._merged = true;\n\t\tthis.shuffle( newIndices );\n\t}\n\n\tregister ( dep ) {\n\t\tthis.deps.push( dep );\n\t}\n\n\tregisterTwowayBinding ( binding ) {\n\t\tthis.bindings.push( binding );\n\t}\n\n\tretrieve () {\n\t\treturn this.parent.value ? this.parent.value[ this.key ] : undefined;\n\t}\n\n\tset ( value ) {\n\t\tif ( isEqual( value, this.value ) ) return;\n\n\t\t// TODO deprecate this nonsense\n\t\tthis.root.changes[ this.getKeypath() ] = value;\n\n\t\tif ( this.parent.wrapper && this.parent.wrapper.set ) {\n\t\t\tthis.parent.wrapper.set( this.key, value );\n\t\t\tthis.parent.value = this.parent.wrapper.get();\n\n\t\t\tthis.value = this.parent.value[ this.key ];\n\t\t\t// TODO should this value be adapted? probably\n\t\t} else if ( this.wrapper ) {\n\t\t\tconst shouldTeardown = !this.wrapper.reset || this.wrapper.reset( value ) === false;\n\n\t\t\tif ( shouldTeardown ) {\n\t\t\t\tthis.wrapper.teardown();\n\t\t\t\tthis.wrapper = null;\n\t\t\t\tthis.parent.value[ this.key ] = this.value = value;\n\t\t\t\tthis.adapt();\n\t\t\t} else {\n\t\t\t\tthis.value = this.wrapper.get();\n\t\t\t}\n\t\t} else {\n\t\t\tconst parentValue = this.parent.value || this.parent.createBranch( this.key );\n\t\t\tparentValue[ this.key ] = value;\n\n\t\t\tthis.value = value;\n\t\t\tthis.adapt();\n\t\t}\n\n\t\tthis.parent.clearUnresolveds();\n\t\tthis.clearUnresolveds();\n\n\t\t// notify dependants\n\t\tconst previousOriginatingModel = originatingModel; // for the array.length special case\n\t\toriginatingModel = this;\n\n\t\tthis.children.forEach( mark );\n\t\tthis.deps.forEach( handleChange );\n\n\t\tlet parent = this.parent;\n\t\twhile ( parent ) {\n\t\t\tparent.deps.forEach( handleChange );\n\t\t\tparent = parent.parent;\n\t\t}\n\n\t\toriginatingModel = previousOriginatingModel;\n\t}\n\n\tshuffle ( newIndices ) {\n\t\tconst indexModels = [];\n\t\tlet max = 0, child;\n\n\t\tnewIndices.forEach( ( newIndex, oldIndex ) => {\n\t\t\tif ( newIndex > max ) max = newIndex;\n\n\t\t\tif ( !~newIndex ) return;\n\n\t\t\tconst model = this.indexModels[ oldIndex ];\n\n\t\t\tif ( !model ) return;\n\n\t\t\tindexModels[ newIndex ] = model;\n\n\t\t\tif ( newIndex !== oldIndex ) {\n\t\t\t\tmodel.rebind( newIndex );\n\t\t\t}\n\t\t});\n\n\t\t// some children, notably computations, need to be notified when they are\n\t\t// no longer attached to anything so they don't recompute\n\t\twhile ( ( child = this.childByKey[ ++max ] ) ) {\n\t\t\tif ( typeof child.discard === 'function' ) child.discard();\n\t\t}\n\n\t\tthis.indexModels = indexModels;\n\n\n\t\t// shuffles need to happen before marks...\n\t\tthis.deps.forEach( dep => {\n\t\t\tif ( dep.shuffle ) dep.shuffle( newIndices );\n\t\t});\n\n\t\tthis.updateKeypathDependants();\n\t\tthis.mark();\n\n\t\t// ...but handleChange must happen after (TODO document why)\n\t\tthis.deps.forEach( dep => {\n\t\t\tif ( !dep.shuffle ) dep.handleChange();\n\t\t});\n\t}\n\n\tteardown () {\n\t\tthis.children.forEach( teardown );\n\t\tif ( this.wrapper ) this.wrapper.teardown();\n\t}\n\n\tunregister ( dependant ) {\n\t\tremoveFromArray( this.deps, dependant );\n\t}\n\n\tunregisterTwowayBinding ( binding ) {\n\t\tremoveFromArray( this.bindings, binding );\n\t}\n\n\tupdateFromBindings ( cascade ) {\n\t\tlet i = this.bindings.length;\n\t\twhile ( i-- ) {\n\t\t\tconst value = this.bindings[i].getValue();\n\t\t\tif ( value !== this.value ) this.set( value );\n\t\t}\n\n\t\tif ( cascade ) {\n\t\t\tthis.children.forEach( updateFromBindings );\n\t\t}\n\t}\n\n\tupdateKeypathDependants () {\n\t\tthis.children.forEach( updateKeypathDependants );\n\t\tif ( this.keypathModel ) this.keypathModel.handleChange();\n\t}\n}\n","import { capture, startCapturing, stopCapturing } from 'global/capture';\nimport { warnIfDebug } from 'utils/log';\nimport Model from './Model';\nimport { removeFromArray } from 'utils/array';\nimport { isEqual } from 'utils/is';\nimport { handleChange, mark as markChild } from 'shared/methodCallers';\n\n// TODO `mark` appears to conflict with method name,\n// hence `markChild` - revert once bundler is fixed\n\n// TODO this is probably a bit anal, maybe we should leave it out\nfunction prettify ( fnBody ) {\n\tconst lines = fnBody\n\t\t.replace( /^\\t+/gm, tabs => tabs.split( '\\t' ).join( '  ' ) )\n\t\t.split( '\\n' );\n\n\tconst minIndent = lines.length < 2 ? 0 :\n\t\tlines.slice( 1 ).reduce( ( prev, line ) => {\n\t\t\treturn Math.min( prev, /^\\s*/.exec( line )[0].length );\n\t\t}, Infinity );\n\n\treturn lines.map( ( line, i ) => {\n\t\treturn '    ' + ( i ? line.substring( minIndent ) : line );\n\t}).join( '\\n' );\n}\n\n// Ditto. This function truncates the stack to only include app code\nfunction truncateStack ( stack ) {\n\tif ( !stack ) return '';\n\n\tconst lines = stack.split( '\\n' );\n\tconst name = Computation.name + '.getValue';\n\n\tlet truncated = [];\n\n\tconst len = lines.length;\n\tfor ( let i = 1; i < len; i += 1 ) {\n\t\tconst line = lines[i];\n\n\t\tif ( ~line.indexOf( name ) ) {\n\t\t\treturn truncated.join( '\\n' );\n\t\t} else {\n\t\t\ttruncated.push( line );\n\t\t}\n\t}\n}\n\nexport default class Computation extends Model {\n\tconstructor ( viewmodel, signature, key ) {\n\t\tsuper( null, null );\n\n\t\tthis.root = this.parent = viewmodel;\n\t\tthis.signature = signature;\n\t\tthis.key = key; // not actually used, but helps with debugging\n\n\t\tthis.isReadonly = !this.signature.setter;\n\n\t\tthis.context = viewmodel.computationContext;\n\n\t\tthis.dependencies = [];\n\n\t\tthis.children = [];\n\t\tthis.childByKey = {};\n\n\t\tthis.deps = [];\n\n\t\tthis.boundsSensitive = true;\n\t\tthis.dirty = true;\n\t}\n\n\tget ( shouldCapture ) {\n\t\tif ( shouldCapture ) capture( this );\n\n\t\tif ( this.dirty ) {\n\t\t\tthis.value = this.getValue();\n\t\t\tthis.adapt();\n\t\t\tthis.dirty = false;\n\t\t}\n\n\t\treturn this.value;\n\t}\n\n\tgetValue () {\n\t\tstartCapturing();\n\t\tlet result;\n\n\t\ttry {\n\t\t\tresult = this.signature.getter.call( this.context );\n\t\t} catch ( err ) {\n\t\t\twarnIfDebug( `Failed to compute ${this.getKeypath()}: ${err.message || err}` );\n\n\t\t\t// TODO this is all well and good in Chrome, but...\n\t\t\t// ...also, should encapsulate this stuff better, and only\n\t\t\t// show it if Ractive.DEBUG\n\t\t\tif ( console.groupCollapsed ) console.groupCollapsed( '%cshow details', 'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;' );\n\t\t\tconst functionBody = prettify( this.signature.getterString );\n\t\t\tconst stack = this.signature.getterUseStack ? '\\n\\n' + truncateStack( err.stack ) : '';\n\t\t\tconsole.error( `${err.name}: ${err.message}\\n\\n${functionBody}${stack}` );\n\t\t\tif ( console.groupCollapsed ) console.groupEnd();\n\t\t}\n\n\t\tconst dependencies = stopCapturing();\n\t\tthis.setDependencies( dependencies );\n\n\t\treturn result;\n\t}\n\n\thandleChange () {\n\t\tthis.dirty = true;\n\n\t\tthis.deps.forEach( handleChange );\n\t\tthis.children.forEach( markChild ); // TODO rename to mark once bundling glitch fixed\n\t\tthis.clearUnresolveds(); // TODO same question as on Model - necessary for primitives?\n\t}\n\n\tinit () {\n\t}\n\n\tmark () {\n\t\tthis.handleChange();\n\t}\n\n\tregister ( dependant ) {\n\t\tthis.deps.push( dependant );\n\t}\n\n\tset ( value ) {\n\t\tif ( !this.signature.setter ) {\n\t\t\tthrow new Error( `Cannot set read-only computed property '${this.key}'` );\n\t\t}\n\n\t\tthis.signature.setter( value );\n\t}\n\n\tsetDependencies ( dependencies ) {\n\t\t// unregister any soft dependencies we no longer have\n\t\tlet i = this.dependencies.length;\n\t\twhile ( i-- ) {\n\t\t\tconst model = this.dependencies[i];\n\t\t\tif ( !~dependencies.indexOf( model ) ) model.unregister( this );\n\t\t}\n\n\t\t// and add any new ones\n\t\ti = dependencies.length;\n\t\twhile ( i-- ) {\n\t\t\tconst model = dependencies[i];\n\t\t\tif ( !~this.dependencies.indexOf( model ) ) model.register( this );\n\t\t}\n\n\t\tthis.dependencies = dependencies;\n\t}\n\n\tunregister ( dependant ) {\n\t\tremoveFromArray( this.deps, dependant );\n\t}\n}\n","import { capture } from 'global/capture';\nimport { extend } from 'utils/object';\nimport Computation from './Computation';\nimport Model from './Model';\nimport { handleChange, mark } from 'shared/methodCallers';\n\nexport default class RootModel extends Model {\n\tconstructor ( options ) {\n\t\tsuper( null, null );\n\n\t\t// TODO deprecate this\n\t\tthis.changes = {};\n\n\t\tthis.isRoot = true;\n\t\tthis.root = this;\n\t\tthis.ractive = options.ractive; // TODO sever this link\n\n\t\tthis.value = options.data;\n\t\tthis.adaptors = options.adapt;\n\t\tthis.adapt();\n\n\t\tthis.mappings = {};\n\n\t\tthis.computationContext = options.ractive;\n\t\tthis.computations = {};\n\t}\n\n\tapplyChanges () {\n\t\tthis._changeHash = {};\n\t\tthis.flush();\n\n\t\treturn this._changeHash;\n\t}\n\n\tcompute ( key, signature ) {\n\t\tconst computation = new Computation( this, signature, key );\n\t\tthis.computations[ key ] = computation;\n\n\t\treturn computation;\n\t}\n\n\tget ( shouldCapture ) {\n\t\tif ( shouldCapture ) capture( this );\n\t\tlet result = extend( {}, this.value );\n\n\t\tObject.keys( this.mappings ).forEach( key => {\n\t\t\tresult[ key ] = this.mappings[ key ].value;\n\t\t});\n\n\t\tObject.keys( this.computations ).forEach( key => {\n\t\t\tif ( key[0] !== '@' ) { // exclude template expressions\n\t\t\t\tresult[ key ] = this.computations[ key ].value;\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tgetKeypath () {\n\t\treturn '';\n\t}\n\n\thas ( key ) {\n\t\treturn ( key in this.mappings ) || ( key in this.computations ) || super.has( key );\n\t}\n\n\tjoinKey ( key ) {\n\t\treturn this.mappings.hasOwnProperty( key ) ? this.mappings[ key ] :\n\t\t       this.computations.hasOwnProperty( key ) ? this.computations[ key ] :\n\t\t       super.joinKey( key );\n\t}\n\n\tmap ( localKey, origin ) {\n\t\t// TODO remapping\n\t\tthis.mappings[ localKey ] = origin;\n\t}\n\n\tset ( value ) {\n\t\t// TODO wrapping root node is a baaaad idea. We should prevent this\n\t\tconst wrapper = this.wrapper;\n\t\tif ( wrapper ) {\n\t\t\tconst shouldTeardown = !wrapper.reset || wrapper.reset( value ) === false;\n\n\t\t\tif ( shouldTeardown ) {\n\t\t\t\twrapper.teardown();\n\t\t\t\tthis.wrapper = null;\n\t\t\t\tthis.value = value;\n\t\t\t\tthis.adapt();\n\t\t\t}\n\t\t} else {\n\t\t\tthis.value = value;\n\t\t\tthis.adapt();\n\t\t}\n\n\t\tthis.deps.forEach( handleChange );\n\t\tthis.children.forEach( mark );\n\t\tthis.clearUnresolveds(); // TODO do we need to do this with primitive values? if not, what about e.g. unresolved `length` property of null -> string?\n\t}\n\n\tretrieve () {\n\t\treturn this.value;\n\t}\n\n\tupdate () {\n\t\t// noop\n\t}\n\n\tupdateFromBindings ( cascade ) {\n\t\tsuper.updateFromBindings( cascade );\n\n\t\tif ( cascade ) {\n\t\t\t// TODO computations as well?\n\t\t\tObject.keys( this.mappings ).forEach( key => {\n\t\t\t\tconst model = this.mappings[ key ];\n\t\t\t\tmodel.updateFromBindings( cascade );\n\t\t\t});\n\t\t}\n\t}\n}\n","import { fatal } from 'utils/log';\n\nconst pattern = /\\$\\{([^\\}]+)\\}/g;\n\nfunction createFunctionFromString ( ractive, str ) {\n\tvar functionBody, hasThis, fn;\n\n\tfunctionBody = 'return (' + str.replace( pattern, ( match, keypath ) => {\n\t\thasThis = true;\n\t\treturn '__ractive.get(\"' + keypath + '\")';\n\t}) + ');';\n\n\tif ( hasThis ) {\n\t\tfunctionBody = 'var __ractive = this; ' + functionBody;\n\t}\n\n\tfn = new Function( functionBody );\n\treturn hasThis ? fn.bind( ractive ) : fn;\n}\n\nfunction bind ( fn, context ) {\n\treturn /this/.test( fn.toString() ) ? fn.bind( context ) : fn;\n}\n\nexport default function getComputationSignature ( ractive, key, signature ) {\n\tlet getter;\n\tlet setter;\n\n\t// useful for debugging\n\tlet getterString;\n\tlet getterUseStack;\n\tlet setterString;\n\n\tif ( typeof signature === 'function' ) {\n\t\tgetter = bind( signature, ractive );\n\t\tgetterString = signature.toString();\n\t\tgetterUseStack = true;\n\t}\n\n\tif ( typeof signature === 'string' ) {\n\t\tgetter = createFunctionFromString( ractive, signature );\n\t\tgetterString = signature;\n\t}\n\n\tif ( typeof signature === 'object' ) {\n\t\tif ( typeof signature.get === 'string' ) {\n\t\t\tgetter = createFunctionFromString( ractive, signature.get );\n\t\t\tgetterString = signature.get;\n\t\t} else if ( typeof signature.get === 'function' ) {\n\t\t\tgetter = bind( signature.get, ractive );\n\t\t\tgetterString = signature.get.toString();\n\t\t\tgetterUseStack = true;\n\t\t} else {\n\t\t\tfatal( '`%s` computation must have a `get()` method', key );\n\t\t}\n\n\t\tif ( typeof signature.set === 'function' ) {\n\t\t\tsetter = bind( signature.set, ractive );\n\t\t\tsetterString = signature.set.toString();\n\t\t}\n\t}\n\n\treturn {\n\t\tgetter,\n\t\tsetter,\n\t\tgetterString,\n\t\tsetterString,\n\t\tgetterUseStack\n\t};\n}\n","import { fatal, welcome } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport { magic as magicSupported } from 'config/environment';\nimport { ensureArray } from 'utils/array';\nimport { findInViewHierarchy } from 'shared/registry';\nimport arrayAdaptor from 'Ractive/static/adaptors/array/index';\nimport magicAdaptor from 'Ractive/static/adaptors/magic';\nimport magicArrayAdaptor from 'Ractive/static/adaptors/magicArray';\nimport { create, defineProperty, extend } from 'utils/object';\nimport dataConfigurator from 'Ractive/config/custom/data';\nimport RootModel from 'model/RootModel';\nimport Hook from 'events/Hook';\nimport getComputationSignature from './helpers/getComputationSignature';\nimport Ractive from '../Ractive';\n\nconst constructHook = new Hook( 'construct' );\n\nconst registryNames = [\n\t'adaptors',\n\t'components',\n\t'decorators',\n\t'easing',\n\t'events',\n\t'interpolators',\n\t'partials',\n\t'transitions'\n];\n\nlet uid = 0;\n\nexport default function construct ( ractive, options ) {\n\tif ( Ractive.DEBUG ) welcome();\n\n\tinitialiseProperties( ractive );\n\n\t// TODO remove this, eventually\n\tdefineProperty( ractive, 'data', { get: deprecateRactiveData });\n\n\t// TODO don't allow `onconstruct` with `new Ractive()`, there's no need for it\n\tconstructHook.fire( ractive, options );\n\n\t// Add registries\n\tregistryNames.forEach( name => {\n\t\tractive[ name ] = extend( create( ractive.constructor[ name ] || null ), options[ name ] );\n\t});\n\n\t// Create a viewmodel\n\tconst viewmodel = new RootModel({\n\t\tadapt: getAdaptors( ractive, ractive.adapt, options ),\n\t\tdata: dataConfigurator.init( ractive.constructor, ractive, options ),\n\t\tractive\n\t});\n\n\tractive.viewmodel = viewmodel;\n\n\t// Add computed properties\n\tconst computed = extend( create( ractive.constructor.prototype.computed ), options.computed );\n\n\tfor ( let key in computed ) {\n\t\tconst signature = getComputationSignature( ractive, key, computed[ key ] );\n\t\tviewmodel.compute( key, signature );\n\t}\n}\n\nfunction combine ( a, b ) {\n\tvar c = a.slice(), i = b.length;\n\n\twhile ( i-- ) {\n\t\tif ( !~c.indexOf( b[i] ) ) {\n\t\t\tc.push( b[i] );\n\t\t}\n\t}\n\n\treturn c;\n}\n\nfunction getAdaptors ( ractive, protoAdapt, options ) {\n\tvar adapt, magic, modifyArrays;\n\n\tprotoAdapt = protoAdapt.map( lookup );\n\tadapt = ensureArray( options.adapt ).map( lookup );\n\n\tadapt = combine( protoAdapt, adapt );\n\n\tmagic = 'magic' in options ? options.magic : ractive.magic;\n\tmodifyArrays = 'modifyArrays' in options ? options.modifyArrays : ractive.modifyArrays;\n\n\tif ( magic ) {\n\t\tif ( !magicSupported ) {\n\t\t\tthrow new Error( 'Getters and setters (magic mode) are not supported in this browser' );\n\t\t}\n\n\t\tif ( modifyArrays ) {\n\t\t\tadapt.push( magicArrayAdaptor );\n\t\t}\n\n\t\tadapt.push( magicAdaptor );\n\t}\n\n\tif ( modifyArrays ) {\n\t\tadapt.push( arrayAdaptor );\n\t}\n\n\treturn adapt;\n\n\n\tfunction lookup ( adaptor ) {\n\t\tif ( typeof adaptor === 'string' ) {\n\t\t\tadaptor = findInViewHierarchy( 'adaptors', ractive, adaptor );\n\n\t\t\tif ( !adaptor ) {\n\t\t\t\tfatal( missingPlugin( adaptor, 'adaptor' ) );\n\t\t\t}\n\t\t}\n\n\t\treturn adaptor;\n\t}\n}\n\nfunction initialiseProperties ( ractive ) {\n\t// Generate a unique identifier, for places where you'd use a weak map if it\n\t// existed\n\tractive._guid = 'r-' + uid++;\n\n\t// events\n\tractive._subs = create( null );\n\n\t// storage for item configuration from instantiation to reset,\n\t// like dynamic functions or original values\n\tractive._config = {};\n\n\t// animations (so we can stop any in progress at teardown)\n\tractive._animations = [];\n\n\t// nodes registry\n\tractive.nodes = {};\n\n\t// events\n\tractive.event = null;\n\tractive._eventQueue = [];\n\n\t// live queries\n\tractive._liveQueries = [];\n\tractive._liveComponentQueries = [];\n\n\t// bound data functions\n\tractive._boundFunctions = [];\n\n\t// observers\n\tractive._observers = [];\n\n\t// these could be overridden if this is an inline component instance\n\tractive.root = ractive;\n\tractive.parent = ractive.container = null; // TODO container still applicable?\n}\n\nfunction deprecateRactiveData () {\n\tthrow new Error( 'Using `ractive.data` is no longer supported - you must use the `ractive.get()` API instead' );\n}\n","import Hook from './Hook';\n\nfunction getChildQueue ( queue, ractive ) {\n\treturn queue[ ractive._guid ] || ( queue[ ractive._guid ] = [] );\n}\n\nfunction fire ( hookQueue, ractive ) {\n\tvar childQueue = getChildQueue( hookQueue.queue, ractive );\n\n\thookQueue.hook.fire( ractive );\n\n\t// queue is \"live\" because components can end up being\n\t// added while hooks fire on parents that modify data values.\n\twhile ( childQueue.length ) {\n\t\tfire( hookQueue, childQueue.shift() );\n\t}\n\n\tdelete hookQueue.queue[ ractive._guid ];\n}\n\nexport default class HookQueue {\n\tconstructor ( event ) {\n\t\tthis.hook = new Hook( event );\n\t\tthis.inProcess = {};\n\t\tthis.queue = {};\n\t}\n\n\tbegin ( ractive ) {\n\t\tthis.inProcess[ ractive._guid ] = true;\n\t}\n\n\tend ( ractive ) {\n\t\tconst parent = ractive.parent;\n\n\t\t// If this is *isn't* a child of a component that's in process,\n\t\t// it should call methods or fire at this point\n\t\tif ( !parent || !this.inProcess[ parent._guid ] ) {\n\t\t\tfire( this, ractive );\n\t\t}\n\t\t// elsewise, handoff to parent to fire when ready\n\t\telse {\n\t\t\tgetChildQueue( this.queue, parent ).push( ractive );\n\t\t}\n\n\t\tdelete this.inProcess[ ractive._guid ];\n\t}\n}\n","import { logIfDebug, warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { getElement } from 'utils/dom';\nimport config from 'Ractive/config/config';\nimport Fragment from 'view/Fragment';\nimport Hook from 'events/Hook';\nimport HookQueue from 'events/HookQueue';\nimport Ractive from '../Ractive';\n\nlet configHook = new Hook( 'config' );\nlet initHook = new HookQueue( 'init' );\n\nexport default function initialise ( ractive, userOptions, options ) {\n\tObject.keys( ractive.viewmodel.computations ).forEach( key => {\n\t\tconst computation = ractive.viewmodel.computations[ key ];\n\n\t\tif ( ractive.viewmodel.value.hasOwnProperty( key ) ) {\n\t\t\tcomputation.set( ractive.viewmodel.value[ key ] );\n\t\t}\n\n\t\tcomputation.init();\n\t});\n\n\t// init config from Parent and options\n\tconfig.init( ractive.constructor, ractive, userOptions );\n\n\tconfigHook.fire( ractive );\n\tinitHook.begin( ractive );\n\n\t// Render virtual DOM\n\tif ( ractive.template ) { // TODO ractive.template is always truthy, because of the defaults...\n\t\tlet cssIds;\n\n\t\tif ( options.cssIds || ractive.cssId ) {\n\t\t\tcssIds = options.cssIds ? options.cssIds.slice() : [];\n\n\t\t\tif ( ractive.cssId ) {\n\t\t\t\tcssIds.push( ractive.cssId );\n\t\t\t}\n\t\t}\n\n\t\tractive.fragment = new Fragment({\n\t\t\towner: ractive,\n\t\t\ttemplate: ractive.template,\n\t\t\tcssIds,\n\t\t\tindexRefs: options.indexRefs || {},\n\t\t\tkeyRefs: options.keyRefs || {}\n\t\t});\n\t}\n\n\tinitHook.end( ractive );\n\n\t// TODO initHook moved to before binding... will this break\n\t// this.findComponent inside oninit? Is that a problem?\n\t// Should be onrender anyway, right?\n\tif ( ractive.fragment ) {\n\t\tractive.fragment.bind( ractive.viewmodel );\n\n\t\t// render automatically ( if `el` is specified )\n\t\tconst el = getElement( ractive.el );\n\t\tif ( el ) {\n\t\t\tlet promise = ractive.render( el, ractive.append );\n\n\t\t\tif ( Ractive.DEBUG_PROMISES ) {\n\t\t\t\tpromise.catch( err => {\n\t\t\t\t\twarnOnceIfDebug( 'Promise debugging is enabled, to help solve errors that happen asynchronously. Some browsers will log unhandled promise rejections, in which case you can safely disable promise debugging:\\n  Ractive.DEBUG_PROMISES = false;' );\n\t\t\t\t\twarnIfDebug( 'An error happened during rendering', { ractive });\n\t\t\t\t\terr.stack && logIfDebug( err.stack );\n\n\t\t\t\t\tthrow err;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n}\n","let functionCache = {};\n\nexport default function createFunction ( str, i ) {\n\tif ( functionCache[ str ] ) return functionCache[ str ];\n\n\tlet args = new Array( i );\n\twhile ( i-- ) args[i] = `_${i}`;\n\n\tconst fn = new Function( args.join( ',' ), `return (${str})` );\n\n\treturn ( functionCache[ str ] = fn );\n}\n","import Model from 'model/Model';\nimport { unbind } from 'shared/methodCallers';\nimport createFunction from 'shared/createFunction';\nimport resolveReference from './resolveReference';\nimport { removeFromArray } from 'utils/array';\nimport { defineProperty } from 'utils/object';\n\nfunction wrapFunction ( fn, ractive, uid ) {\n\tif ( fn.__ractive_nowrap ) return fn;\n\n\tconst prop = `__ractive_${uid}`;\n\n\tif ( fn[ prop ] ) return fn[ prop ];\n\n\tif ( !/\\bthis\\b/.test( fn ) ) {\n\t\tdefineProperty( fn, '__ractive_nowrap', {\n\t\t\tvalue: true\n\t\t});\n\t\treturn fn;\n\t}\n\n\tdefineProperty( fn, prop, {\n\t\tvalue: fn.bind( ractive ),\n\t\tconfigurable: true\n\t});\n\n\t// Add properties/methods to wrapped function\n\tfor ( let key in fn ) {\n\t\tif ( fn.hasOwnProperty( key ) ) {\n\t\t\tfn[ prop ][ key ] = fn[ key ];\n\t\t}\n\t}\n\n\tractive._boundFunctions.push({ fn, prop });\n\treturn fn[ prop ];\n}\n\nexport default class ExpressionProxy extends Model {\n\tconstructor ( fragment, template ) {\n\t\tsuper( fragment.ractive.viewmodel, null );\n\n\t\tthis.fragment = fragment;\n\t\tthis.template = template;\n\n\t\tthis.isReadonly = true;\n\n\t\tthis.fn = createFunction( template.s, template.r.length );\n\t\tthis.computation = null;\n\n\t\tthis.resolvers = [];\n\t\tthis.models = template.r.map( ( ref, index ) => {\n\t\t\tconst model = resolveReference( fragment, ref );\n\n\t\t\tif ( !model ) {\n\t\t\t\tconst resolver = fragment.resolve( ref, model => {\n\t\t\t\t\tremoveFromArray( this.resolvers, resolver );\n\t\t\t\t\tthis.models[ index ] = model;\n\t\t\t\t\tthis.bubble();\n\t\t\t\t});\n\n\t\t\t\tthis.resolvers.push( resolver );\n\t\t\t}\n\n\t\t\treturn model;\n\t\t});\n\n\t\tthis.bubble();\n\t}\n\n\tbubble () {\n\t\tconst ractive = this.fragment.ractive;\n\n\t\t// TODO the @ prevents computed props from shadowing keypaths, but the real\n\t\t// question is why it's a computed prop in the first place... (hint, it's\n\t\t// to do with {{else}} blocks)\n\t\tconst key = '@' + this.template.s.replace( /_(\\d+)/g, ( match, i ) => {\n\t\t\tif ( i >= this.models.length ) return match;\n\n\t\t\tconst model = this.models[i];\n\t\t\treturn model ? model.getKeypath() : '@undefined';\n\t\t});\n\n\t\t// TODO can/should we reuse computations?\n\t\tconst signature = {\n\t\t\tgetter: () => {\n\t\t\t\tconst values = this.models.map( model => {\n\t\t\t\t\tconst value = model.get( true );\n\n\t\t\t\t\tif ( typeof value === 'function' ) {\n\t\t\t\t\t\treturn wrapFunction( value, ractive, ractive._guid );\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn this.fn.apply( ractive, values );\n\t\t\t},\n\t\t\tgetterString: key\n\t\t};\n\n\t\tconst computation = ractive.viewmodel.compute( key, signature );\n\t\tcomputation.init();\n\n\t\tthis.value = computation.get(); // TODO should not need this, eventually\n\n\t\tif ( this.computation ) {\n\t\t\tthis.computation.unregister( this );\n\t\t\t// notify children...\n\t\t}\n\n\t\tthis.computation = computation;\n\t\tcomputation.register( this );\n\t}\n\n\tget () {\n\t\treturn this.computation.get();\n\t}\n\n\tgetKeypath () {\n\t\treturn this.computation ? this.computation.getKeypath() : '@undefined';\n\t}\n\n\thandleChange () {\n\t\tthis.mark();\n\t}\n\n\tretrieve () {\n\t\treturn this.get();\n\t}\n\n\tunbind () {\n\t\tthis.resolvers.forEach( unbind );\n\t}\n}\n","import Model from 'model/Model';\nimport { REFERENCE } from 'config/types';\nimport ExpressionProxy from './ExpressionProxy';\nimport resolveReference from './resolveReference';\nimport resolve from './resolve';\nimport { unbind } from 'shared/methodCallers';\nimport { removeFromArray } from 'utils/array';\n\nexport default class ReferenceExpressionProxy extends Model {\n\tconstructor ( fragment, template ) {\n\t\tsuper( null, null );\n\t\tthis.root = fragment.ractive.viewmodel;\n\n\t\tthis.resolvers = [];\n\n\t\tthis.base = resolve( fragment, template );\n\n\t\tif ( !this.base ) {\n\t\t\tconst resolver = fragment.resolve( template.r, model => {\n\t\t\t\tthis.base = model;\n\t\t\t\tthis.bubble();\n\n\t\t\t\tremoveFromArray( this.resolvers, resolver );\n\t\t\t});\n\n\t\t\tthis.resolvers.push( resolver );\n\t\t}\n\n\t\tconst intermediary = {\n\t\t\thandleChange: () => this.bubble()\n\t\t};\n\n\t\tthis.members = template.m.map( ( template, i ) => {\n\t\t\tif ( typeof template === 'string' ) {\n\t\t\t\treturn { get: () => template };\n\t\t\t}\n\n\t\t\tlet model;\n\n\t\t\tif ( template.t === REFERENCE ) {\n\t\t\t\tmodel = resolveReference( fragment, template.n );\n\n\t\t\t\tif ( model ) {\n\t\t\t\t\tmodel.register( intermediary );\n\t\t\t\t} else {\n\t\t\t\t\tconst resolver = fragment.resolve( template.n, model => {\n\t\t\t\t\t\tthis.members[i] = model;\n\n\t\t\t\t\t\tmodel.register( intermediary );\n\t\t\t\t\t\tthis.bubble();\n\n\t\t\t\t\t\tremoveFromArray( this.resolvers, resolver );\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.resolvers.push( resolver );\n\t\t\t\t}\n\n\t\t\t\treturn model;\n\t\t\t}\n\n\t\t\tmodel = new ExpressionProxy( fragment, template );\n\t\t\tmodel.register( intermediary );\n\t\t\treturn model;\n\t\t});\n\n\t\tthis.isUnresolved = true;\n\t\tthis.bubble();\n\t}\n\n\tbubble () {\n\t\tif ( !this.base ) return;\n\n\t\t// if some members are not resolved, abort\n\t\tlet i = this.members.length;\n\t\twhile ( i-- ) {\n\t\t\tif ( !this.members[i] || this.members[i].get() === undefined ) return;\n\t\t}\n\n\t\tthis.isUnresolved = false;\n\n\t\tconst keys = this.members.map( model => model.get() );\n\t\tconst model = this.base.joinAll( keys );\n\n\t\tif ( this.model ) {\n\t\t\tthis.model.unregister( this );\n\t\t\tthis.model.unregisterTwowayBinding( this );\n\t\t}\n\n\t\tthis.model = model;\n\t\tthis.parent = model.parent;\n\n\t\tmodel.register( this );\n\t\tmodel.registerTwowayBinding( this );\n\n\t\tif ( this.keypathModel ) this.keypathModel.handleChange();\n\n\t\tthis.mark();\n\t}\n\n\tforceResolution () {\n\t\tthis.resolvers.forEach( resolver => resolver.forceResolution() );\n\t\tthis.bubble();\n\t}\n\n\tget () {\n\t\treturn this.model ? this.model.get() : undefined;\n\t}\n\n\t// indirect two-way bindings\n\tgetValue () {\n\t\tlet i = this.bindings.length;\n\t\twhile ( i-- ) {\n\t\t\tconst value = this.bindings[i].getValue();\n\t\t\tif ( value !== this.value ) return value;\n\t\t}\n\n\t\treturn this.value;\n\t}\n\n\tgetKeypath () {\n\t\treturn this.model ? this.model.getKeypath() : '@undefined';\n\t}\n\n\thandleChange () {\n\t\tthis.mark();\n\t}\n\n\tretrieve () {\n\t\treturn this.get();\n\t}\n\n\tset ( value ) {\n\t\tif ( !this.model ) throw new Error( 'Unresolved reference expression. This should not happen!' );\n\t\tthis.model.set( value );\n\t}\n\n\tunbind () {\n\t\tthis.resolvers.forEach( unbind );\n\t}\n}\n","var stringMiddlePattern, escapeSequencePattern, lineContinuationPattern;\n\n// Match one or more characters until: \", ', \\, or EOL/EOF.\n// EOL/EOF is written as (?!.) (meaning there's no non-newline char next).\nstringMiddlePattern = /^(?=.)[^\"'\\\\]+?(?:(?!.)|(?=[\"'\\\\]))/;\n\n// Match one escape sequence, including the backslash.\nescapeSequencePattern = /^\\\\(?:['\"\\\\bfnrt]|0(?![0-9])|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|(?=.)[^ux0-9])/;\n\n// Match one ES5 line continuation (backslash + line terminator).\nlineContinuationPattern = /^\\\\(?:\\r\\n|[\\u000A\\u000D\\u2028\\u2029])/;\n\n// Helper for defining getDoubleQuotedString and getSingleQuotedString.\nexport default function ( okQuote ) {\n\treturn function ( parser ) {\n\t\tvar start, literal, done, next;\n\n\t\tstart = parser.pos;\n\t\tliteral = '\"';\n\t\tdone = false;\n\n\t\twhile ( !done ) {\n\t\t\tnext = ( parser.matchPattern( stringMiddlePattern ) || parser.matchPattern( escapeSequencePattern ) ||\n\t\t\t\tparser.matchString( okQuote ) );\n\t\t\tif ( next ) {\n\t\t\t\tif ( next === '\"' ) {\n\t\t\t\t\tliteral += '\\\\\"';\n\t\t\t\t} else if ( next === \"\\\\'\" ) {\n\t\t\t\t\tliteral += \"'\";\n\t\t\t\t} else {\n\t\t\t\t\tliteral += next;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tnext = parser.matchPattern( lineContinuationPattern );\n\t\t\t\tif ( next ) {\n\t\t\t\t\t// convert \\(newline-like) into a \\u escape, which is allowed in JSON\n\t\t\t\t\tliteral += '\\\\u' + ( '000' + next.charCodeAt(1).toString(16) ).slice( -4 );\n\t\t\t\t} else {\n\t\t\t\t\tdone = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tliteral += '\"';\n\n\t\t// use JSON.parse to interpret escapes\n\t\treturn JSON.parse( literal );\n\t};\n}","import Parser from 'parse/Parser';\nimport readStringLiteral from 'parse/converters/expressions/primary/literal/readStringLiteral';\nimport readKey from 'parse/converters/expressions/shared/readKey';\n\n// simple JSON parser, without the restrictions of JSON parse\n// (i.e. having to double-quote keys).\n//\n// If passed a hash of values as the second argument, ${placeholders}\n// will be replaced with those values\n\nvar JsonParser, specials, specialsPattern, numberPattern, placeholderPattern, placeholderAtStartPattern, onlyWhitespace;\n\nspecials = {\n\t'true': true,\n\t'false': false,\n\t'undefined': undefined,\n\t'null': null\n};\n\nspecialsPattern = new RegExp( '^(?:' + Object.keys( specials ).join( '|' ) + ')' );\nnumberPattern = /^(?:[+-]?)(?:(?:(?:0|[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\nplaceholderPattern = /\\$\\{([^\\}]+)\\}/g;\nplaceholderAtStartPattern = /^\\$\\{([^\\}]+)\\}/;\nonlyWhitespace = /^\\s*$/;\n\nJsonParser = Parser.extend({\n\tinit: function ( str, options ) {\n\t\tthis.values = options.values;\n\t\tthis.allowWhitespace();\n\t},\n\n\tpostProcess: function ( result ) {\n\t\tif ( result.length !== 1 || !onlyWhitespace.test( this.leftover ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn { value: result[0].v };\n\t},\n\n\tconverters: [\n\t\tfunction getPlaceholder ( parser ) {\n\t\t\tvar placeholder;\n\n\t\t\tif ( !parser.values ) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tplaceholder = parser.matchPattern( placeholderAtStartPattern );\n\n\t\t\tif ( placeholder && ( parser.values.hasOwnProperty( placeholder ) ) ) {\n\t\t\t\treturn { v: parser.values[ placeholder ] };\n\t\t\t}\n\t\t},\n\n\t\tfunction getSpecial ( parser ) {\n\t\t\tvar special;\n\n\t\t\tif ( special = parser.matchPattern( specialsPattern ) ) {\n\t\t\t\treturn { v: specials[ special ] };\n\t\t\t}\n\t\t},\n\n\t\tfunction getNumber ( parser ) {\n\t\t\tvar number;\n\n\t\t\tif ( number = parser.matchPattern( numberPattern ) ) {\n\t\t\t\treturn { v: +number };\n\t\t\t}\n\t\t},\n\n\t\tfunction getString ( parser ) {\n\t\t\tvar stringLiteral = readStringLiteral( parser ), values;\n\n\t\t\tif ( stringLiteral && ( values = parser.values ) ) {\n\t\t\t\treturn {\n\t\t\t\t\tv: stringLiteral.v.replace( placeholderPattern, function ( match, $1 ) {\n\t\t\t\t\t\treturn ( $1 in values ? values[ $1 ] : $1 );\n\t\t\t\t\t})\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn stringLiteral;\n\t\t},\n\n\t\tfunction getObject ( parser ) {\n\t\t\tvar result, pair;\n\n\t\t\tif ( !parser.matchString( '{' ) ) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tresult = {};\n\n\t\t\tparser.allowWhitespace();\n\n\t\t\tif ( parser.matchString( '}' ) ) {\n\t\t\t\treturn { v: result };\n\t\t\t}\n\n\t\t\twhile ( pair = getKeyValuePair( parser ) ) {\n\t\t\t\tresult[ pair.key ] = pair.value;\n\n\t\t\t\tparser.allowWhitespace();\n\n\t\t\t\tif ( parser.matchString( '}' ) ) {\n\t\t\t\t\treturn { v: result };\n\t\t\t\t}\n\n\t\t\t\tif ( !parser.matchString( ',' ) ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\n\t\tfunction getArray ( parser ) {\n\t\t\tvar result, valueToken;\n\n\t\t\tif ( !parser.matchString( '[' ) ) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tresult = [];\n\n\t\t\tparser.allowWhitespace();\n\n\t\t\tif ( parser.matchString( ']' ) ) {\n\t\t\t\treturn { v: result };\n\t\t\t}\n\n\t\t\twhile ( valueToken = parser.read() ) {\n\t\t\t\tresult.push( valueToken.v );\n\n\t\t\t\tparser.allowWhitespace();\n\n\t\t\t\tif ( parser.matchString( ']' ) ) {\n\t\t\t\t\treturn { v: result };\n\t\t\t\t}\n\n\t\t\t\tif ( !parser.matchString( ',' ) ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tparser.allowWhitespace();\n\t\t\t}\n\n\t\t\treturn null;\n\t\t}\n\t]\n});\n\nfunction getKeyValuePair ( parser ) {\n\tvar key, valueToken, pair;\n\n\tparser.allowWhitespace();\n\n\tkey = readKey( parser );\n\n\tif ( !key ) {\n\t\treturn null;\n\t}\n\n\tpair = { key: key };\n\n\tparser.allowWhitespace();\n\tif ( !parser.matchString( ':' ) ) {\n\t\treturn null;\n\t}\n\tparser.allowWhitespace();\n\n\tvalueToken = parser.read();\n\tif ( !valueToken ) {\n\t\treturn null;\n\t}\n\n\tpair.value = valueToken.v;\n\n\treturn pair;\n}\n\nexport default function ( str, values ) {\n\tvar parser = new JsonParser( str, {\n\t\tvalues: values\n\t});\n\n\treturn parser.result;\n}\n","import { STRING_LITERAL } from 'config/types';\nimport makeQuotedStringMatcher from './stringLiteral/makeQuotedStringMatcher';\n\nvar getSingleQuotedString = makeQuotedStringMatcher( '\"' );\nvar getDoubleQuotedString = makeQuotedStringMatcher( \"'\" );\n\nexport default function ( parser ) {\n\tvar start, string;\n\n\tstart = parser.pos;\n\n\tif ( parser.matchString( '\"' ) ) {\n\t\tstring = getDoubleQuotedString( parser );\n\n\t\tif ( !parser.matchString( '\"' ) ) {\n\t\t\tparser.pos = start;\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\tt: STRING_LITERAL,\n\t\t\tv: string\n\t\t};\n\t}\n\n\tif ( parser.matchString( \"'\" ) ) {\n\t\tstring = getSingleQuotedString( parser );\n\n\t\tif ( !parser.matchString( \"'\" ) ) {\n\t\t\tparser.pos = start;\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\tt: STRING_LITERAL,\n\t\t\tv: string\n\t\t};\n\t}\n\n\treturn null;\n}\n","import { NUMBER_LITERAL } from 'config/types';\n\n// bulletproof number regex from https://gist.github.com/Rich-Harris/7544330\nvar numberPattern = /^(?:[+-]?)0*(?:(?:(?:[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\n\nexport default function readNumberLiteral ( parser ) {\n\tvar result;\n\n\tif ( result = parser.matchPattern( numberPattern ) ) {\n\t\treturn {\n\t\t\tt: NUMBER_LITERAL,\n\t\t\tv: result\n\t\t};\n\t}\n\n\treturn null;\n}\n","export var name = /^[a-zA-Z_$][a-zA-Z_$0-9]*/;\n","import readStringLiteral from '../primary/literal/readStringLiteral';\nimport readNumberLiteral from '../primary/literal/readNumberLiteral';\nimport { name as namePattern } from './patterns';\n\nvar identifier = /^[a-zA-Z_$][a-zA-Z_$0-9]*$/;\n\n// http://mathiasbynens.be/notes/javascript-properties\n// can be any name, string literal, or number literal\nexport default function readKey ( parser ) {\n\tvar token;\n\n\tif ( token = readStringLiteral( parser ) ) {\n\t\treturn identifier.test( token.v ) ? token.v : '\"' + token.v.replace( /\"/g, '\\\\\"' ) + '\"';\n\t}\n\n\tif ( token = readNumberLiteral( parser ) ) {\n\t\treturn token.v;\n\t}\n\n\tif ( token = parser.matchPattern( namePattern ) ) {\n\t\treturn token;\n\t}\n}\n","import runloop from 'global/runloop';\nimport { fatal, warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { COMPONENT, INTERPOLATOR, YIELDER } from 'config/types';\nimport Item from './shared/Item';\nimport construct from 'Ractive/construct';\nimport initialise from 'Ractive/initialise';\nimport render from 'Ractive/render';\nimport { create } from 'utils/object';\nimport { removeFromArray } from 'utils/array';\nimport { isArray } from 'utils/is';\nimport resolve from '../resolvers/resolve';\nimport { cancel, rebind, unbind } from 'shared/methodCallers';\nimport Hook from 'events/Hook';\nimport Fragment from '../Fragment';\nimport parseJSON from 'utils/parseJSON';\nimport fireEvent from 'events/fireEvent';\nimport updateLiveQueries from './component/updateLiveQueries';\n\nfunction removeFromLiveComponentQueries ( component ) {\n\tlet instance = component.ractive;\n\n\twhile ( instance ) {\n\t\tconst query = instance._liveComponentQueries[ `_${component.name}` ];\n\t\tif ( query ) query.remove( component );\n\n\t\tinstance = instance.parent;\n\t}\n}\n\nfunction makeDirty ( query ) {\n\tquery.makeDirty();\n}\n\nconst teardownHook = new Hook( 'teardown' );\n\nexport default class Component extends Item {\n\tconstructor ( options, ComponentConstructor ) {\n\t\tsuper( options );\n\t\tthis.type = COMPONENT; // override ELEMENT from super\n\n\t\tconst instance = create( ComponentConstructor.prototype );\n\n\t\tthis.instance = instance;\n\t\tthis.name = options.template.e;\n\t\tthis.parentFragment = options.parentFragment;\n\t\tthis.complexMappings = [];\n\n\t\tthis.liveQueries = [];\n\n\t\tif ( instance.el ) {\n\t\t\twarnIfDebug( `The <${this.name}> component has a default 'el' property; it has been disregarded` );\n\t\t}\n\n\t\tlet partials = options.template.p || {};\n\t\tif ( !( 'content' in partials ) ) partials.content = options.template.f || [];\n\t\tthis._partials = partials; // TEMP\n\n\t\tthis.yielders = {};\n\n\t\tconstruct( this.instance, { partials });\n\n\t\t// find container\n\t\tlet fragment = options.parentFragment;\n\t\tlet container;\n\t\twhile ( fragment ) {\n\t\t\tif ( fragment.owner.type === YIELDER ) {\n\t\t\t\tcontainer = fragment.owner.container;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tfragment = fragment.parent;\n\t\t}\n\n\t\t// add component-instance-specific properties\n\t\tinstance.parent = this.parentFragment.ractive;\n\t\tinstance.container = container || null;\n\t\tinstance.root = instance.parent.root;\n\t\tinstance.component = this;\n\n\t\t// for hackability, this could be an open option\n\t\t// for any ractive instance, but for now, just\n\t\t// for components and just for ractive...\n\t\tinstance._inlinePartials = partials;\n\n\t\tif ( this.template.v ) this.setupEvents();\n\t}\n\n\tbind () {\n\t\tconst viewmodel = this.instance.viewmodel;\n\t\tconst childData = viewmodel.value;\n\n\t\t// determine mappings\n\t\tif ( this.template.a ) {\n\t\t\tObject.keys( this.template.a ).forEach( localKey => {\n\t\t\t\tconst template = this.template.a[ localKey ];\n\n\t\t\t\tif ( template === 0 ) {\n\t\t\t\t\t// empty attributes are `true`\n\t\t\t\t\tviewmodel.joinKey( localKey ).set( true );\n\t\t\t\t}\n\n\t\t\t\telse if ( typeof template === 'string' ) {\n\t\t\t\t\tconst parsed = parseJSON( template );\n\t\t\t\t\tviewmodel.joinKey( localKey ).set( parsed ? parsed.value : template );\n\t\t\t\t}\n\n\t\t\t\telse if ( isArray( template ) ) {\n\t\t\t\t\tif ( template.length === 1 && template[0].t === INTERPOLATOR ) {\n\t\t\t\t\t\tlet model = resolve( this.parentFragment, template[0] );\n\n\t\t\t\t\t\tif ( !model ) {\n\t\t\t\t\t\t\twarnOnceIfDebug( `The ${localKey}='{{${template[0].r}}}' mapping is ambiguous, and may cause unexpected results. Consider initialising your data to eliminate the ambiguity`, { ractive: this.instance }); // TODO add docs page explaining this\n\t\t\t\t\t\t\tthis.parentFragment.ractive.get( localKey ); // side-effect: create mappings as necessary\n\t\t\t\t\t\t\tmodel = this.parentFragment.findContext().joinKey( localKey );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tviewmodel.map( localKey, model );\n\n\t\t\t\t\t\tif ( model.get() === undefined && localKey in childData ) {\n\t\t\t\t\t\t\tmodel.set( childData[ localKey ] );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\telse {\n\t\t\t\t\t\tconst fragment = new Fragment({\n\t\t\t\t\t\t\towner: this,\n\t\t\t\t\t\t\ttemplate\n\t\t\t\t\t\t}).bind();\n\n\t\t\t\t\t\tconst model = viewmodel.joinKey( localKey );\n\t\t\t\t\t\tmodel.set( fragment.valueOf() );\n\n\t\t\t\t\t\t// this is a *bit* of a hack\n\t\t\t\t\t\tfragment.bubble = () => {\n\t\t\t\t\t\t\tFragment.prototype.bubble.call( fragment );\n\t\t\t\t\t\t\tmodel.set( fragment.valueOf() );\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tthis.complexMappings.push( fragment );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tinitialise( this.instance, {\n\t\t\tpartials: this._partials\n\t\t}, {\n\t\t\tindexRefs: this.instance.isolated ? {} : this.parentFragment.indexRefs,\n\t\t\tkeyRefs: this.instance.isolated ? {} : this.parentFragment.keyRefs,\n\t\t\tcssIds: this.parentFragment.cssIds\n\t\t});\n\t}\n\n\tbubble () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.dirty = true;\n\t\t\tthis.parentFragment.bubble();\n\t\t}\n\t}\n\n\tcheckYielders () {\n\t\tObject.keys( this.yielders ).forEach( name => {\n\t\t\tif ( this.yielders[ name ].length > 1 ) {\n\t\t\t\trunloop.end();\n\t\t\t\tthrow new Error( `A component template can only have one {{yield${name ? ' ' + name : ''}}} declaration at a time` );\n\t\t\t}\n\t\t});\n\t}\n\n\tdetach () {\n\t\treturn this.instance.fragment.detach();\n\t}\n\n\tfind ( selector ) {\n\t\treturn this.instance.fragment.find( selector );\n\t}\n\n\tfindAll ( selector, query ) {\n\t\tthis.instance.fragment.findAll( selector, query );\n\t}\n\n\tfindComponent ( name ) {\n\t\tif ( !name || this.name === name ) return this.instance;\n\n\t\tif ( this.instance.fragment ) {\n\t\t\treturn this.instance.fragment.findComponent( name );\n\t\t}\n\t}\n\n\tfindAllComponents ( name, query ) {\n\t\tif ( query.test( this ) ) {\n\t\t\tquery.add( this.instance );\n\n\t\t\tif ( query.live ) {\n\t\t\t\tthis.liveQueries.push( query );\n\t\t\t}\n\t\t}\n\n\t\tthis.instance.fragment.findAllComponents( name, query );\n\t}\n\n\tfirstNode () {\n\t\treturn this.instance.fragment.firstNode();\n\t}\n\n\trebind () {\n\t\tthis.complexMappings.forEach( rebind );\n\n\t\tthis.liveQueries.forEach( makeDirty );\n\n\t\t// update relevant mappings\n\t\tif ( this.template.a ) {\n\t\t\tconst viewmodel = this.instance.viewmodel;\n\n\t\t\tObject.keys( this.template.a ).forEach( localKey => {\n\t\t\t\tconst template = this.template.a[ localKey ];\n\n\t\t\t\tif ( isArray( template ) && template.length === 1 && template[0].t === INTERPOLATOR ) {\n\t\t\t\t\tlet model = resolve( this.parentFragment, template[0] );\n\n\t\t\t\t\tif ( !model ) {\n\t\t\t\t\t\t// TODO is this even possible?\n\t\t\t\t\t\twarnOnceIfDebug( `The ${localKey}='{{${template[0].r}}}' mapping is ambiguous, and may cause unexpected results. Consider initialising your data to eliminate the ambiguity`, { ractive: this.instance });\n\t\t\t\t\t\tthis.parentFragment.ractive.get( localKey ); // side-effect: create mappings as necessary\n\t\t\t\t\t\tmodel = this.parentFragment.findContext().joinKey( localKey );\n\t\t\t\t\t}\n\n\t\t\t\t\tviewmodel.map( localKey, model );\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.instance.fragment.rebind( this.instance.viewmodel );\n\t}\n\n\trender ( target ) {\n\t\trender( this.instance, target, null );\n\n\t\tthis.checkYielders();\n\t\tupdateLiveQueries( this );\n\n\t\tthis.rendered = true;\n\t}\n\n\tsetupEvents () {\n\t\tObject.keys( this.template.v ).forEach( name => {\n\t\t\tconst template = this.template.v[ name ];\n\n\t\t\tif ( typeof template !== 'string' ) {\n\t\t\t\tfatal( 'Components currently only support simple events - you cannot include arguments. Sorry!' );\n\t\t\t}\n\n\t\t\tconst ractive = this.ractive;\n\n\t\t\tthis.instance.on( name, function () {\n\t\t\t\tlet event;\n\n\t\t\t\t// semi-weak test, but what else? tag the event obj ._isEvent ?\n\t\t\t\tif ( arguments.length && arguments[0] && arguments[0].node ) {\n\t\t\t\t\tevent = Array.prototype.shift.call( arguments );\n\t\t\t\t}\n\n\t\t\t\tconst args = Array.prototype.slice.call( arguments );\n\n\t\t\t\tfireEvent( ractive, template, { event, args });\n\n\t\t\t\t// cancel bubbling\n\t\t\t\treturn false;\n\t\t\t});\n\t\t});\n\t}\n\n\ttoString () {\n\t\treturn this.instance.toHTML();\n\t}\n\n\tunbind () {\n\t\tthis.complexMappings.forEach( unbind );\n\n\t\tconst instance = this.instance;\n\t\tinstance.viewmodel.teardown();\n\t\tinstance.fragment.unbind();\n\t\tinstance._observers.forEach( cancel );\n\n\t\tremoveFromLiveComponentQueries( this );\n\n\t\tif ( instance.fragment.rendered && instance.el.__ractive_instances__ ) {\n\t\t\tremoveFromArray( instance.el.__ractive_instances__, instance );\n\t\t}\n\n\t\tteardownHook.fire( instance );\n\t}\n\n\tunrender ( shouldDestroy ) {\n\t\tthis.shouldDestroy = shouldDestroy;\n\t\tthis.instance.unrender();\n\n\t\tthis.liveQueries.forEach( query => query.remove( this.instance ) );\n\t}\n\n\tupdate () {\n\t\tthis.instance.fragment.update();\n\t\tthis.checkYielders();\n\n\t\tthis.dirty = false;\n\t}\n}\n","import Item from './shared/Item';\n\nexport default class Doctype extends Item {\n\tbind () {\n\t\t// noop\n\t}\n\n\trender () {\n\t\t// noop\n\t}\n\n\tteardown () {\n\t\t// noop\n\t}\n\n\ttoString () {\n\t\treturn '<!DOCTYPE' + this.template.a + '>';\n\t}\n\n\tunbind () {\n\t\t// noop\n\t}\n\n\tunrender () {\n\t\t// noop\n\t}\n}\n","export default function resetStyle ( node, style ) {\n\tif ( style ) {\n\t\tnode.setAttribute( 'style', style );\n\t} else {\n\t\t// Next line is necessary, to remove empty style attribute!\n\t\t// See http://stackoverflow.com/a/7167553\n\t\tnode.getAttribute( 'style' );\n\t\tnode.removeAttribute( 'style' );\n\t}\n}\n","// This is the handler for DOM events that would lead to a change in the model\n// (i.e. change, sometimes, input, and occasionally click and keyup)\nexport default function handleDomEvent () {\n\tthis._ractive.binding.handleChange();\n}\n","import { INTERPOLATOR } from 'config/types';\nimport { warnIfDebug } from 'utils/log';\nimport CheckboxBinding from './CheckboxBinding';\nimport CheckboxNameBinding from './CheckboxNameBinding';\nimport ContentEditableBinding from './ContentEditableBinding';\nimport FileListBinding from './FileListBinding';\nimport GenericBinding from './GenericBinding';\nimport MultipleSelectBinding from './MultipleSelectBinding';\nimport NumericBinding from './NumericBinding';\nimport RadioBinding from './RadioBinding';\nimport RadioNameBinding from './RadioNameBinding';\nimport SingleSelectBinding from './SingleSelectBinding';\n\nfunction isBindable ( attribute ) {\n\treturn attribute &&\n\t       attribute.template.length === 1 &&\n\t       attribute.template[0].t === INTERPOLATOR &&\n\t       !attribute.template[0].s;\n}\n\nexport default function selectBinding ( element ) {\n\tconst attributes = element.attributeByName;\n\n\t// contenteditable - bind if the contenteditable attribute is true\n\t// or is bindable and may thus become true...\n\tif ( element.getAttribute( 'contenteditable' ) || isBindable( attributes.contenteditable ) ) {\n\t\t// ...and this element also has a value attribute to bind\n\t\treturn isBindable( attributes.value ) ? ContentEditableBinding : null;\n\t}\n\n\t// <input>\n\tif ( element.name === 'input' ) {\n\t\tconst type = element.getAttribute( 'type' );\n\n\t\tif ( type === 'radio' || type === 'checkbox' ) {\n\t\t\tconst bindName = isBindable( attributes.name );\n\t\t\tconst bindChecked = isBindable( attributes.checked );\n\n\t\t\t// we can either bind the name attribute, or the checked attribute - not both\n\t\t\tif ( bindName && bindChecked ) {\n\t\t\t\twarnIfDebug( 'A radio input can have two-way binding on its name attribute, or its checked attribute - not both', { ractive: element.root });\n\t\t\t}\n\n\t\t\tif ( bindName ) {\n\t\t\t\treturn type === 'radio' ? RadioNameBinding : CheckboxNameBinding;\n\t\t\t}\n\n\t\t\tif ( bindChecked ) {\n\t\t\t\treturn type === 'radio' ? RadioBinding : CheckboxBinding;\n\t\t\t}\n\t\t}\n\n\t\tif ( type === 'file' && isBindable( attributes.value ) ) {\n\t\t\treturn FileListBinding;\n\t\t}\n\n\t\tif ( isBindable( attributes.value ) ) {\n\t\t\treturn ( type === 'number' || type === 'range' ) ? NumericBinding : GenericBinding;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t// <select>\n\tif ( element.name === 'select' && isBindable( attributes.value ) ) {\n\t\treturn element.getAttribute( 'multiple' ) ? MultipleSelectBinding : SingleSelectBinding;\n\t}\n\n\t// <textarea>\n\tif ( element.name === 'textarea' && isBindable( attributes.value ) ) {\n\t\treturn GenericBinding;\n\t}\n}\n","import { noRegistryFunctionReturn } from 'config/errors';\nimport { warnIfDebug } from 'utils/log';\nimport parser from 'Ractive/config/custom/template/parser';\nimport { findInstance } from 'shared/registry';\n\nexport default function getPartialTemplate ( ractive, name, parentFragment ) {\n\tvar partial;\n\n\t// If the partial in instance or view heirarchy instances, great\n\tif ( partial = getPartialFromRegistry( ractive, name, parentFragment || {} ) ) {\n\t\treturn partial;\n\t}\n\n\t// Does it exist on the page as a script tag?\n\tpartial = parser.fromId( name, { noThrow: true } );\n\n\tif ( partial ) {\n\t\t// parse and register to this ractive instance\n\t\tlet parsed = parser.parse( partial, parser.getParseOptions( ractive ) );\n\n\t\t// register (and return main partial if there are others in the template)\n\t\treturn ractive.partials[ name ] = parsed.t;\n\t}\n}\n\nfunction getPartialFromRegistry ( ractive, name, parentFragment ) {\n\tlet fn, partial = findParentPartial( name, parentFragment.owner );\n\n\t// if there was an instance up-hierarchy, cool\n\tif ( partial ) return partial;\n\n\t// find first instance in the ractive or view hierarchy that has this partial\n\tvar instance = findInstance( 'partials', ractive, name );\n\n\tif ( !instance ) { return; }\n\n\tpartial = instance.partials[ name ];\n\n\t// partial is a function?\n\tif ( typeof partial === 'function' ) {\n\t\tfn = partial.bind( instance );\n\t\tfn.isOwner = instance.partials.hasOwnProperty(name);\n\t\tpartial = fn.call( ractive, parser );\n\t}\n\n\tif ( !partial && partial !== '' ) {\n\t\twarnIfDebug( noRegistryFunctionReturn, name, 'partial', 'partial', { ractive });\n\t\treturn;\n\t}\n\n\t// If this was added manually to the registry,\n\t// but hasn't been parsed, parse it now\n\tif ( !parser.isParsed( partial ) ) {\n\n\t\t// use the parseOptions of the ractive instance on which it was found\n\t\tlet parsed = parser.parse( partial, parser.getParseOptions( instance ) );\n\n\t\t// Partials cannot contain nested partials!\n\t\t// TODO add a test for this\n\t\tif ( parsed.p ) {\n\t\t\twarnIfDebug( 'Partials ({{>%s}}) cannot contain nested inline partials', name, { ractive });\n\t\t}\n\n\t\t// if fn, use instance to store result, otherwise needs to go\n\t\t// in the correct point in prototype chain on instance or constructor\n\t\tlet target = fn ? instance : findOwner( instance, name );\n\n\t\t// may be a template with partials, which need to be registered and main template extracted\n\t\ttarget.partials[ name ] = partial = parsed.t;\n\t}\n\n\t// store for reset\n\tif ( fn ) {\n\t\tpartial._fn = fn;\n\t}\n\n\treturn partial.v ? partial.t : partial;\n}\n\nfunction findOwner ( ractive, key ) {\n\treturn ractive.partials.hasOwnProperty( key )\n\t\t? ractive\n\t\t: findConstructor( ractive.constructor, key);\n}\n\nfunction findConstructor ( constructor, key ) {\n\tif ( !constructor ) { return; }\n\treturn constructor.partials.hasOwnProperty( key )\n\t\t? constructor\n\t\t: findConstructor( constructor._Parent, key );\n}\n\nfunction findParentPartial( name, parent ) {\n\tif ( parent ) {\n\t\tif ( parent.template && parent.template.p && parent.template.p[name] ) {\n\t\t\treturn parent.template.p[name];\n\t\t} else if ( parent.parentFragment && parent.parentFragment.owner ) {\n\t\t\treturn findParentPartial( name, parent.parentFragment.owner );\n\t\t}\n\t}\n}\n","import { noRegistryFunctionReturn } from 'config/errors';\nimport { warnIfDebug } from 'utils/log';\nimport { findInstance } from 'shared/registry';\n\n// finds the component constructor in the registry or view hierarchy registries\nexport default function getComponentConstructor ( ractive, name ) {\n\tvar Component, instance = findInstance( 'components', ractive, name );\n\n\tif ( instance ) {\n\t\tComponent = instance.components[ name ];\n\n\t\t// best test we have for not Ractive.extend\n\t\tif ( !Component._Parent ) {\n\t\t\t// function option, execute and store for reset\n\t\t\tlet fn = Component.bind( instance );\n\t\t\tfn.isOwner = instance.components.hasOwnProperty( name );\n\t\t\tComponent = fn();\n\n\t\t\tif ( !Component ) {\n\t\t\t\twarnIfDebug( noRegistryFunctionReturn, name, 'component', 'component', { ractive });\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( typeof Component === 'string' ) {\n\t\t\t\t// allow string lookup\n\t\t\t\tComponent = getComponentConstructor( ractive, Component );\n\t\t\t}\n\n\t\t\tComponent._fn = fn;\n\t\t\tinstance.components[ name ] = Component;\n\t\t}\n\t}\n\n\treturn Component;\n}\n","import { TEXT } from 'config/types';\n\n// TODO all this code needs to die\nexport default function processItems ( items, values, guid, counter = 0 ) {\n\treturn items.map( function ( item ) {\n\t\tif ( item.type === TEXT ) {\n\t\t\treturn item.template;\n\t\t}\n\n\t\tif ( item.fragment ) {\n\t\t\tif ( item.fragment.iterations ) {\n\t\t\t\treturn item.fragment.iterations.map( fragment => {\n\t\t\t\t\treturn processItems( fragment.items, values, guid, counter );\n\t\t\t\t}).join( '' );\n\t\t\t} else {\n\t\t\t\treturn processItems( item.fragment.items, values, guid, counter );\n\t\t\t}\n\t\t}\n\n\t\tconst placeholderId = `${guid}-${counter++}`;\n\n\t\tvalues[ placeholderId ] = item.model ?\n\t\t\titem.model.wrapper ?\n\t\t\t\titem.model.wrapper.value :\n\t\t\t\titem.model.get() :\n\t\t\tundefined;\n\n\t\treturn '${' + placeholderId + '}';\n\t}).join( '' );\n}\n","import { default as templateConfigurator } from 'Ractive/config/custom/template/template';\nimport Fragment from 'view/Fragment';\n\n// TODO should resetTemplate be asynchronous? i.e. should it be a case\n// of outro, update template, intro? I reckon probably not, since that\n// could be achieved with unrender-resetTemplate-render. Also, it should\n// conceptually be similar to resetPartial, which couldn't be async\n\nexport default function Ractive$resetTemplate ( template ) {\n\tvar transitionsEnabled, component;\n\n\ttemplateConfigurator.init( null, this, { template: template });\n\n\ttransitionsEnabled = this.transitionsEnabled;\n\tthis.transitionsEnabled = false;\n\n\t// Is this is a component, we need to set the `shouldDestroy`\n\t// flag, otherwise it will assume by default that a parent node\n\t// will be detached, and therefore it doesn't need to bother\n\t// detaching its own nodes\n\tif ( component = this.component ) {\n\t\tcomponent.shouldDestroy = true;\n\t}\n\n\tthis.unrender();\n\n\tif ( component ) {\n\t\tcomponent.shouldDestroy = false;\n\t}\n\n\t// remove existing fragment and create new one\n\tthis.fragment.unbind();\n\tthis.fragment = new Fragment({\n\t\ttemplate: this.template,\n\t\troot: this,\n\t\towner: this\n\t});\n\tthis.fragment.bind( this.viewmodel );\n\n\tthis.render( this.el, this.anchor );\n\n\tthis.transitionsEnabled = transitionsEnabled;\n}\n","import { isObject } from 'utils/is';\nimport { splitKeypath } from 'shared/keypaths';\nimport runloop from 'global/runloop';\n\nexport default function Ractive$set ( keypath, value ) {\n\tvar map, promise;\n\n\tpromise = runloop.start( this, true );\n\n\t// Set multiple keypaths in one go\n\tif ( isObject( keypath ) ) {\n\t\tmap = keypath;\n\n\t\tfor ( keypath in map ) {\n\t\t\tif ( map.hasOwnProperty( keypath) ) {\n\t\t\t\tset( this, keypath, map[ keypath ] );\n\t\t\t}\n\t\t}\n\t}\n\t// Set a single keypath\n\telse {\n\t\tset( this, keypath, value );\n\t}\n\n\trunloop.end();\n\n\treturn promise;\n}\n\n\nfunction set ( ractive, keypath, value ) {\n\tif ( /\\*/.test( keypath ) ) {\n\t\tractive.viewmodel.findMatches( splitKeypath( keypath ) ).forEach( model => {\n\t\t\tmodel.set( value );\n\t\t});\n\t} else {\n\t\tconst model = ractive.viewmodel.joinAll( splitKeypath( keypath ) );\n\t\tmodel.set( value );\n\t}\n}\n","import add from './shared/add';\n\nexport default function Ractive$subtract ( keypath, d ) {\n\treturn add( this, keypath, ( d === undefined ? -1 : -d ) );\n}\n","import { badArguments } from 'config/errors';\nimport { splitKeypath } from 'shared/keypaths';\n\nexport default function Ractive$toggle ( keypath ) {\n\tif ( typeof keypath !== 'string' ) {\n\t\tthrow new TypeError( badArguments );\n\t}\n\n\tlet changes;\n\n\tif ( /\\*/.test( keypath ) ) {\n\t\tchanges = {};\n\n\t\tthis.viewmodel.findMatches( splitKeypath( keypath ) ).forEach( model => {\n\t\t\tchanges[ model.getKeypath() ] = !model.get();\n\t\t});\n\n\t\treturn this.set( changes );\n\t}\n\n\treturn this.set( keypath, !this.get( keypath ) );\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport runloop from 'global/runloop';\n\nexport default function Ractive$updateModel ( keypath, cascade ) {\n\tconst promise = runloop.start( this, true );\n\n\tif ( !keypath ) {\n\t\tthis.viewmodel.updateFromBindings( true );\n\t} else {\n\t\tthis.viewmodel.joinAll( splitKeypath( keypath ) ).updateFromBindings( cascade !== false );\n\t}\n\n\trunloop.end();\n\n\treturn promise;\n}\n","import wrap from 'utils/wrapMethod';\nimport registries from 'Ractive/config/registries';\nimport Ractive from 'Ractive';\n\nexport default function unwrap ( Child ) {\n\tlet options = {};\n\n\twhile ( Child ) {\n\t\taddRegistries( Child, options );\n\t\taddOtherOptions( Child, options );\n\n\t\tif ( Child._Parent !== Ractive ) {\n\t\t\tChild = Child._Parent;\n\t\t} else {\n\t\t\tChild = false;\n\t\t}\n\t}\n\n\treturn options;\n}\n\nfunction addRegistries ( Child, options ) {\n\tregistries.forEach( r => {\n\t\taddRegistry(\n\t\t\tr.useDefaults ? Child.prototype : Child,\n\t\t\toptions, r.name );\n\t});\n}\n\nfunction addRegistry ( target, options, name ) {\n\tvar registry, keys = Object.keys( target[ name ] );\n\n\tif ( !keys.length ) { return; }\n\n\tif ( !( registry = options[ name ] ) ) {\n\t\tregistry = options[ name ] = {};\n\t}\n\n\tkeys\n\t\t.filter( key => !( key in registry ) )\n\t\t.forEach( key => registry[ key ] = target[ name ][ key ] );\n}\n\nfunction addOtherOptions ( Child, options ) {\n\tObject.keys( Child.prototype ).forEach( key => {\n\t\tif ( key === 'computed' ) { return; }\n\n\t\tvar value = Child.prototype[ key ];\n\n\t\tif ( !( key in options ) ) {\n\t\t\toptions[ key ] = value._method ? value._method : value;\n\t\t}\n\n\t\t// is it a wrapped function?\n\t\telse if ( typeof options[ key ] === 'function'\n\t\t\t\t&& typeof value === 'function'\n\t\t\t\t&& options[ key ]._method ) {\n\n\t\t\tlet result, needsSuper = value._method;\n\n\t\t\tif ( needsSuper ) { value = value._method; }\n\n\t\t\t// rewrap bound directly to parent fn\n\t\t\tresult = wrap( options[ key ]._method, value );\n\n\t\t\tif ( needsSuper ) { result._method = result; }\n\n\t\t\toptions[ key ] = result;\n\t\t}\n\t});\n}\n","export var TEMPLATE_VERSION = 3;","import { TEMPLATE_VERSION } from 'config/template';\n\nvar defaultOptions = {\n\n\t// render placement:\n\tel:                 void 0,\n\tappend:\t\t\t\tfalse,\n\n\t// template:\n\ttemplate:           { v: TEMPLATE_VERSION, t: [] },\n\n\t// parse:     // TODO static delimiters?\n\tpreserveWhitespace: false,\n\tsanitize:           false,\n\tstripComments:      true,\n\tdelimiters:         [ '{{', '}}' ],\n\ttripleDelimiters:   [ '{{{', '}}}' ],\n\tinterpolate:        false,\n\n\t// data & binding:\n\tdata:               {},\n\tcomputed:           {},\n\tmagic:              false,\n\tmodifyArrays:       true,\n\tadapt:              [],\n\tisolated:           false,\n\ttwoway:             true,\n\tlazy:               false,\n\n\t// transitions:\n\tnoIntro:            false,\n\ttransitionsEnabled: true,\n\tcomplete:           void 0,\n\n\t// css:\n\tcss:                null,\n\tnoCssTransform:     false\n};\n\nexport default defaultOptions;\n","// These are a subset of the easing equations found at\n// https://raw.github.com/danro/easing-js - license info\n// follows:\n\n// --------------------------------------------------\n// easing.js v0.5.4\n// Generic set of easing functions with AMD support\n// https://github.com/danro/easing-js\n// This code may be freely distributed under the MIT license\n// http://danro.mit-license.org/\n// --------------------------------------------------\n// All functions adapted from Thomas Fuchs & Jeremy Kahn\n// Easing Equations (c) 2003 Robert Penner, BSD license\n// https://raw.github.com/danro/easing-js/master/LICENSE\n// --------------------------------------------------\n\n// In that library, the functions named easeIn, easeOut, and\n// easeInOut below are named easeInCubic, easeOutCubic, and\n// (you guessed it) easeInOutCubic.\n//\n// You can add additional easing functions to this list, and they\n// will be globally available.\n\n\nexport default {\n\tlinear: function ( pos ) { return pos; },\n\teaseIn: function ( pos ) { return Math.pow( pos, 3 ); },\n\teaseOut: function ( pos ) { return ( Math.pow( ( pos - 1 ), 3 ) + 1 ); },\n\teaseInOut: function ( pos ) {\n\t\tif ( ( pos /= 0.5 ) < 1 ) { return ( 0.5 * Math.pow( pos, 3 ) ); }\n\t\treturn ( 0.5 * ( Math.pow( ( pos - 2 ), 3 ) + 2 ) );\n\t}\n};\n","/*global console, navigator */\n\nconst win = typeof window !== 'undefined' ? window : null;\nconst doc = win ? document : null;\n\nconst isClient = !!doc;\nconst isJsdom = ( typeof navigator !== 'undefined' && /jsDom/.test( navigator.appName ) );\nconst hasConsole = ( typeof console !== 'undefined' && typeof console.warn === 'function' && typeof console.warn.apply === 'function' );\n\nlet magic;\ntry {\n\tObject.defineProperty({}, 'test', { value: 0 });\n\tmagic = true;\n} catch ( e ) {\n\tmagic = false;\n}\n\nconst svg = doc ?\n\tdoc.implementation.hasFeature( 'http://www.w3.org/TR/SVG11/feature#BasicStructure', '1.1' ) :\n\tfalse;\n\nconst vendors = [ 'o', 'ms', 'moz', 'webkit' ];\n\nexport { win, doc, isClient, isJsdom, hasConsole, magic, svg, vendors };\n","import { isClient, svg, vendors, win, doc } from 'config/environment';\nimport { html } from 'config/namespaces';\n\nvar createElement, matches, div, methodNames, unprefixed, prefixed, i, j, makeFunction;\n\n// Test for SVG support\nif ( !svg ) {\n\tcreateElement = function ( type, ns ) {\n\t\tif ( ns && ns !== html ) {\n\t\t\tthrow 'This browser does not support namespaces other than http://www.w3.org/1999/xhtml. The most likely cause of this error is that you\\'re trying to render SVG in an older browser. See http://docs.ractivejs.org/latest/svg-and-older-browsers for more information';\n\t\t}\n\n\t\treturn doc.createElement( type );\n\t};\n} else {\n\tcreateElement = function ( type, ns ) {\n\t\tif ( !ns || ns === html ) {\n\t\t\treturn doc.createElement( type );\n\t\t}\n\n\t\treturn doc.createElementNS( ns, type );\n\t};\n}\n\nexport function createDocumentFragment () {\n\treturn doc.createDocumentFragment();\n}\n\nfunction getElement ( input ) {\n\tvar output;\n\n\tif ( !input || typeof input === 'boolean' ) { return; }\n\n\tif ( !win || !doc || !input ) {\n\t\treturn null;\n\t}\n\n\t// We already have a DOM node - no work to do. (Duck typing alert!)\n\tif ( input.nodeType ) {\n\t\treturn input;\n\t}\n\n\t// Get node from string\n\tif ( typeof input === 'string' ) {\n\t\t// try ID first\n\t\toutput = doc.getElementById( input );\n\n\t\t// then as selector, if possible\n\t\tif ( !output && doc.querySelector ) {\n\t\t\toutput = doc.querySelector( input );\n\t\t}\n\n\t\t// did it work?\n\t\tif ( output && output.nodeType ) {\n\t\t\treturn output;\n\t\t}\n\t}\n\n\t// If we've been given a collection (jQuery, Zepto etc), extract the first item\n\tif ( input[0] && input[0].nodeType ) {\n\t\treturn input[0];\n\t}\n\n\treturn null;\n}\n\nif ( !isClient ) {\n\tmatches = null;\n} else {\n\tdiv = createElement( 'div' );\n\tmethodNames = [ 'matches', 'matchesSelector' ];\n\n\tmakeFunction = function ( methodName ) {\n\t\treturn function ( node, selector ) {\n\t\t\treturn node[ methodName ]( selector );\n\t\t};\n\t};\n\n\ti = methodNames.length;\n\n\twhile ( i-- && !matches ) {\n\t\tunprefixed = methodNames[i];\n\n\t\tif ( div[ unprefixed ] ) {\n\t\t\tmatches = makeFunction( unprefixed );\n\t\t} else {\n\t\t\tj = vendors.length;\n\t\t\twhile ( j-- ) {\n\t\t\t\tprefixed = vendors[i] + unprefixed.substr( 0, 1 ).toUpperCase() + unprefixed.substring( 1 );\n\n\t\t\t\tif ( div[ prefixed ] ) {\n\t\t\t\t\tmatches = makeFunction( prefixed );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// IE8...\n\tif ( !matches ) {\n\t\tmatches = function ( node, selector ) {\n\t\t\tvar nodes, parentNode, i;\n\n\t\t\tparentNode = node.parentNode;\n\n\t\t\tif ( !parentNode ) {\n\t\t\t\t// empty dummy <div>\n\t\t\t\tdiv.innerHTML = '';\n\n\t\t\t\tparentNode = div;\n\t\t\t\tnode = node.cloneNode();\n\n\t\t\t\tdiv.appendChild( node );\n\t\t\t}\n\n\t\t\tnodes = parentNode.querySelectorAll( selector );\n\n\t\t\ti = nodes.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( nodes[i] === node ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t};\n\t}\n}\n\nfunction detachNode ( node ) {\n\tif ( node && typeof node.parentNode !== 'unknown' && node.parentNode ) {\n\t\tnode.parentNode.removeChild( node );\n\t}\n\n\treturn node;\n}\n\nfunction safeToStringValue( value ) {\n\treturn ( value == null || !value.toString ) ? '' : '' + value;\n}\n\nexport { createElement, detachNode, getElement, matches, safeToStringValue };\n","export default null;","import { doc } from 'config/environment';\nimport { createElement } from 'utils/dom';\nimport 'legacy';\n\nvar create, defineProperty, defineProperties;\n\ntry {\n\tObject.defineProperty({}, 'test', { value: 0 });\n\n\tif ( doc ) {\n\t\tObject.defineProperty( createElement( 'div' ), 'test', { value: 0 });\n\t}\n\n\tdefineProperty = Object.defineProperty;\n} catch ( err ) {\n\t// Object.defineProperty doesn't exist, or we're in IE8 where you can\n\t// only use it with DOM objects (what were you smoking, MSFT?)\n\tdefineProperty = function ( obj, prop, desc ) {\n\t\tobj[ prop ] = desc.value;\n\t};\n}\n\ntry {\n\ttry {\n\t\tObject.defineProperties({}, { test: { value: 0 } });\n\t} catch ( err ) {\n\t\t// TODO how do we account for this? noMagic = true;\n\t\tthrow err;\n\t}\n\n\tif ( doc ) {\n\t\tObject.defineProperties( createElement( 'div' ), { test: { value: 0 } });\n\t}\n\n\tdefineProperties = Object.defineProperties;\n} catch ( err ) {\n\tdefineProperties = function ( obj, props ) {\n\t\tvar prop;\n\n\t\tfor ( prop in props ) {\n\t\t\tif ( props.hasOwnProperty( prop ) ) {\n\t\t\t\tdefineProperty( obj, prop, props[ prop ] );\n\t\t\t}\n\t\t}\n\t};\n}\n\ntry {\n\tObject.create( null );\n\n\tcreate = Object.create;\n} catch ( err ) {\n\t// sigh\n\tcreate = (function () {\n\t\tvar F = function () {};\n\n\t\treturn function ( proto, props ) {\n\t\t\tvar obj;\n\n\t\t\tif ( proto === null ) {\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\tF.prototype = proto;\n\t\t\tobj = new F();\n\n\t\t\tif ( props ) {\n\t\t\t\tObject.defineProperties( obj, props );\n\t\t\t}\n\n\t\t\treturn obj;\n\t\t};\n\t}());\n}\n\nexport { create, defineProperty, defineProperties };\n\nexport function extend ( target, ...sources ) {\n\tvar prop, source;\n\n\twhile ( source = sources.shift() ) {\n\t\tfor ( prop in source ) {\n\t\t\tif ( hasOwn.call( source, prop ) ) {\n\t\t\t\ttarget[ prop ] = source[ prop ];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn target;\n}\n\nexport function fillGaps ( target, ...sources ) {\n\tsources.forEach( s => {\n\t\tfor ( let key in s ) {\n\t\t\tif ( s.hasOwnProperty( key ) && !( key in target ) ) {\n\t\t\t\ttarget[ key ] = s[ key ];\n\t\t\t}\n\t\t}\n\t});\n\n\treturn target;\n}\n\nexport var hasOwn = Object.prototype.hasOwnProperty;\n","/* global console */\nimport { hasConsole } from 'config/environment';\nimport Ractive from 'Ractive';\nimport noop from 'utils/noop';\n\nvar alreadyWarned = {}, log, printWarning, welcome;\n\nif ( hasConsole ) {\n\tlet welcomeIntro = [\n\t\t`%cRactive.js %c<@version@> %cin debug mode, %cmore...`,\n\t\t'color: rgb(114, 157, 52); font-weight: normal;',\n\t\t'color: rgb(85, 85, 85); font-weight: normal;',\n\t\t'color: rgb(85, 85, 85); font-weight: normal;',\n\t\t'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;'\n\t];\n\tlet welcomeMessage = `You're running Ractive <@version@> in debug mode - messages will be printed to the console to help you fix problems and optimise your application.\n\nTo disable debug mode, add this line at the start of your app:\n  Ractive.DEBUG = false;\n\nTo disable debug mode when your app is minified, add this snippet:\n  Ractive.DEBUG = /unminified/.test(function(){/*unminified*/});\n\nGet help and support:\n  http://docs.ractivejs.org\n  http://stackoverflow.com/questions/tagged/ractivejs\n  http://groups.google.com/forum/#!forum/ractive-js\n  http://twitter.com/ractivejs\n\nFound a bug? Raise an issue:\n  https://github.com/ractivejs/ractive/issues\n\n`;\n\n\twelcome = () => {\n\t\tlet hasGroup = !!console.groupCollapsed;\n\t\tconsole[ hasGroup ? 'groupCollapsed' : 'log' ].apply( console, welcomeIntro );\n\t\tconsole.log( welcomeMessage );\n\t\tif ( hasGroup ) {\n\t\t\tconsole.groupEnd( welcomeIntro );\n\t\t}\n\n\t\twelcome = noop;\n\t};\n\n\tprintWarning = ( message, args ) => {\n\t\twelcome();\n\n\t\t// extract information about the instance this message pertains to, if applicable\n\t\tif ( typeof args[ args.length - 1 ] === 'object' ) {\n\t\t\tlet options = args.pop();\n\t\t\tlet ractive = options ? options.ractive : null;\n\n\t\t\tif ( ractive ) {\n\t\t\t\t// if this is an instance of a component that we know the name of, add\n\t\t\t\t// it to the message\n\t\t\t\tlet name;\n\t\t\t\tif ( ractive.component && ( name = ractive.component.name ) ) {\n\t\t\t\t\tmessage = `<${name}> ${message}`;\n\t\t\t\t}\n\n\t\t\t\tlet node;\n\t\t\t\tif ( node = ( options.node || ( ractive.fragment && ractive.fragment.rendered && ractive.find( '*' ) ) ) ) {\n\t\t\t\t\targs.push( node );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconsole.warn.apply( console, [ '%cRactive.js: %c' + message, 'color: rgb(114, 157, 52);', 'color: rgb(85, 85, 85);' ].concat( args ) );\n\t};\n\n\tlog = function () {\n\t\tconsole.log.apply( console, arguments );\n\t};\n} else {\n\tprintWarning = log = welcome = noop;\n}\n\nfunction format ( message, args ) {\n\treturn message.replace( /%s/g, () => args.shift() );\n}\n\nfunction fatal ( message, ...args ) {\n\tmessage = format( message, args );\n\tthrow new Error( message );\n}\n\nfunction logIfDebug () {\n\tif ( Ractive.DEBUG ) {\n\t\tlog.apply( null, arguments );\n\t}\n}\n\nfunction warn ( message, ...args ) {\n\tmessage = format( message, args );\n\tprintWarning( message, args );\n}\n\nfunction warnOnce ( message, ...args ) {\n\tmessage = format( message, args );\n\n\tif ( alreadyWarned[ message ] ) {\n\t\treturn;\n\t}\n\n\talreadyWarned[ message ] = true;\n\tprintWarning( message, args );\n}\n\nfunction warnIfDebug () {\n\tif ( Ractive.DEBUG ) {\n\t\twarn.apply( null, arguments );\n\t}\n}\n\nfunction warnOnceIfDebug () {\n\tif ( Ractive.DEBUG ) {\n\t\twarnOnce.apply( null, arguments );\n\t}\n}\n\nexport { fatal, log, logIfDebug, warn, warnOnce, warnIfDebug, warnOnceIfDebug, welcome };\n","var toString = Object.prototype.toString,\n\tarrayLikePattern = /^\\[object (?:Array|FileList)\\]$/;\n\n// thanks, http://perfectionkills.com/instanceof-considered-harmful-or-how-to-write-a-robust-isarray/\nexport function isArray ( thing ) {\n\treturn toString.call( thing ) === '[object Array]';\n}\n\nexport function isArrayLike ( obj ) {\n\treturn arrayLikePattern.test( toString.call( obj ) );\n}\n\nexport function isEqual ( a, b ) {\n\tif ( a === null && b === null ) {\n\t\treturn true;\n\t}\n\n\tif ( typeof a === 'object' || typeof b === 'object' ) {\n\t\treturn false;\n\t}\n\n\treturn a === b;\n}\n\n// http://stackoverflow.com/questions/18082/validate-numbers-in-javascript-isnumeric\nexport function isNumeric ( thing ) {\n\treturn !isNaN( parseFloat( thing ) ) && isFinite( thing );\n}\n\nexport function isObject ( thing ) {\n\treturn ( thing && toString.call( thing ) === '[object Object]' );\n}\n","// Error messages that are used (or could be) in multiple places\nexport var badArguments = 'Bad arguments';\nexport var noRegistryFunctionReturn = 'A function was specified for \"%s\" %s, but no %s was returned';\nexport var missingPlugin = ( name, type ) => `Missing \"${name}\" ${type} plugin. You may need to download a plugin via http://docs.ractivejs.org/latest/plugins#${type}s`;\n","import { vendors, win } from 'config/environment';\n\nvar requestAnimationFrame;\n\n// If window doesn't exist, we don't need requestAnimationFrame\nif ( !win ) {\n\trequestAnimationFrame = null;\n} else {\n\t// https://gist.github.com/paulirish/1579671\n\t(function(vendors, lastTime, win) {\n\n\t\tvar x, setTimeout;\n\n\t\tif ( win.requestAnimationFrame ) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor ( x = 0; x < vendors.length && !win.requestAnimationFrame; ++x ) {\n\t\t\twin.requestAnimationFrame = win[vendors[x]+'RequestAnimationFrame'];\n\t\t}\n\n\t\tif ( !win.requestAnimationFrame ) {\n\t\t\tsetTimeout = win.setTimeout;\n\n\t\t\twin.requestAnimationFrame = function(callback) {\n\t\t\t\tvar currTime, timeToCall, id;\n\n\t\t\t\tcurrTime = Date.now();\n\t\t\t\ttimeToCall = Math.max( 0, 16 - (currTime - lastTime ) );\n\t\t\t\tid = setTimeout( function() { callback(currTime + timeToCall); }, timeToCall );\n\n\t\t\t\tlastTime = currTime + timeToCall;\n\t\t\t\treturn id;\n\t\t\t};\n\t\t}\n\n\t}( vendors, 0, win ));\n\n\trequestAnimationFrame = win.requestAnimationFrame;\n}\n\nexport default requestAnimationFrame;\n","import { fatal } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport interpolators from 'Ractive/static/interpolators';\nimport { findInViewHierarchy } from 'shared/registry';\n\nvar interpolate = function ( from, to, ractive, type ) {\n\tif ( from === to ) {\n\t\treturn snap( to );\n\t}\n\n\tif ( type ) {\n\n\t\tlet interpol = findInViewHierarchy( 'interpolators', ractive, type );\n\t\tif ( interpol ) {\n\t\t\treturn interpol( from, to ) || snap( to );\n\t\t}\n\n\t\tfatal( missingPlugin( type, 'interpolator' ) );\n\t}\n\n\treturn interpolators.number( from, to ) ||\n\t       interpolators.array( from, to ) ||\n\t       interpolators.object( from, to ) ||\n\t       snap( to );\n};\n\nexport default interpolate;\n\nfunction snap ( to ) {\n\treturn () => to;\n}\n","import { hasOwn } from 'utils/object';\nimport { isArray, isObject, isNumeric } from 'utils/is';\nimport interpolate from 'shared/interpolate';\n\nvar interpolators = {\n\tnumber: function ( from, to ) {\n\t\tvar delta;\n\n\t\tif ( !isNumeric( from ) || !isNumeric( to ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tfrom = +from;\n\t\tto = +to;\n\n\t\tdelta = to - from;\n\n\t\tif ( !delta ) {\n\t\t\treturn function () { return from; };\n\t\t}\n\n\t\treturn function ( t ) {\n\t\t\treturn from + ( t * delta );\n\t\t};\n\t},\n\n\tarray: function ( from, to ) {\n\t\tvar intermediate, interpolators, len, i;\n\n\t\tif ( !isArray( from ) || !isArray( to ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tintermediate = [];\n\t\tinterpolators = [];\n\n\t\ti = len = Math.min( from.length, to.length );\n\t\twhile ( i-- ) {\n\t\t\tinterpolators[i] = interpolate( from[i], to[i] );\n\t\t}\n\n\t\t// surplus values - don't interpolate, but don't exclude them either\n\t\tfor ( i=len; i<from.length; i+=1 ) {\n\t\t\tintermediate[i] = from[i];\n\t\t}\n\n\t\tfor ( i=len; i<to.length; i+=1 ) {\n\t\t\tintermediate[i] = to[i];\n\t\t}\n\n\t\treturn function ( t ) {\n\t\t\tvar i = len;\n\n\t\t\twhile ( i-- ) {\n\t\t\t\tintermediate[i] = interpolators[i]( t );\n\t\t\t}\n\n\t\t\treturn intermediate;\n\t\t};\n\t},\n\n\tobject: function ( from, to ) {\n\t\tvar properties, len, interpolators, intermediate, prop;\n\n\t\tif ( !isObject( from ) || !isObject( to ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tproperties = [];\n\t\tintermediate = {};\n\t\tinterpolators = {};\n\n\t\tfor ( prop in from ) {\n\t\t\tif ( hasOwn.call( from, prop ) ) {\n\t\t\t\tif ( hasOwn.call( to, prop ) ) {\n\t\t\t\t\tproperties.push( prop );\n\t\t\t\t\tinterpolators[ prop ] = interpolate( from[ prop ], to[ prop ] );\n\t\t\t\t}\n\n\t\t\t\telse {\n\t\t\t\t\tintermediate[ prop ] = from[ prop ];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor ( prop in to ) {\n\t\t\tif ( hasOwn.call( to, prop ) && !hasOwn.call( from, prop ) ) {\n\t\t\t\tintermediate[ prop ] = to[ prop ];\n\t\t\t}\n\t\t}\n\n\t\tlen = properties.length;\n\n\t\treturn function ( t ) {\n\t\t\tvar i = len, prop;\n\n\t\t\twhile ( i-- ) {\n\t\t\t\tprop = properties[i];\n\n\t\t\t\tintermediate[ prop ] = interpolators[ prop ]( t );\n\t\t\t}\n\n\t\t\treturn intermediate;\n\t\t};\n\t}\n};\n\nexport default interpolators;\n","let refPattern = /\\[\\s*(\\*|[0-9]|[1-9][0-9]+)\\s*\\]/g;\n\nexport function normalise ( ref ) {\n\treturn ref ? ref.replace( refPattern, '.$1' ) : '';\n}\n\nexport function splitKeypath ( keypath ) {\n\treturn normalise( keypath ).split( '.' );\n}\n","import { isNumeric } from 'utils/is';\nimport { splitKeypath } from 'shared/keypaths';\n\nconst errorMessage = 'Cannot add to a non-numeric value';\n\nexport default function add ( ractive, keypath, d ) {\n\tif ( typeof keypath !== 'string' || !isNumeric( d ) ) {\n\t\tthrow new Error( 'Bad arguments' );\n\t}\n\n\tif ( /\\*/.test( keypath ) ) {\n\t\tlet changes = {};\n\n\t\tractive.viewmodel.findMatches( splitKeypath( keypath ) ).forEach( model => {\n\t\t\tconst value = model.get();\n\n\t\t\tif ( !isNumeric( value ) ) throw new Error( errorMessage );\n\n\t\t\tchanges[ model.getKeypath() ] = value + d;\n\t\t});\n\n\t\treturn ractive.set( changes );\n\t}\n\n\tconst value = ractive.get( keypath );\n\n\tif ( !isNumeric( value ) ) {\n\t\tthrow new Error( errorMessage );\n\t}\n\n\treturn ractive.set( keypath, +value + d );\n}\n","import { win } from 'config/environment';\n\nconst getTime = ( win && win.performance && typeof win.performance.now === 'function' ) ?\n\t() => win.performance.now() :\n\t() => Date.now();\n\nexport default getTime;\n","import { warnIfDebug } from 'utils/log';\n\n// TODO: deprecate in future release\nconst deprecations = {\n\tconstruct: {\n\t\tdeprecated: 'beforeInit',\n\t\treplacement: 'onconstruct'\n\t},\n\trender: {\n\t\tdeprecated: 'init',\n\t\tmessage: 'The \"init\" method has been deprecated ' +\n\t\t\t'and will likely be removed in a future release. ' +\n\t\t\t'You can either use the \"oninit\" method which will fire ' +\n\t\t\t'only once prior to, and regardless of, any eventual ractive ' +\n\t\t\t'instance being rendered, or if you need to access the ' +\n\t\t\t'rendered DOM, use \"onrender\" instead. ' +\n\t\t\t'See http://docs.ractivejs.org/latest/migrating for more information.'\n\t},\n\tcomplete: {\n\t\tdeprecated: 'complete',\n\t\treplacement: 'oncomplete'\n\t}\n};\n\nexport default class Hook {\n\tconstructor ( event ) {\n\t\tthis.event = event;\n\t\tthis.method = 'on' + event;\n\t\tthis.deprecate = deprecations[ event ];\n\t}\n\n\tcall ( method, ractive, arg ) {\n\t\tif ( ractive[ method ] ) {\n\t\t\targ ? ractive[ method ]( arg ) : ractive[ method ]();\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tfire ( ractive, arg ) {\n\t\tthis.call( this.method, ractive, arg );\n\n\t\t// handle deprecations\n\t\tif ( !ractive[ this.method ] && this.deprecate && this.call( this.deprecate.deprecated, ractive, arg ) ) {\n\t\t\tif ( this.deprecate.message ) {\n\t\t\t\twarnIfDebug( this.deprecate.message );\n\t\t\t} else {\n\t\t\t\twarnIfDebug( 'The method \"%s\" has been deprecated in favor of \"%s\" and will likely be removed in a future release. See http://docs.ractivejs.org/latest/migrating for more information.', this.deprecate.deprecated, this.deprecate.replacement );\n\t\t\t}\n\t\t}\n\n\t\t// TODO should probably use internal method, in case ractive.fire was overwritten\n\t\targ ? ractive.fire( this.event, arg ) : ractive.fire( this.event );\n\t}\n}\n","import { isArray } from 'utils/is';\n\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/find\nif (!Array.prototype.find) {\n\tArray.prototype.find = function(predicate) {\n\t\tif (this == null) {\n\t\tthrow new TypeError('Array.prototype.find called on null or undefined');\n\t\t}\n\t\tif (typeof predicate !== 'function') {\n\t\tthrow new TypeError('predicate must be a function');\n\t\t}\n\t\tvar list = Object(this);\n\t\tvar length = list.length >>> 0;\n\t\tvar thisArg = arguments[1];\n\t\tvar value;\n\n\t\tfor (var i = 0; i < length; i++) {\n\t\t\tif (i in list) {\n\t\t\t\tvalue = list[i];\n\t\t\t\tif (predicate.call(thisArg, value, i, list)) {\n\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t};\n}\n\nexport function addToArray ( array, value ) {\n\tvar index = array.indexOf( value );\n\n\tif ( index === -1 ) {\n\t\tarray.push( value );\n\t}\n}\n\nexport function arrayContains ( array, value ) {\n\tfor ( let i = 0, c = array.length; i < c; i++ ) {\n\t\tif ( array[i] == value ) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n    return false;\n}\n\nexport function arrayContentsMatch ( a, b ) {\n\tvar i;\n\n\tif ( !isArray( a ) || !isArray( b ) ) {\n\t\treturn false;\n\t}\n\n\tif ( a.length !== b.length ) {\n\t\treturn false;\n\t}\n\n\ti = a.length;\n\twhile ( i-- ) {\n\t\tif ( a[i] !== b[i] ) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n\nexport function ensureArray ( x ) {\n\tif ( typeof x === 'string' ) {\n\t\treturn [ x ];\n\t}\n\n\tif ( x === undefined ) {\n\t\treturn [];\n\t}\n\n\treturn x;\n}\n\nexport function lastItem ( array ) {\n\treturn array[ array.length - 1 ];\n}\n\nexport function removeFromArray ( array, member ) {\n\tif ( !array ) {\n\t\treturn;\n\t}\n\n\tconst index = array.indexOf( member );\n\n\tif ( index !== -1 ) {\n\t\tarray.splice( index, 1 );\n\t}\n}\n\nexport function toArray ( arrayLike ) {\n\tvar array = [], i = arrayLike.length;\n\twhile ( i-- ) {\n\t\tarray[i] = arrayLike[i];\n\t}\n\n\treturn array;\n}\n","var _Promise,\n\tPENDING = {},\n\tFULFILLED = {},\n\tREJECTED = {};\n\nif ( typeof Promise === 'function' ) {\n\t// use native Promise\n\t_Promise = Promise;\n} else {\n\t_Promise = function ( callback ) {\n\t\tvar fulfilledHandlers = [],\n\t\t\trejectedHandlers = [],\n\t\t\tstate = PENDING,\n\n\t\t\tresult,\n\t\t\tdispatchHandlers,\n\t\t\tmakeResolver,\n\t\t\tfulfil,\n\t\t\treject,\n\n\t\t\tpromise;\n\n\t\tmakeResolver = function ( newState ) {\n\t\t\treturn function ( value ) {\n\t\t\t\tif ( state !== PENDING ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tresult = value;\n\t\t\t\tstate = newState;\n\n\t\t\t\tdispatchHandlers = makeDispatcher( ( state === FULFILLED ? fulfilledHandlers : rejectedHandlers ), result );\n\n\t\t\t\t// dispatch onFulfilled and onRejected handlers asynchronously\n\t\t\t\twait( dispatchHandlers );\n\t\t\t};\n\t\t};\n\n\t\tfulfil = makeResolver( FULFILLED );\n\t\treject = makeResolver( REJECTED );\n\n\t\ttry {\n\t\t\tcallback( fulfil, reject );\n\t\t} catch ( err ) {\n\t\t\treject( err );\n\t\t}\n\n\t\tpromise = {\n\t\t\t// `then()` returns a Promise - 2.2.7\n\t\t\tthen: function ( onFulfilled, onRejected ) {\n\t\t\t\tvar promise2 = new _Promise( function ( fulfil, reject ) {\n\n\t\t\t\t\tvar processResolutionHandler = function ( handler, handlers, forward ) {\n\n\t\t\t\t\t\t// 2.2.1.1\n\t\t\t\t\t\tif ( typeof handler === 'function' ) {\n\t\t\t\t\t\t\thandlers.push( function ( p1result ) {\n\t\t\t\t\t\t\t\tvar x;\n\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tx = handler( p1result );\n\t\t\t\t\t\t\t\t\tresolve( promise2, x, fulfil, reject );\n\t\t\t\t\t\t\t\t} catch ( err ) {\n\t\t\t\t\t\t\t\t\treject( err );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Forward the result of promise1 to promise2, if resolution handlers\n\t\t\t\t\t\t\t// are not given\n\t\t\t\t\t\t\thandlers.push( forward );\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\t\t// 2.2\n\t\t\t\t\tprocessResolutionHandler( onFulfilled, fulfilledHandlers, fulfil );\n\t\t\t\t\tprocessResolutionHandler( onRejected, rejectedHandlers, reject );\n\n\t\t\t\t\tif ( state !== PENDING ) {\n\t\t\t\t\t\t// If the promise has resolved already, dispatch the appropriate handlers asynchronously\n\t\t\t\t\t\twait( dispatchHandlers );\n\t\t\t\t\t}\n\n\t\t\t\t});\n\n\t\t\t\treturn promise2;\n\t\t\t}\n\t\t};\n\n\t\tpromise[ 'catch' ] = function ( onRejected ) {\n\t\t\treturn this.then( null, onRejected );\n\t\t};\n\n\t\treturn promise;\n\t};\n\n\t_Promise.all = function ( promises ) {\n\t\treturn new _Promise( function ( fulfil, reject ) {\n\t\t\tvar result = [], pending, i, processPromise;\n\n\t\t\tif ( !promises.length ) {\n\t\t\t\tfulfil( result );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tprocessPromise = ( promise, i ) => {\n\t\t\t\tif ( promise && typeof promise.then === 'function' ) {\n\t\t\t\t\tpromise.then( value => {\n\t\t\t\t\t\tresult[i] = value;\n\t\t\t\t\t\t--pending || fulfil( result );\n\t\t\t\t\t}, reject );\n\t\t\t\t}\n\n\t\t\t\telse {\n\t\t\t\t\tresult[i] = promise;\n\t\t\t\t\t--pending || fulfil( result );\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tpending = i = promises.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tprocessPromise( promises[i], i );\n\t\t\t}\n\t\t});\n\t};\n\n\t_Promise.resolve = function ( value ) {\n\t\treturn new _Promise( function ( fulfil ) {\n\t\t\tfulfil( value );\n\t\t});\n\t};\n\n\t_Promise.reject = function ( reason ) {\n\t\treturn new _Promise( function ( fulfil, reject ) {\n\t\t\treject( reason );\n\t\t});\n\t};\n}\n\nexport default _Promise;\n\n// TODO use MutationObservers or something to simulate setImmediate\nfunction wait ( callback ) {\n\tsetTimeout( callback, 0 );\n}\n\nfunction makeDispatcher ( handlers, result ) {\n\treturn function () {\n\t\tvar handler;\n\n\t\twhile ( handler = handlers.shift() ) {\n\t\t\thandler( result );\n\t\t}\n\t};\n}\n\nfunction resolve ( promise, x, fulfil, reject ) {\n\t// Promise Resolution Procedure\n\tvar then;\n\n\t// 2.3.1\n\tif ( x === promise ) {\n\t\tthrow new TypeError( 'A promise\\'s fulfillment handler cannot return the same promise' );\n\t}\n\n\t// 2.3.2\n\tif ( x instanceof _Promise ) {\n\t\tx.then( fulfil, reject );\n\t}\n\n\t// 2.3.3\n\telse if ( x && ( typeof x === 'object' || typeof x === 'function' ) ) {\n\t\ttry {\n\t\t\tthen = x.then; // 2.3.3.1\n\t\t} catch ( e ) {\n\t\t\treject( e ); // 2.3.3.2\n\t\t\treturn;\n\t\t}\n\n\t\t// 2.3.3.3\n\t\tif ( typeof then === 'function' ) {\n\t\t\tvar called, resolvePromise, rejectPromise;\n\n\t\t\tresolvePromise = function ( y ) {\n\t\t\t\tif ( called ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tcalled = true;\n\t\t\t\tresolve( promise, y, fulfil, reject );\n\t\t\t};\n\n\t\t\trejectPromise = function ( r ) {\n\t\t\t\tif ( called ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tcalled = true;\n\t\t\t\treject( r );\n\t\t\t};\n\n\t\t\ttry {\n\t\t\t\tthen.call( x, resolvePromise, rejectPromise );\n\t\t\t} catch ( e ) {\n\t\t\t\tif ( !called ) { // 2.3.3.3.4.1\n\t\t\t\t\treject( e ); // 2.3.3.3.4.2\n\t\t\t\t\tcalled = true;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\telse {\n\t\t\tfulfil( x );\n\t\t}\n\t}\n\n\telse {\n\t\tfulfil( x );\n\t}\n}\n","import { removeFromArray } from 'utils/array';\nimport { teardown } from 'shared/methodCallers';\n\nexport default class TransitionManager {\n\tconstructor ( callback, parent ) {\n\t\tthis.callback = callback;\n\t\tthis.parent = parent;\n\n\t\tthis.intros = [];\n\t\tthis.outros = [];\n\n\t\tthis.children = [];\n\t\tthis.totalChildren = this.outroChildren = 0;\n\n\t\tthis.detachQueue = [];\n\t\tthis.decoratorQueue = [];\n\t\tthis.outrosComplete = false;\n\n\t\tif ( parent ) {\n\t\t\tparent.addChild( this );\n\t\t}\n\t}\n\n\tadd ( transition ) {\n\t\tvar list = transition.isIntro ? this.intros : this.outros;\n\t\tlist.push( transition );\n\t}\n\n\taddChild ( child ) {\n\t\tthis.children.push( child );\n\n\t\tthis.totalChildren += 1;\n\t\tthis.outroChildren += 1;\n\t}\n\n\t// TODO can we move decorator stuff to element detach() methods?\n\taddDecorator ( decorator ) {\n\t\tthis.decoratorQueue.push( decorator );\n\t}\n\n\tdecrementOutros () {\n\t\tthis.outroChildren -= 1;\n\t\tcheck( this );\n\t}\n\n\tdecrementTotal () {\n\t\tthis.totalChildren -= 1;\n\t\tcheck( this );\n\t}\n\n\tdetachNodes () {\n\t\tthis.decoratorQueue.forEach( teardown );\n\t\tthis.detachQueue.forEach( detach );\n\t\tthis.children.forEach( detachNodes );\n\t}\n\n\tinit () {\n\t\tthis.ready = true;\n\t\tcheck( this );\n\t}\n\n\tremove ( transition ) {\n\t\tvar list = transition.isIntro ? this.intros : this.outros;\n\t\tremoveFromArray( list, transition );\n\t\tcheck( this );\n\t}\n\n\tstart () {\n\t\tthis.intros.concat( this.outros ).forEach( t => t.start() );\n\t}\n}\n\nfunction detach ( element ) {\n\telement.detach();\n}\n\nfunction detachNodes ( tm ) {\n\ttm.detachNodes();\n}\n\nfunction check ( tm ) {\n\tif ( !tm.ready || tm.outros.length || tm.outroChildren ) return;\n\n\t// If all outros are complete, and we haven't already done this,\n\t// we notify the parent if there is one, otherwise\n\t// start detaching nodes\n\tif ( !tm.outrosComplete ) {\n\t\tif ( tm.parent ) {\n\t\t\ttm.parent.decrementOutros( tm );\n\t\t} else {\n\t\t\ttm.detachNodes();\n\t\t}\n\n\t\ttm.outrosComplete = true;\n\t}\n\n\t// Once everything is done, we can notify parent transition\n\t// manager and call the callback\n\tif ( !tm.intros.length && !tm.totalChildren ) {\n\t\tif ( typeof tm.callback === 'function' ) {\n\t\t\ttm.callback();\n\t\t}\n\n\t\tif ( tm.parent ) {\n\t\t\ttm.parent.decrementTotal();\n\t\t}\n\t}\n}\n","import Hook from 'events/Hook';\nimport { addToArray } from 'utils/array';\nimport Promise from 'utils/Promise';\nimport TransitionManager from './TransitionManager';\n\nconst changeHook = new Hook( 'change' );\n\nlet batch;\n\nconst runloop = {\n\tstart ( instance, returnPromise ) {\n\t\tvar promise, fulfilPromise;\n\n\t\tif ( returnPromise ) {\n\t\t\tpromise = new Promise( f => ( fulfilPromise = f ) );\n\t\t}\n\n\t\tbatch = {\n\t\t\tpreviousBatch: batch,\n\t\t\ttransitionManager: new TransitionManager( fulfilPromise, batch && batch.transitionManager ),\n\t\t\tfragments: [],\n\t\t\ttasks: [],\n\t\t\timmediateObservers: [],\n\t\t\tdeferredObservers: [],\n\t\t\tinstance: instance\n\t\t};\n\n\t\treturn promise;\n\t},\n\n\tend () {\n\t\tflushChanges();\n\n\t\tbatch.transitionManager.init();\n\t\tbatch = batch.previousBatch;\n\t},\n\n\taddFragment ( fragment ) {\n\t\taddToArray( batch.fragments, fragment );\n\t},\n\n\taddObserver ( observer, defer ) {\n\t\taddToArray( defer ? batch.deferredObservers : batch.immediateObservers, observer );\n\t},\n\n\tregisterTransition ( transition ) {\n\t\ttransition._manager = batch.transitionManager;\n\t\tbatch.transitionManager.add( transition );\n\t},\n\n\tregisterDecorator ( decorator ) {\n\t\tbatch.transitionManager.addDecorator( decorator );\n\t},\n\n\t// synchronise node detachments with transition ends\n\tdetachWhenReady ( thing ) {\n\t\tbatch.transitionManager.detachQueue.push( thing );\n\t},\n\n\tscheduleTask ( task, postRender ) {\n\t\tvar _batch;\n\n\t\tif ( !batch ) {\n\t\t\ttask();\n\t\t} else {\n\t\t\t_batch = batch;\n\t\t\twhile ( postRender && _batch.previousBatch ) {\n\t\t\t\t// this can't happen until the DOM has been fully updated\n\t\t\t\t// otherwise in some situations (with components inside elements)\n\t\t\t\t// transitions and decorators will initialise prematurely\n\t\t\t\t_batch = _batch.previousBatch;\n\t\t\t}\n\n\t\t\t_batch.tasks.push( task );\n\t\t}\n\t}\n};\n\nexport default runloop;\n\nfunction dispatch ( observer ) {\n\tobserver.dispatch();\n}\n\nfunction flushChanges () {\n\tvar i, thing, changeHash;\n\n\tbatch.immediateObservers.forEach( dispatch );\n\n\t// Now that changes have been fully propagated, we can update the DOM\n\t// and complete other tasks\n\ti = batch.fragments.length;\n\twhile ( i-- ) {\n\t\tthing = batch.fragments[i];\n\n\t\t// TODO deprecate this. It's annoying and serves no useful function\n\t\tconst ractive = thing.ractive;\n\t\tchangeHook.fire( ractive, ractive.viewmodel.changes );\n\t\tractive.viewmodel.changes = {};\n\n\t\tthing.update();\n\t}\n\tbatch.fragments.length = 0;\n\n\tbatch.transitionManager.start();\n\n\tbatch.deferredObservers.forEach( dispatch );\n\n\tconst tasks = batch.tasks;\n\tbatch.tasks = [];\n\n\tfor ( i = 0; i < tasks.length; i += 1 ) {\n\t\ttasks[i]();\n\t}\n\n\t// If updating the view caused some model blowback - e.g. a triple\n\t// containing <option> elements caused the binding on the <select>\n\t// to update - then we start over\n\tif ( batch.fragments.length ) return flushChanges();\n}\n","import rAF from 'utils/requestAnimationFrame';\nimport getTime from 'utils/getTime';\nimport runloop from 'global/runloop';\n\nvar queue = [];\n\nvar animations = {\n\ttick: function () {\n\t\tvar i, animation, now;\n\n\t\tnow = getTime();\n\n\t\trunloop.start();\n\n\t\tfor ( i=0; i<queue.length; i+=1 ) {\n\t\t\tanimation = queue[i];\n\n\t\t\tif ( !animation.tick( now ) ) {\n\t\t\t\t// animation is complete, remove it from the stack, and decrement i so we don't miss one\n\t\t\t\tqueue.splice( i--, 1 );\n\t\t\t}\n\t\t}\n\n\t\trunloop.end();\n\n\t\tif ( queue.length ) {\n\t\t\trAF( animations.tick );\n\t\t} else {\n\t\t\tanimations.running = false;\n\t\t}\n\t},\n\n\tadd: function ( animation ) {\n\t\tqueue.push( animation );\n\n\t\tif ( !animations.running ) {\n\t\t\tanimations.running = true;\n\t\t\trAF( animations.tick );\n\t\t}\n\t},\n\n\t// TODO optimise this\n\tabort: function ( model, root ) {\n\t\tvar i = queue.length, animation;\n\n\t\twhile ( i-- ) {\n\t\t\tanimation = queue[i];\n\n\t\t\tif ( animation.root === root && animation.model === model ) {\n\t\t\t\tanimation.stop();\n\t\t\t}\n\t\t}\n\t}\n};\n\nexport default animations;\n","import { warnIfDebug } from 'utils/log';\nimport runloop from 'global/runloop';\nimport interpolate from 'shared/interpolate';\n\nvar Animation = function ( options ) {\n\tvar key;\n\n\tthis.startTime = Date.now();\n\n\t// from and to\n\tfor ( key in options ) {\n\t\tif ( options.hasOwnProperty( key ) ) {\n\t\t\tthis[ key ] = options[ key ];\n\t\t}\n\t}\n\n\tthis.interpolator = interpolate( this.from, this.to, this.root, this.interpolator );\n\tthis.running = true;\n\n\tthis.tick();\n};\n\nAnimation.prototype = {\n\ttick: function () {\n\t\tvar elapsed, t, value, timeNow, index, keypath;\n\n\t\tkeypath = this.keypath;\n\n\t\tif ( this.running ) {\n\t\t\ttimeNow = Date.now();\n\t\t\telapsed = timeNow - this.startTime;\n\n\t\t\tif ( elapsed >= this.duration ) {\n\t\t\t\tif ( keypath !== null ) {\n\t\t\t\t\trunloop.start( this.root );\n\n\t\t\t\t\tif ( this.model ) {\n\t\t\t\t\t\tthis.model.set( this.to );\n\t\t\t\t\t}\n\n\t\t\t\t\trunloop.end();\n\t\t\t\t}\n\n\t\t\t\tif ( this.step ) {\n\t\t\t\t\tthis.step( 1, this.to );\n\t\t\t\t}\n\n\t\t\t\tthis.complete( this.to );\n\n\t\t\t\tindex = this.root._animations.indexOf( this );\n\n\t\t\t\t// TODO investigate why this happens\n\t\t\t\tif ( index === -1 ) {\n\t\t\t\t\twarnIfDebug( 'Animation was not found' );\n\t\t\t\t}\n\n\t\t\t\tthis.root._animations.splice( index, 1 );\n\n\t\t\t\tthis.running = false;\n\t\t\t\treturn false; // remove from the stack\n\t\t\t}\n\n\t\t\tt = this.easing ? this.easing ( elapsed / this.duration ) : ( elapsed / this.duration );\n\n\t\t\tif ( keypath !== null ) {\n\t\t\t\tvalue = this.interpolator( t );\n\t\t\t\trunloop.start( this.root );\n\n\t\t\t\tif ( this.model ) {\n\t\t\t\t\tthis.model.set( value );\n\t\t\t\t}\n\n\t\t\t\trunloop.end();\n\t\t\t}\n\n\t\t\tif ( this.step ) {\n\t\t\t\tthis.step( t, value );\n\t\t\t}\n\n\t\t\treturn true; // keep in the stack\n\t\t}\n\n\t\treturn false; // remove from the stack\n\t},\n\n\tstop: function () {\n\t\tvar index;\n\n\t\tthis.running = false;\n\n\t\tindex = this.root._animations.indexOf( this );\n\n\t\t// TODO investigate why this happens\n\t\tif ( index === -1 ) {\n\t\t\twarnIfDebug( 'Animation was not found' );\n\t\t}\n\n\t\tthis.root._animations.splice( index, 1 );\n\t}\n};\n\nexport default Animation;\n","import animations from 'shared/animations';\nimport Animation from './animate/Animation';\nimport { isEqual } from 'utils/is';\nimport { normalise } from 'shared/keypaths';\nimport Promise from 'utils/Promise';\nimport noop from 'utils/noop';\n\nvar noAnimation = { stop: noop };\n\nexport default function Ractive$animate ( keypath, to, options ) {\n\tvar promise,\n\t\tfulfilPromise,\n\t\tk,\n\t\tanimation,\n\t\tanimations,\n\t\teasing,\n\t\tduration,\n\t\tstep,\n\t\tcomplete,\n\t\tmakeValueCollector,\n\t\tcurrentValues,\n\t\tcollectValue,\n\t\tdummy,\n\t\tdummyOptions;\n\n\tpromise = new Promise( fulfil => fulfilPromise = fulfil );\n\n\t// animate multiple keypaths\n\tif ( typeof keypath === 'object' ) {\n\t\toptions = to || {};\n\t\teasing = options.easing;\n\t\tduration = options.duration;\n\n\t\tanimations = [];\n\n\t\t// we don't want to pass the `step` and `complete` handlers, as they will\n\t\t// run for each animation! So instead we'll store the handlers and create\n\t\t// our own...\n\t\tstep = options.step;\n\t\tcomplete = options.complete;\n\n\t\tif ( step || complete ) {\n\t\t\tcurrentValues = {};\n\n\t\t\toptions.step = null;\n\t\t\toptions.complete = null;\n\n\t\t\tmakeValueCollector = function ( keypath ) {\n\t\t\t\treturn function ( t, value ) {\n\t\t\t\t\tcurrentValues[ keypath ] = value;\n\t\t\t\t};\n\t\t\t};\n\t\t}\n\n\n\t\tfor ( k in keypath ) {\n\t\t\tif ( keypath.hasOwnProperty( k ) ) {\n\t\t\t\tif ( step || complete ) {\n\t\t\t\t\tcollectValue = makeValueCollector( k );\n\t\t\t\t\toptions = { easing, duration };\n\n\t\t\t\t\tif ( step ) {\n\t\t\t\t\t\toptions.step = collectValue;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\toptions.complete = complete ? collectValue : noop;\n\t\t\t\tanimations.push( animate( this, k, keypath[k], options ) );\n\t\t\t}\n\t\t}\n\n\t\t// Create a dummy animation, to facilitate step/complete\n\t\t// callbacks, and Promise fulfilment\n\t\tdummyOptions = { easing, duration };\n\n\t\tif ( step ) {\n\t\t\tdummyOptions.step = t => step( t, currentValues );\n\t\t}\n\n\t\tif ( complete ) {\n\t\t\tpromise.then( t => complete( t, currentValues ) );\n\t\t}\n\n\t\tdummyOptions.complete = fulfilPromise;\n\n\t\tdummy = animate( this, null, null, dummyOptions );\n\t\tanimations.push( dummy );\n\n\t\tpromise.stop = () => {\n\t\t\tvar animation;\n\n\t\t\twhile ( animation = animations.pop() ) {\n\t\t\t\tanimation.stop();\n\t\t\t}\n\n\t\t\tif ( dummy ) {\n\t\t\t\tdummy.stop();\n\t\t\t}\n\t\t};\n\n\t\treturn promise;\n\t}\n\n\t// animate a single keypath\n\toptions = options || {};\n\n\tif ( options.complete ) {\n\t\tpromise.then( options.complete );\n\t}\n\n\toptions.complete = fulfilPromise;\n\tanimation = animate( this, keypath, to, options );\n\n\tpromise.stop = () => animation.stop();\n\treturn promise;\n}\n\nfunction animate ( root, keypath, to, options ) {\n\tvar easing, duration, animation, from;\n\n\tlet model;\n\n\tif ( keypath ) {\n\t\t// TODO revisit 'dummy' approach to handling multiple\n\t\t// animations? this seems kind of hokey\n\t\tmodel = root.viewmodel.joinAll( normalise( keypath ).split( '.' ) );\n\t\tfrom = model.get();\n\n\t\t// cancel any existing animation\n\t\t// TODO what about upstream/downstream keypaths?\n\t\tanimations.abort( model, root );\n\t}\n\n\t// don't bother animating values that stay the same\n\tif ( isEqual( from, to ) ) {\n\t\tif ( options.complete ) {\n\t\t\toptions.complete( options.to );\n\t\t}\n\n\t\treturn noAnimation;\n\t}\n\n\t// easing function\n\tif ( options.easing ) {\n\t\tif ( typeof options.easing === 'function' ) {\n\t\t\teasing = options.easing;\n\t\t}\n\n\t\telse {\n\t\t\teasing = root.easing[ options.easing ];\n\t\t}\n\n\t\tif ( typeof easing !== 'function' ) {\n\t\t\teasing = null;\n\t\t}\n\t}\n\n\t// duration\n\tduration = ( options.duration === undefined ? 400 : options.duration );\n\n\t// TODO store keys, use an internal set method\n\tanimation = new Animation({\n\t\tmodel,\n\t\tfrom,\n\t\tto,\n\t\troot,\n\t\tduration,\n\t\teasing,\n\t\tinterpolator: options.interpolator,\n\n\t\t// TODO wrap callbacks if necessary, to use instance as context\n\t\tstep: options.step,\n\t\tcomplete: options.complete\n\t});\n\n\tanimations.add( animation );\n\troot._animations.push( animation );\n\n\treturn animation;\n}\n","import Hook from 'events/Hook';\nimport { removeFromArray } from 'utils/array';\n\nvar detachHook = new Hook( 'detach' );\n\nexport default function Ractive$detach () {\n\tif ( this.isDetached ) {\n\t\treturn this.el;\n\t}\n\n\tif ( this.el ) {\n\t\tremoveFromArray( this.el.__ractive_instances__, this );\n\t}\n\n\tthis.el = this.fragment.detach();\n\tthis.isDetached = true;\n\n\tdetachHook.fire( this );\n\treturn this.el;\n}\n","export default function Ractive$find ( selector ) {\n\tif ( !this.el ) {\n\t\treturn null;\n\t}\n\n\treturn this.fragment.find( selector );\n}\n","import runloop from 'global/runloop';\nimport { lastItem } from 'utils/array';\nimport { matches } from 'utils/dom';\n\nfunction sortByDocumentPosition ( node, otherNode ) {\n\tif ( node.compareDocumentPosition ) {\n\t\tconst bitmask = node.compareDocumentPosition( otherNode );\n\t\treturn ( bitmask & 2 ) ? 1 : -1;\n\t}\n\n\t// In old IE, we can piggy back on the mechanism for\n\t// comparing component positions\n\treturn sortByItemPosition( node, otherNode );\n}\n\nfunction sortByItemPosition ( a, b ) {\n\tconst ancestryA = getAncestry( a.component || a._ractive.proxy );\n\tconst ancestryB = getAncestry( b.component || b._ractive.proxy );\n\n\tlet oldestA = lastItem( ancestryA );\n\tlet oldestB = lastItem( ancestryB );\n\tlet mutualAncestor;\n\n\t// remove items from the end of both ancestries as long as they are identical\n\t// - the final one removed is the closest mutual ancestor\n\twhile ( oldestA && ( oldestA === oldestB ) ) {\n\t\tancestryA.pop();\n\t\tancestryB.pop();\n\n\t\tmutualAncestor = oldestA;\n\n\t\toldestA = lastItem( ancestryA );\n\t\toldestB = lastItem( ancestryB );\n\t}\n\n\t// now that we have the mutual ancestor, we can find which is earliest\n\toldestA = oldestA.component || oldestA;\n\toldestB = oldestB.component || oldestB;\n\n\tconst fragmentA = oldestA.parentFragment;\n\tconst fragmentB = oldestB.parentFragment;\n\n\t// if both items share a parent fragment, our job is easy\n\tif ( fragmentA === fragmentB ) {\n\t\tconst indexA = fragmentA.items.indexOf( oldestA );\n\t\tconst indexB = fragmentB.items.indexOf( oldestB );\n\n\t\t// if it's the same index, it means one contains the other,\n\t\t// so we see which has the longest ancestry\n\t\treturn ( indexA - indexB ) || ancestryA.length - ancestryB.length;\n\t}\n\n\t// if mutual ancestor is a section, we first test to see which section\n\t// fragment comes first\n\tconst fragments = mutualAncestor.iterations;\n\tif ( fragments ) {\n\t\tconst indexA = fragments.indexOf( fragmentA );\n\t\tconst indexB = fragments.indexOf( fragmentB );\n\n\t\treturn ( indexA - indexB ) || ancestryA.length - ancestryB.length;\n\t}\n\n\tthrow new Error( 'An unexpected condition was met while comparing the position of two components. Please file an issue at https://github.com/ractivejs/ractive/issues - thanks!' );\n}\n\nfunction getParent ( item ) {\n\tvar parentFragment;\n\n\tif ( parentFragment = item.parentFragment ) {\n\t\treturn parentFragment.owner;\n\t}\n\n\tif ( item.component && ( parentFragment = item.component.parentFragment ) ) {\n\t\treturn parentFragment.owner;\n\t}\n}\n\nfunction getAncestry ( item ) {\n\tvar ancestry, ancestor;\n\n\tancestry = [ item ];\n\n\tancestor = getParent( item );\n\n\twhile ( ancestor ) {\n\t\tancestry.push( ancestor );\n\t\tancestor = getParent( ancestor );\n\t}\n\n\treturn ancestry;\n}\n\n\nexport default class Query {\n\tconstructor ( ractive, selector, live, isComponentQuery ) {\n\t\tthis.ractive = ractive;\n\t\tthis.selector = selector;\n\t\tthis.live = live;\n\t\tthis.isComponentQuery = isComponentQuery;\n\n\t\tthis.result = [];\n\n\t\tthis.dirty = true;\n\t}\n\n\tadd ( item ) {\n\t\tthis.result.push( item );\n\t\tthis.makeDirty();\n\t}\n\n\tcancel () {\n\t\tvar liveQueries, selector, index;\n\n\t\tliveQueries = this._root[ this.isComponentQuery ? 'liveComponentQueries' : 'liveQueries' ];\n\t\tselector = this.selector;\n\n\t\tindex = liveQueries.indexOf( selector );\n\n\t\tif ( index !== -1 ) {\n\t\t\tliveQueries.splice( index, 1 );\n\t\t\tliveQueries[ selector ] = null;\n\t\t}\n\t}\n\n\tinit () {\n\t\tthis.dirty = false;\n\t}\n\n\tmakeDirty () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.dirty = true;\n\n\t\t\t// Once the DOM has been updated, ensure the query\n\t\t\t// is correctly ordered\n\t\t\trunloop.scheduleTask( () => this.update() );\n\t\t}\n\t}\n\n\tremove ( nodeOrComponent ) {\n\t\tvar index = this.result.indexOf( this.isComponentQuery ? nodeOrComponent.instance : nodeOrComponent );\n\n\t\tif ( index !== -1 ) {\n\t\t\tthis.result.splice( index, 1 );\n\t\t}\n\t}\n\n\tupdate () {\n\t\tthis.result.sort( this.isComponentQuery ? sortByItemPosition : sortByDocumentPosition );\n\t\tthis.dirty = false;\n\t}\n\n\ttest ( item ) {\n\t\treturn this.isComponentQuery ?\n\t\t\t( !this.selector || item.name === this.selector ) :\n\t\t\t( item ? matches( item, this.selector ) : null );\n\t}\n}\n","export default function Ractive$findComponent ( selector ) {\n\treturn this.fragment.findComponent( selector );\n}\n","export default function Ractive$findParent ( selector ) {\n\n\tif ( this.parent ) {\n\t\tif ( this.parent.component && this.parent.component.name === selector ) {\n\t\t\treturn this.parent;\n\t\t} else {\n\t\t\treturn this.parent.findParent ( selector );\n\t\t}\n\t}\n\n\treturn null;\n}\n","var starMaps = {};\n\n// This function takes a keypath such as 'foo.bar.baz', and returns\n// all the variants of that keypath that include a wildcard in place\n// of a key, such as 'foo.bar.*', 'foo.*.baz', 'foo.*.*' and so on.\n// These are then checked against the dependants map (ractive.viewmodel.depsMap)\n// to see if any pattern observers are downstream of one or more of\n// these wildcard keypaths (e.g. 'foo.bar.*.status')\nexport default function getPotentialWildcardMatches ( keypath ) {\n\tvar keys, starMap, mapper, i, result, wildcardKeypath;\n\n\tkeys = keypath.split( '.' );\n\tif( !( starMap = starMaps[ keys.length ]) ) {\n\t\tstarMap = getStarMap( keys.length );\n\t}\n\n\tresult = [];\n\n\tmapper = function ( star, i ) {\n\t\treturn star ? '*' : keys[i];\n\t};\n\n\ti = starMap.length;\n\twhile ( i-- ) {\n\t\twildcardKeypath = starMap[i].map( mapper ).join( '.' );\n\n\t\tif ( !result.hasOwnProperty( wildcardKeypath ) ) {\n\t\t\tresult.push( wildcardKeypath );\n\t\t\tresult[ wildcardKeypath ] = true;\n\t\t}\n\t}\n\n\treturn result;\n}\n\n// This function returns all the possible true/false combinations for\n// a given number - e.g. for two, the possible combinations are\n// [ true, true ], [ true, false ], [ false, true ], [ false, false ].\n// It does so by getting all the binary values between 0 and e.g. 11\nfunction getStarMap ( num ) {\n\tvar ones = '', max, binary, starMap, mapper, i, j, l, map;\n\n\tif ( !starMaps[ num ] ) {\n\t\tstarMap = [];\n\n\t\twhile ( ones.length < num ) {\n\t\t\tones += 1;\n\t\t}\n\n\t\tmax = parseInt( ones, 2 );\n\n\t\tmapper = function ( digit ) {\n\t\t\treturn digit === '1';\n\t\t};\n\n\t\tfor ( i = 0; i <= max; i += 1 ) {\n\t\t\tbinary = i.toString( 2 );\n\t\t\twhile ( binary.length < num ) {\n\t\t\t\tbinary = '0' + binary;\n\t\t\t}\n\n\t\t\tmap = [];\n\t\t\tl = binary.length;\n\t\t\tfor (j = 0; j < l; j++) {\n\t\t\t\tmap.push( mapper( binary[j] ) );\n\t\t\t}\n\t\t\tstarMap[i] = map;\n\t\t}\n\n\t\tstarMaps[ num ] = starMap;\n\t}\n\n\treturn starMaps[ num ];\n}\n\n\n\n","import { enqueue, dequeue } from './eventStack';\nimport getPotentialWildcardMatches from 'utils/getPotentialWildcardMatches';\n\nvar wildcardCache = {};\n\nexport default function fireEvent ( ractive, eventName, options = {} ) {\n\tif ( !eventName ) { return; }\n\n\tif ( !options.event ) {\n\t\toptions.event = {\n\t\t\tname: eventName,\n\t\t\t// until event not included as argument default\n\t\t\t_noArg: true\n\t\t};\n\t} else {\n\t\toptions.event.name = eventName;\n\t}\n\n\tvar eventNames = getWildcardNames( eventName );\n\n\tfireEventAs( ractive, eventNames, options.event, options.args, true );\n}\n\nfunction getWildcardNames ( eventName ) {\n\tif ( wildcardCache.hasOwnProperty( eventName ) ) {\n\t\treturn wildcardCache[ eventName ];\n\t} else {\n\t\treturn wildcardCache[ eventName ] = getPotentialWildcardMatches( eventName );\n\t}\n}\n\nfunction fireEventAs  ( ractive, eventNames, event, args, initialFire = false ) {\n\n\tvar subscribers, i, bubble = true;\n\n\tenqueue( ractive, event );\n\n\tfor ( i = eventNames.length; i >= 0; i-- ) {\n\t\tsubscribers = ractive._subs[ eventNames[ i ] ];\n\n\t\tif ( subscribers ) {\n\t\t\tbubble = notifySubscribers( ractive, subscribers, event, args ) && bubble;\n\t\t}\n\t}\n\n\tdequeue( ractive );\n\n\tif ( ractive.parent && bubble ) {\n\n\t\tif ( initialFire && ractive.component ) {\n\t\t\tlet fullName = ractive.component.name + '.' + eventNames[ eventNames.length-1 ];\n\t\t\teventNames = getWildcardNames( fullName );\n\n\t\t\tif( event ) {\n\t\t\t\tevent.component = ractive;\n\t\t\t}\n\t\t}\n\n\t\tfireEventAs( ractive.parent, eventNames, event, args );\n\t}\n}\n\nfunction notifySubscribers ( ractive, subscribers, event, args ) {\n\tvar originalEvent = null, stopEvent = false;\n\n\tif ( event && !event._noArg ) {\n\t\targs = [ event ].concat( args );\n\t}\n\n\t// subscribers can be modified inflight, e.g. \"once\" functionality\n\t// so we need to copy to make sure everyone gets called\n\tsubscribers = subscribers.slice();\n\n\tfor ( let i = 0, len = subscribers.length; i < len; i += 1 ) {\n\t\tif ( subscribers[ i ].apply( ractive, args ) === false ) {\n\t\t\tstopEvent = true;\n\t\t}\n\t}\n\n\tif ( event && !event._noArg && stopEvent && ( originalEvent = event.original ) ) {\n\t\toriginalEvent.preventDefault && originalEvent.preventDefault();\n\t\toriginalEvent.stopPropagation && originalEvent.stopPropagation();\n\t}\n\n\treturn !stopEvent;\n}\n","import Hook from 'events/Hook';\nimport { getElement } from 'utils/dom';\n\nvar insertHook = new Hook( 'insert' );\n\nexport default function Ractive$insert ( target, anchor ) {\n\tif ( !this.fragment.rendered ) {\n\t\t// TODO create, and link to, documentation explaining this\n\t\tthrow new Error( 'The API has changed - you must call `ractive.render(target[, anchor])` to render your Ractive instance. Once rendered you can use `ractive.insert()`.' );\n\t}\n\n\ttarget = getElement( target );\n\tanchor = getElement( anchor ) || null;\n\n\tif ( !target ) {\n\t\tthrow new Error( 'You must specify a valid target to insert into' );\n\t}\n\n\ttarget.insertBefore( this.detach(), anchor );\n\tthis.el = target;\n\n\t( target.__ractive_instances__ || ( target.__ractive_instances__ = [] ) ).push( this );\n\tthis.isDetached = false;\n\n\tfireInsertHook( this );\n}\n\nfunction fireInsertHook( ractive ) {\n\tinsertHook.fire( ractive );\n\n\tractive.findAllComponents('*').forEach( child => {\n\t\tfireInsertHook( child.instance );\n\t});\n}\n","import { isArray } from 'utils/is';\nimport { splitKeypath } from 'shared/keypaths';\nimport runloop from 'global/runloop';\n\nlet comparators = {};\n\nfunction getComparator ( option ) {\n\tif ( !option ) return null; // use existing arrays\n\tif ( option === true ) return JSON.stringify;\n\tif ( typeof option === 'function' ) return option;\n\n\tif ( typeof option === 'string' ) {\n\t\treturn comparators[ option ] || ( comparators[ option ] = thing => thing[ option ] );\n\t}\n\n\tthrow new Error( 'If supplied, options.compare must be a string, function, or `true`' ); // TODO link to docs\n}\n\nexport default function Ractive$merge ( keypath, array, options ) {\n\tconst model = this.viewmodel.joinAll( splitKeypath( keypath ) );\n\tconst promise = runloop.start( this, true );\n\tconst value = model.get();\n\n\tif ( array === value ) {\n\t\tthrow new Error( 'You cannot merge an array with itself' ); // TODO link to docs\n\t} else if ( !isArray( value ) || !isArray( array ) ) {\n\t\tthrow new Error( 'You cannot merge an array with a non-array' );\n\t}\n\n\tconst comparator = getComparator( options && options.compare );\n\tmodel.merge( array, comparator );\n\n\trunloop.end();\n\treturn promise;\n}\n","export function findInViewHierarchy ( registryName, ractive, name ) {\n\tvar instance = findInstance( registryName, ractive, name );\n\treturn instance ? instance[ registryName ][ name ] : null;\n}\n\nexport function findInstance ( registryName, ractive, name ) {\n\twhile ( ractive ) {\n\t\tif ( name in ractive[ registryName ] ) {\n\t\t\treturn ractive;\n\t\t}\n\n\t\tif ( ractive.isolated ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tractive = ractive.parent;\n\t}\n}","import add from './shared/add';\n\nexport default function Ractive$add ( keypath, d ) {\n\treturn add( this, keypath, ( d === undefined ? 1 : +d ) );\n}\n","export function bind               ( x ) { x.bind(); }\nexport function cancel             ( x ) { x.cancel(); }\nexport function handleChange       ( x ) { x.handleChange(); }\nexport function mark               ( x ) { x.mark(); }\nexport function render             ( x ) { x.render(); }\nexport function rebind             ( x ) { x.rebind(); }\nexport function teardown           ( x ) { x.teardown(); }\nexport function unbind             ( x ) { x.unbind(); }\nexport function unrender           ( x ) { x.unrender(); }\nexport function unrenderAndDestroy ( x ) { x.unrender( true ); }\nexport function update             ( x ) { x.update(); }\nexport function toString           ( x ) { return x.toString(); }\nexport function toEscapedString    ( x ) { return x.toString( true ); }\n","import Query from './shared/Query';\n\nexport default function Ractive$findAll ( selector, options ) {\n\tvar liveQueries, query;\n\n\tif ( !this.el ) {\n\t\treturn [];\n\t}\n\n\toptions = options || {};\n\tliveQueries = this._liveQueries;\n\n\t// Shortcut: if we're maintaining a live query with this\n\t// selector, we don't need to traverse the parallel DOM\n\tif ( query = liveQueries[ selector ] ) {\n\n\t\t// Either return the exact same query, or (if not live) a snapshot\n\t\treturn ( options && options.live ) ? query : query.slice();\n\t}\n\n\tquery = new Query( this, selector, !!options.live, false );\n\n\t// Add this to the list of live queries Ractive needs to maintain,\n\t// if applicable\n\tif ( query.live ) {\n\t\tliveQueries.push( selector );\n\t\tliveQueries[ '_' + selector ] = query;\n\t}\n\n\tthis.fragment.findAll( selector, query );\n\n\tquery.init();\n\treturn query.result;\n}\n","import Query from './shared/Query';\n\nexport default function Ractive$findAllComponents ( selector, options ) {\n\tvar liveQueries, query;\n\n\toptions = options || {};\n\tliveQueries = this._liveComponentQueries;\n\n\t// Shortcut: if we're maintaining a live query with this\n\t// selector, we don't need to traverse the parallel DOM\n\tif ( query = liveQueries[ selector ] ) {\n\n\t\t// Either return the exact same query, or (if not live) a snapshot\n\t\treturn ( options && options.live ) ? query : query.slice();\n\t}\n\n\tquery = new Query( this, selector, !!options.live, true );\n\n\t// Add this to the list of live queries Ractive needs to maintain,\n\t// if applicable\n\tif ( query.live ) {\n\t\tliveQueries.push( selector );\n\t\tliveQueries[ '_' + selector ] = query;\n\t}\n\n\tthis.fragment.findAllComponents( selector, query );\n\n\tquery.init();\n\treturn query.result;\n}\n","export default function Ractive$findContainer ( selector ) {\n\tif ( this.container ) {\n\t\tif ( this.container.component && this.container.component.name === selector ) {\n\t\t\treturn this.container;\n\t\t} else {\n\t\t\treturn this.container.findContainer( selector );\n\t\t}\n\t}\n\n\treturn null;\n}","export function enqueue ( ractive, event ) {\n\tif ( ractive.event ) {\n\t\tractive._eventQueue.push( ractive.event );\n\t}\n\n\tractive.event = event;\n}\n\nexport function dequeue ( ractive ) {\n\tif ( ractive._eventQueue.length ) {\n\t\tractive.event = ractive._eventQueue.pop();\n\t} else {\n\t\tractive.event = null;\n\t}\n}\n","import fireEvent from 'events/fireEvent';\n\nexport default function Ractive$fire ( eventName, ...args ) {\n\tfireEvent( this, eventName, { args });\n}\n","function badReference ( key ) {\n\tthrow new Error( `An index or key reference (${key}) cannot have child properties` );\n}\n\nexport default function resolveAmbiguousReference ( fragment, ref ) {\n\tconst localViewmodel = fragment.findContext().root;\n\tconst keys = ref.split( '.' );\n\tconst key = keys[0];\n\n\t// TODO what if there are two component boundaries to cross - does this still work?\n\tconst base = localViewmodel.mappings.hasOwnProperty( key ) ?\n\t\tlocalViewmodel.mappings[ key ] :\n\t\tlocalViewmodel.computations.hasOwnProperty( key ) ?\n\t\t\tlocalViewmodel.computations[ key ] :\n\t\t\tnull;\n\n\tif ( base ) {\n\t\treturn keys.length > 1 ?\n\t\t\tbase.joinAll( keys.slice( 1 ) ) :\n\t\t\tbase;\n\t}\n\n\tlet hasContextChain;\n\tlet crossedComponentBoundary;\n\n\twhile ( fragment ) {\n\t\t// repeated fragments\n\t\tif ( fragment.isIteration ) {\n\t\t\tif ( key === fragment.parent.keyRef ) {\n\t\t\t\tif ( keys.length > 1 ) badReference( key );\n\t\t\t\treturn fragment.context.getKeyModel();\n\t\t\t}\n\n\t\t\tif ( key === fragment.parent.indexRef ) {\n\t\t\t\tif ( keys.length > 1 ) badReference( key );\n\t\t\t\treturn fragment.context.getIndexModel( fragment.index );\n\t\t\t}\n\t\t}\n\n\t\tif ( fragment.context ) {\n\t\t\t// TODO better encapsulate the component check\n\t\t\tif ( !fragment.isRoot || fragment.ractive.component ) hasContextChain = true;\n\n\t\t\tif ( fragment.context.has( key ) ) {\n\t\t\t\tif ( crossedComponentBoundary ) {\n\t\t\t\t\tlocalViewmodel.map( key, fragment.context.joinKey( key ) );\n\t\t\t\t}\n\n\t\t\t\treturn fragment.context.joinAll( keys );\n\t\t\t}\n\t\t}\n\n\t\tif ( fragment.componentParent && !fragment.ractive.isolated ) {\n\t\t\t// ascend through component boundary\n\t\t\tfragment = fragment.componentParent;\n\t\t\tcrossedComponentBoundary = true;\n\t\t} else {\n\t\t\tfragment = fragment.parent;\n\t\t}\n\t}\n\n\tif ( !hasContextChain ) {\n\t\treturn localViewmodel.joinAll( keys );\n\t}\n}\n","import resolveAmbiguousReference from './resolveAmbiguousReference';\n\nexport default function resolveReference ( fragment, ref ) {\n\tlet context = fragment.findContext();\n\n\t// special references\n\t// TODO does `this` become `.` at parse time?\n\tif ( ref === '.' || ref === 'this' ) return context;\n\tif ( ref === '@keypath' ) return context.getKeypathModel();\n\tif ( ref === '@index' ) {\n\t\tconst repeater = fragment.findRepeatingFragment();\n\t\treturn repeater.context.getIndexModel( repeater.index );\n\t}\n\tif ( ref === '@key' ) return fragment.findRepeatingFragment().context.getKeyModel();\n\n\t// ancestor references\n\tif ( ref[0] === '~' ) return context.root.joinAll( ref.slice( 2 ).split( '.' ) );\n\tif ( ref[0] === '.' ) {\n\t\tconst parts = ref.split( '/' );\n\n\t\twhile ( parts[0] === '.' || parts[0] === '..' ) {\n\t\t\tconst part = parts.shift();\n\n\t\t\tif ( part === '..' ) {\n\t\t\t\tcontext = context.parent;\n\t\t\t}\n\t\t}\n\n\t\tref = parts.join( '/' );\n\n\t\t// special case - `{{.foo}}` means the same as `{{./foo}}`\n\t\tif ( ref[0] === '.' ) ref = ref.slice( 1 );\n\t\treturn context.joinAll( ref.split( '.' ) );\n\t}\n\n\treturn resolveAmbiguousReference( fragment, ref );\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport resolveReference from 'view/resolvers/resolveReference';\n\nexport default function Ractive$get ( keypath ) {\n\tif ( !keypath ) return this.viewmodel.get( true );\n\n\tconst keys = splitKeypath( keypath );\n\tconst key = keys[0];\n\n\tlet model;\n\n\tif ( !this.viewmodel.has( key ) ) {\n\t\t// if this is an inline component, we may need to create\n\t\t// an implicit mapping\n\t\tif ( this.component ) {\n\t\t\tmodel = resolveReference( this.component.parentFragment, key );\n\n\t\t\tif ( model ) {\n\t\t\t\tthis.viewmodel.map( key, model );\n\t\t\t}\n\t\t}\n\t}\n\n\tmodel = this.viewmodel.joinAll( keys );\n\treturn model.get( true );\n}\n","import trim from './shared/trim';\nimport notEmptyString from './shared/notEmptyString';\n\nexport default function Ractive$off ( eventName, callback ) {\n\tvar eventNames;\n\n\t// if no arguments specified, remove all callbacks\n\tif ( !eventName ) {\n\t\t// TODO use this code instead, once the following issue has been resolved\n\t\t// in PhantomJS (tests are unpassable otherwise!)\n\t\t// https://github.com/ariya/phantomjs/issues/11856\n\t\t// defineProperty( this, '_subs', { value: create( null ), configurable: true });\n\t\tfor ( eventName in this._subs ) {\n\t\t\tdelete this._subs[ eventName ];\n\t\t}\n\t}\n\n\telse {\n\t\t// Handle multiple space-separated event names\n\t\teventNames = eventName.split( ' ' ).map( trim ).filter( notEmptyString );\n\n\t\teventNames.forEach( eventName => {\n\t\t\tvar subscribers, index;\n\n\t\t\t// If we have subscribers for this event...\n\t\t\tif ( subscribers = this._subs[ eventName ] ) {\n\t\t\t\t// ...if a callback was specified, only remove that\n\t\t\t\tif ( callback ) {\n\t\t\t\t\tindex = subscribers.indexOf( callback );\n\t\t\t\t\tif ( index !== -1 ) {\n\t\t\t\t\t\tsubscribers.splice( index, 1 );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// ...otherwise remove all callbacks\n\t\t\t\telse {\n\t\t\t\t\tthis._subs[ eventName ] = [];\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\treturn this;\n}\n","import trim from './shared/trim';\nimport notEmptyString from './shared/notEmptyString';\n\nexport default function Ractive$on ( eventName, callback ) {\n\tvar listeners, n, eventNames;\n\n\t// allow mutliple listeners to be bound in one go\n\tif ( typeof eventName === 'object' ) {\n\t\tlisteners = [];\n\n\t\tfor ( n in eventName ) {\n\t\t\tif ( eventName.hasOwnProperty( n ) ) {\n\t\t\t\tlisteners.push( this.on( n, eventName[ n ] ) );\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tcancel: function () {\n\t\t\t\tvar listener;\n\n\t\t\t\twhile ( listener = listeners.pop() ) {\n\t\t\t\t\tlistener.cancel();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\t// Handle multiple space-separated event names\n\teventNames = eventName.split( ' ' ).map( trim ).filter( notEmptyString );\n\n\teventNames.forEach( eventName => {\n\t\t( this._subs[ eventName ] || ( this._subs[ eventName ] = [] ) ).push( callback );\n\t});\n\n\treturn {\n\t\tcancel: () => this.off( eventName, callback )\n\t};\n}\n","// This function takes an array, the name of a mutator method, and the\n// arguments to call that mutator method with, and returns an array that\n// maps the old indices to their new indices.\n\n// So if you had something like this...\n//\n//     array = [ 'a', 'b', 'c', 'd' ];\n//     array.push( 'e' );\n//\n// ...you'd get `[ 0, 1, 2, 3 ]` - in other words, none of the old indices\n// have changed. If you then did this...\n//\n//     array.unshift( 'z' );\n//\n// ...the indices would be `[ 1, 2, 3, 4, 5 ]` - every item has been moved\n// one higher to make room for the 'z'. If you removed an item, the new index\n// would be -1...\n//\n//     array.splice( 2, 2 );\n//\n// ...this would result in [ 0, 1, -1, -1, 2, 3 ].\n//\n// This information is used to enable fast, non-destructive shuffling of list\n// sections when you do e.g. `ractive.splice( 'items', 2, 2 );\n\nexport default function getNewIndices ( length, methodName, args ) {\n\tvar spliceArguments, newIndices = [], removeStart, removeEnd, balance, i;\n\n\tspliceArguments = getSpliceEquivalent( length, methodName, args );\n\n\tif ( !spliceArguments ) {\n\t\treturn null; // TODO support reverse and sort?\n\t}\n\n\tbalance = ( spliceArguments.length - 2 ) - spliceArguments[1];\n\n\tremoveStart = Math.min( length, spliceArguments[0] );\n\tremoveEnd = removeStart + spliceArguments[1];\n\n\tfor ( i = 0; i < removeStart; i += 1 ) {\n\t\tnewIndices.push( i );\n\t}\n\n\tfor ( ; i < removeEnd; i += 1 ) {\n\t\tnewIndices.push( -1 );\n\t}\n\n\tfor ( ; i < length; i += 1 ) {\n\t\tnewIndices.push( i + balance );\n\t}\n\n\t// there is a net shift for the rest of the array starting with index + balance\n\tif ( balance !== 0 ) {\n\t\tnewIndices.touchedFrom = spliceArguments[0];\n\t} else {\n\t\tnewIndices.touchedFrom = length;\n\t}\n\n\treturn newIndices;\n}\n\n\n// The pop, push, shift an unshift methods can all be represented\n// as an equivalent splice\nfunction getSpliceEquivalent ( length, methodName, args ) {\n\tswitch ( methodName ) {\n\t\tcase 'splice':\n\t\t\tif ( args[0] !== undefined && args[0] < 0 ) {\n\t\t\t\targs[0] = length + Math.max( args[0], -length );\n\t\t\t}\n\n\t\t\twhile ( args.length < 2 ) {\n\t\t\t\targs.push( length - args[0] );\n\t\t\t}\n\n\t\t\t// ensure we only remove elements that exist\n\t\t\targs[1] = Math.min( args[1], length - args[0] );\n\n\t\t\treturn args;\n\n\t\tcase 'sort':\n\t\tcase 'reverse':\n\t\t\treturn null;\n\n\t\tcase 'pop':\n\t\t\tif ( length ) {\n\t\t\t\treturn [ length - 1, 1 ];\n\t\t\t}\n\t\t\treturn [ 0, 0 ];\n\n\t\tcase 'push':\n\t\t\treturn [ length, 0 ].concat( args );\n\n\t\tcase 'shift':\n\t\t\treturn [ 0, length ? 1 : 0 ];\n\n\t\tcase 'unshift':\n\t\t\treturn [ 0, 0 ].concat( args );\n\t}\n}\n","import { getElement } from 'utils/dom';\nimport render from '../render';\nimport { teardown } from 'shared/methodCallers';\n\nexport default function Ractive$render ( target, anchor ) {\n\ttarget = getElement( target ) || this.el;\n\n\tif ( !this.append && target ) {\n\t\t// Teardown any existing instances *before* trying to set up the new one -\n\t\t// avoids certain weird bugs\n\t\tlet others = target.__ractive_instances__;\n\t\tif ( others && others.length ) {\n\t\t\tremoveOtherInstances( others );\n\t\t}\n\n\t\t// make sure we are the only occupants\n\t\ttarget.innerHTML = ''; // TODO is this quicker than removeChild? Initial research inconclusive\n\t}\n\n\treturn render( this, target, anchor );\n}\n\nfunction removeOtherInstances ( others ) {\n\tothers.splice( 0, others.length ).forEach( teardown );\n}\n","import noop from 'utils/noop';\n\nexport default function wrap ( parent, name, method ) {\n\tif ( !/_super/.test( method ) ) {\n\t\treturn method;\n\t}\n\n\tvar wrapper = function wrapSuper () {\n\t\tvar superMethod = getSuperMethod( wrapper._parent, name ),\n\t\t\thasSuper = ( '_super' in this ),\n\t\t\toldSuper = this._super,\n\t\t\tresult;\n\n\t\tthis._super = superMethod;\n\n\t\tresult = method.apply( this, arguments );\n\n\t\tif ( hasSuper ) {\n\t\t\tthis._super = oldSuper;\n\t\t} else {\n\t\t\tdelete this._super;\n\t\t}\n\n\t\treturn result;\n\t};\n\n\twrapper._parent = parent;\n\twrapper._method = method;\n\n\treturn wrapper;\n}\n\nfunction getSuperMethod ( parent, name ) {\n\tvar value, method;\n\n\tif ( name in parent ) {\n\t\tvalue = parent[name];\n\n\t\tif ( typeof value === 'function' ) {\n\t\t\tmethod = value;\n\t\t} else {\n\t\t\tmethod = function returnValue () {\n\t\t\t\treturn value;\n\t\t\t};\n\t\t}\n\t} else {\n\t\tmethod = noop;\n\t}\n\n\treturn method;\n}\n","import { warnIfDebug } from 'utils/log';\nimport { isArray } from 'utils/is';\n\nfunction getMessage( deprecated, correct, isError ) {\n\treturn `options.${deprecated} has been deprecated in favour of options.${correct}.`\n\t\t+ ( isError ? ` You cannot specify both options, please use options.${correct}.` : '' );\n}\n\nfunction deprecateOption ( options, deprecatedOption, correct ) {\n\tif ( deprecatedOption in options ) {\n\t\tif( !( correct in options ) ) {\n\t\t\twarnIfDebug( getMessage( deprecatedOption, correct ) );\n\t\t\toptions[ correct ] = options[ deprecatedOption ];\n\t\t} else {\n\t\t\tthrow new Error( getMessage( deprecatedOption, correct, true ) );\n\t\t}\n\t}\n}\n\nexport default function deprecate ( options ) {\n\tdeprecateOption( options, 'beforeInit', 'onconstruct' );\n\tdeprecateOption( options, 'init', 'onrender' );\n\tdeprecateOption( options, 'complete', 'oncomplete' );\n\tdeprecateOption( options, 'eventDefinitions', 'events' );\n\n\t// Using extend with Component instead of options,\n\t// like Human.extend( Spider ) means adaptors as a registry\n\t// gets copied to options. So we have to check if actually an array\n\tif ( isArray( options.adaptors ) ) {\n\t\tdeprecateOption( options, 'adaptors', 'adapt' );\n\t}\n}\n","import resolveReference from './resolveReference';\nimport ExpressionProxy from './ExpressionProxy';\nimport ReferenceExpressionProxy from './ReferenceExpressionProxy';\n\nexport default function resolve ( fragment, template ) {\n\tif ( template.r ) {\n\t\treturn resolveReference( fragment, template.r );\n\t}\n\n\telse if ( template.x ) {\n\t\treturn new ExpressionProxy( fragment, template.x );\n\t}\n\n\telse {\n\t\treturn new ReferenceExpressionProxy( fragment, template.rx );\n\t}\n}\n","// TODO it's unfortunate that this has to run every time a\n// component is rendered... is there a better way?\nexport default function updateLiveQueries ( component ) {\n\t// Does this need to be added to any live queries?\n\tlet instance = component.ractive;\n\n\tdo {\n\t\tconst liveQueries = instance._liveComponentQueries;\n\n\t\tlet i = liveQueries.length;\n\t\twhile ( i-- ) {\n\t\t\tconst name = liveQueries[i];\n\t\t\tconst query = liveQueries[ `_${name}` ];\n\n\t\t\tif ( query.test( component ) ) {\n\t\t\t\tquery.add( component.instance );\n\t\t\t\t// keep register of applicable selectors, for when we teardown\n\t\t\t\tcomponent.liveQueries.push( query );\n\t\t\t}\n\t\t}\n\t} while ( instance = instance.parent );\n}\n","import { html } from 'config/namespaces';\nimport { safeToStringValue } from 'utils/dom';\nimport { arrayContains } from 'utils/array';\nimport { isArray } from 'utils/is';\nimport noop from 'utils/noop';\n\nexport default function getUpdateDelegate ( attribute ) {\n\tconst { element, name } = attribute;\n\n\tif ( name === 'id' ) return updateId;\n\n\tif ( name === 'value' ) {\n\t\t// special case - selects\n\t\tif ( element.name === 'select' && name === 'value' ) {\n\t\t\treturn element.getAttribute( 'multiple' ) ? updateMultipleSelectValue : updateSelectValue;\n\t\t}\n\n\t\tif ( element.name === 'textarea' ) return updateValue;\n\n\t\t// special case - contenteditable\n\t\tif ( element.getAttribute( 'contenteditable' ) != null ) return updateContentEditableValue;\n\n\t\t// special case - <input>\n\t\tif ( element.name === 'input' ) {\n\t\t\tconst type = element.getAttribute( 'type' );\n\n\t\t\t// type='file' value='{{fileList}}'>\n\t\t\tif ( type === 'file' ) return noop; // read-only\n\n\t\t\t// type='radio' name='{{twoway}}'\n\t\t\tif ( type === 'radio' && element.binding && element.binding.attribute.name === 'name' ) return updateRadioValue;\n\t\t}\n\n\t\treturn updateValue;\n\t}\n\n\tconst node = element.node;\n\n\t// special case - <input type='radio' name='{{twoway}}' value='foo'>\n\tif ( attribute.isTwoway && name === 'name' ) {\n\t\tif ( node.type === 'radio' ) return updateRadioName;\n\t\tif ( node.type === 'checkbox' ) return updateCheckboxName;\n\t}\n\n\t// special case - style attributes in Internet Exploder\n\tif ( name === 'style' && node.style.setAttribute ) return updateIEStyleAttribute;\n\n\t// special case - class names. IE fucks things up, again\n\tif ( name === 'class' && ( !node.namespaceURI || node.namespaceURI === html ) ) return updateClassName;\n\n\tif ( attribute.useProperty ) return updateProperty;\n\n\treturn updateAttribute;\n}\n\nfunction updateId () {\n\tconst { node } = this;\n\tconst value = this.getValue();\n\n\tdelete this.ractive.nodes[ node.id ];\n\tthis.ractive.nodes[ value ] = node;\n\n\tnode.id = value;\n}\n\nfunction updateMultipleSelectValue () {\n\tlet value = this.getValue();\n\n\tif ( !isArray( value ) ) value = [ value ];\n\n\tconst options = this.node.options;\n\tlet i = options.length;\n\n\twhile ( i-- ) {\n\t\tconst option = options[i];\n\t\tconst optionValue = option._ractive ?\n\t\t\toption._ractive.value :\n\t\t\toption.value; // options inserted via a triple don't have _ractive\n\n\t\toption.selected = arrayContains( value, optionValue );\n\t}\n}\n\nfunction updateSelectValue () {\n\tconst value = this.getValue();\n\n\tif ( !this.locked ) { // TODO is locked still a thing?\n\t\tthis.node._ractive.value = value;\n\n\t\tconst options = this.node.options;\n\t\tlet i = options.length;\n\n\t\twhile ( i-- ) {\n\t\t\tconst option = options[i];\n\t\t\tconst optionValue = option._ractive ?\n\t\t\t\toption._ractive.value :\n\t\t\t\toption.value; // options inserted via a triple don't have _ractive\n\n\t\t\tif ( optionValue == value ) { // double equals as we may be comparing numbers with strings\n\t\t\t\toption.selected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t// if we're still here, it means the new value didn't match any of the options...\n\t// TODO figure out what to do in this situation\n}\n\n\nfunction updateContentEditableValue () {\n\tconst value = this.getValue();\n\n\tif ( !this.locked ) {\n\t\tthis.node.innerHTML = value === undefined ? '' : value;\n\t}\n}\n\nfunction updateRadioValue () {\n\tconst node = this.node;\n\tconst wasChecked = node.checked;\n\n\tconst value = this.getValue();\n\n\t//node.value = this.element.getAttribute( 'value' );\n\tnode.value = this.node._ractive.value = value;\n\tnode.checked = value === this.element.getAttribute( 'name' );\n\n\t// This is a special case - if the input was checked, and the value\n\t// changed so that it's no longer checked, the twoway binding is\n\t// most likely out of date. To fix it we have to jump through some\n\t// hoops... this is a little kludgy but it works\n\tif ( wasChecked && !node.checked && this.element.binding && this.element.binding.rendered ) {\n\t\tthis.element.binding.group.model.set( this.element.binding.group.getValue() );\n\t}\n}\n\nfunction updateValue () {\n\tif ( !this.locked ) {\n\t\tconst value = this.getValue();\n\n\t\tthis.node.value = this.node._ractive.value = value;\n\t\tthis.node.setAttribute( 'value', value );\n\t}\n}\n\nfunction updateRadioName () {\n\tthis.node.checked = ( this.getValue() == this.node._ractive.value );\n}\n\nfunction updateCheckboxName () {\n\tconst { element, node } = this;\n\tconst binding = element.binding;\n\n\tconst value = this.getValue();\n\tconst valueAttribute = element.getAttribute( 'value' );\n\n\tif ( !isArray( value ) ) {\n\t\tbinding.isChecked = node.checked = ( value == valueAttribute );\n\t} else {\n\t\tlet i = value.length;\n\t\twhile ( i-- ) {\n\t\t\tif ( valueAttribute == value[i] ) {\n\t\t\t\tbinding.isChecked = node.checked = true;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tbinding.isChecked = node.checked = false;\n\t}\n}\n\nfunction updateIEStyleAttribute () {\n\tthis.node.style.setAttribute( 'cssText', this.getValue() || '' );\n}\n\nfunction updateClassName () {\n\tthis.node.className = safeToStringValue( this.getValue() );\n}\n\nfunction updateProperty () {\n\t// with two-way binding, only update if the change wasn't initiated by the user\n\t// otherwise the cursor will often be sent to the wrong place\n\tif ( !this.locked ) {\n\t\tthis.node[ this.propertyName ] = this.getValue();\n\t}\n}\n\nfunction updateAttribute () {\n\tthis.node.setAttribute( this.name, safeToStringValue( this.getString() ) );\n}\n"],"names":["Mustache___inherits","Mustache","_Item","prototype","bind","model","resolvers_resolve","this","parentFragment","template","value","get","undefined","isStatic","register","resolver","resolve","r","_this","handleChange","bubble","rebind","oldValue","unregister","unbind","shared_Item","Interpolator","_Mustache","Interpolator___classCallCheck","Interpolator___inherits","detach","node","parentNode","removeChild","firstNode","getString","safeToStringValue","render","target","rendered","doc","createTextNode","appendChild","toString","escape","string","escapeHtml","unrender","shouldDestroy","update","dirty","data","valueOf","Input","_Element","Input___classCallCheck","Input___inherits","call","defaultValue","Element","Option","options","Option___classCallCheck","a","f","select","findParentSelect","parent","Option___inherits","selectedAttribute","attributeByName","selected","getAttribute","index","attributes","indexOf","splice","push","isSelected","optionValue","selectValue","isArray","i","length","removeFromArray","Partial","Partial___classCallCheck","apply","arguments","Partial___inherits","RepeatedFragment","RepeatedFragment___classCallCheck","owner","ractive","indexRef","keyRef","pendingNewIndices","indexByKey","context","iterations","createIteration","isObject","_indexRef$split","split","_indexRef$split2","Object","keys","map","key","keyRefs","getRefs","indexRefs","fragment","Fragment","isIteration","joinKey","docFrag","createDocumentFragment","forEach","find","selector","len","found","findAll","query","findComponent","name","findAllComponents","findNextNode","iteration","shuffle","newIndices","Error","previousIterations","slice","newIndex","oldIndex","_this2","toEscapedString","methodCallers__toString","join","methodCallers__unbind","methodCallers__unrenderAndDestroy","methodCallers__unrender","updatePostShuffle","toRemove","oldKeys","methodCallers__update","newLength","_this3","findParentNode","anchor","insertBefore","previousNewIndex","reinsertFrom","_this4","existingFragment","childNodes","Section","Section___classCallCheck","sectionType","n","Section___inherits","getType","isEmpty","SECTION_WITH","SECTION_UNLESS","SECTION_IF","SECTION_IF_WITH","SECTION_EACH","newFragment","fragmentShouldExist","Select","Select___classCallCheck","Select___inherits","runloop","scheduleTask","sync","defaultSelected","selectNode","toArray","isMultiple","optionWasSelected","o","_ractive","shouldSelect","valueContains","binding","forceUpdate","Text","Text___classCallCheck","type","TEXT","Text___inherits","elementCache","createElement","innerHTML","err","ieBug","ieBlacklist","TABLE","THEAD","TBODY","TR","SELECT","insertHtml","html","container","wrapper","selectedOption","child","nodes","tagName","element","querySelector","selectedIndex","namespaceURI","namespaces__svg","firstChild","Triple","Triple___classCallCheck","Triple___inherits","nodeType","matches","queryResult","test","add","queryAllResult","querySelectorAll","numNodes","j","decodeCharacterReferences","Yielder","Yielder___classCallCheck","component","containerFragment","Yielder___inherits","yielders","_inlinePartials","parse","t","warnIfDebug","setTemplate","partials","partialTemplate","constructors","_constructors","_defineProperty","DOCTYPE","Doctype","INTERPOLATOR","PARTIAL","SECTION","TRIPLE","YIELDER","specialElements","doctype","form","Form","input","option","textarea","ReferenceResolver","reference","callback","ReferenceResolver___classCallCheck","normalise","resolved","addUnresolved","componentParent","attemptResolution","resolveAmbiguousReference","forceResolution","findContext","joinAll","unresolved","Fragment___classCallCheck","isRoot","cssIds","resolvers","dirtyArgs","dirtyValue","createItems","items","methodCallers__bind","bound","addFragment","createItem","item","nextItem","ELEMENT","el","findRepeatingFragment","getArgsList","values","source","processItems","_guid","parsed","parseJSON","argsList","methodCallers__rebind","resetTemplate","wasBound","wasRendered","toHtml","Fragment__unrenderAndDestroy","reverse","makeArrayMethod","shift","sort","prototype_teardown__teardownHook","Hook","toHTML","Ractive$toHTML","prototype_unrender__unrenderHook","unshift","updateHook","prototype_add","animate","prototype_animate","prototype_detach","prototype_find","prototype_findAll","prototype_findAllComponents","prototype_findComponent","findContainer","findParent","fire","prototype_fire","prototype_get","insert","merge","prototype_merge","observe","observeList","observeOnce","off","on","once","pop","prototype_push","prototype_render","reset","prototype_reset","resetPartial","prototype_resetTemplate","set","prototype_set","subtract","teardown","prototype_teardown","toggle","prototype_unrender","prototype_update","updateModel","prototype_updateModel","wrap__default","method","superMethod","force","needsSuper","result","hasSuper","_super","_extend","_extend__extend","getNodeInfo","storage","keypath","getKeypath","utils_object__extend","FUNCTION","Date","now","String","trim","Array","filter","win","addEventListener","Ractive","config_defaults","constructor","defaults","defineProperties","DEBUG","writable","DEBUG_PROMISES","extend","Promise","utils_Promise","svg","environment__svg","magic","environment__magic","VERSION","adaptors","components","decorators","easing","static_easing","events","interpolators","static_interpolators","transitions","rowspan","tabindex","usemap","booleanAttributes","voidElementNames","htmlEntities","quot","amp","apos","lt","gt","nbsp","iexcl","cent","pound","curren","yen","brvbar","sect","uml","copy","ordf","laquo","not","shy","reg","macr","deg","plusmn","sup2","sup3","acute","micro","para","middot","cedil","sup1","ordm","raquo","frac14","frac12","frac34","iquest","Agrave","Aacute","Acirc","Atilde","Auml","Aring","AElig","Ccedil","Egrave","Eacute","Ecirc","Euml","Igrave","Iacute","Icirc","Iuml","ETH","Ntilde","Ograve","Oacute","Ocirc","Otilde","Ouml","times","Oslash","Ugrave","Uacute","Ucirc","Uuml","Yacute","THORN","szlig","agrave","aacute","acirc","atilde","auml","aring","aelig","ccedil","egrave","eacute","ecirc","euml","igrave","iacute","icirc","iuml","eth","ntilde","ograve","oacute","ocirc","otilde","ouml","divide","oslash","ugrave","uacute","ucirc","uuml","yacute","thorn","yuml","OElig","oelig","Scaron","scaron","Yuml","fnof","circ","tilde","Alpha","Beta","Gamma","Delta","Epsilon","Zeta","Eta","Theta","Iota","Kappa","Lambda","Mu","Nu","Xi","Omicron","Pi","Rho","Sigma","Tau","Upsilon","Phi","Chi","Psi","Omega","alpha","beta","gamma","delta","epsilon","zeta","eta","theta","iota","kappa","lambda","mu","nu","xi","omicron","pi","rho","sigmaf","sigma","tau","upsilon","phi","chi","psi","omega","thetasym","upsih","piv","ensp","emsp","thinsp","zwnj","zwj","lrm","rlm","ndash","mdash","lsquo","rsquo","sbquo","ldquo","rdquo","bdquo","dagger","Dagger","bull","hellip","permil","prime","Prime","lsaquo","rsaquo","oline","frasl","euro","image","weierp","real","trade","alefsym","larr","uarr","rarr","darr","harr","crarr","lArr","uArr","rArr","dArr","hArr","forall","part","exist","empty","nabla","isin","notin","ni","prod","sum","minus","lowast","radic","prop","infin","ang","and","or","cap","cup","int","there4","sim","cong","asymp","ne","equiv","le","ge","sub","sup","nsub","sube","supe","oplus","otimes","perp","sdot","lceil","rceil","lfloor","rfloor","lang","rang","loz","spades","clubs","hearts","diams","controlCharacters","entityPattern","RegExp","lessThan","greaterThan","Attribute","Attribute___classCallCheck","updateDelegate","interpolator","Attribute___inherits","getValue","propertyName","attribute_propertyNames","isTwoway","useProperty","getUpdateDelegate","str","replace","ConditionalAttribute__div","ConditionalAttribute","ConditionalAttribute___classCallCheck","ConditionalAttribute___inherits","isSvg","attrs","parseAttributes","notIn","removeAttribute","setAttribute","missingDecorator","noop","Decorator","Decorator___classCallCheck","dynamicName","dynamicArgs","d","nameFragment","argsFragment","args","intermediary","fn","findInViewHierarchy","missingPlugin","concat","_name","EventHandler","EventHandler___classCallCheck","fatal","m","models","ref","event","resolveReference","argsFn","createFunction","s","action","obj","oldEvent","fireEvent","customHandler","defaultHandler","removeEventListener","camelCase","hyphenatedStr","match","$1","toUpperCase","isClient","prefixCache","transitions_prefix__testStyle","style","transitions_prefix__prefix","vendor","capped","charAt","substring","vendors","transitions_prefix","visible","hidden","visibility__prefix","visibility__i","onChange","onHide","onShow","Ticker","duration","step","complete","root","warnOnceIfDebug","linear","start","getTime","end","running","shared_animations","tick","elapsed","eased","stop","abort","createTransitions","createTransitions__testStyle","TRANSITION","TRANSITIONEND","CSS_TRANSITIONS_ENABLED","TRANSITION_DURATION","TRANSITION_PROPERTY","TRANSITION_TIMING_FUNCTION","unprefixPattern","unprefix","vendorPattern","hyphenate","hyphenated","toLowerCase","canUseCssTransitions","cannotUseCssTransitions","transition","webkitTransition","to","changedProperties","setTimeout","hashPrefix","jsTransitionsComplete","cssTransitionsComplete","checkComplete","transitionEndHandler","isIntro","hash","originalValue","suffix","propertiesToTransitionInJs","getStyle","exec","interpolate","parseFloat","pos","delay","getComputedStyle","legacy","Transition","Transition___classCallCheck","params","_fn","animateStyle","setStyle","promise","propertyNames","computedStyle","current","from","props","styles","processParams","hasOwnProperty","originalStyle","completed","noReset","resetStyle","_manager","remove","element_updateLiveQueries","element_updateLiveQueries__updateLiveQueries","Binding","binding_Binding___classCallCheck","attribute","twowayBinding","isUnresolved","warnAboutAmbiguity","isReadonly","getInitialValue","parentForm","findParentForm","resetValue","formBindings","registerTwowayBinding","locked","unregisterTwowayBinding","CheckboxBinding","_Binding","CheckboxBinding___classCallCheck","CheckboxBinding___inherits","handleDomEvent","attachEvent","checked","binding_Binding","groups","BindingGroup","getBindingGroup___classCallCheck","bindings","CheckboxNameBinding","CheckboxNameBinding___classCallCheck","existingValue","bindingValue","checkboxName","group","getBindingGroup","CheckboxNameBinding__getGroupValue","noInitialValue","CheckboxNameBinding___inherits","changed","wasChecked","isChecked","arrayContains","ContentEditableBinding","ContentEditableBinding___classCallCheck","ContentEditableBinding___inherits","lazy","FileListBinding","FileListBinding___classCallCheck","FileListBinding___inherits","GenericBinding","GenericBinding___classCallCheck","GenericBinding___inherits","timeout","isNumeric","handler","handleDelay","handleBlur","MultipleSelectBinding","MultipleSelectBinding___classCallCheck","MultipleSelectBinding___inherits","selectedValues","previousValue","arrayContentsMatch","setValue","initialValue","NumericBinding","NumericBinding___classCallCheck","NumericBinding___inherits","isNaN","siblings","RadioBinding","RadioBinding___classCallCheck","getSiblings","RadioBinding___inherits","RadioNameBinding","RadioNameBinding___classCallCheck","RadioNameBinding__getGroupValue","RadioNameBinding___inherits","nameAttributeBinding","getKeypathModel","SingleSelectBinding","SingleSelectBinding___classCallCheck","SingleSelectBinding___inherits","disabled","Element___classCallCheck","liveQueries","e","isVoid","conditionalAttributes","decorator","eventHandlers","v","eventNames","eventName","Element___inherits","createTwowayBinding","shouldBind","twoway","selectBinding","live","Element__makeDirty","namespace","getNamespace","defineProperty","proxy","x","methodCallers__render","transitionTemplate","t0","t1","transitionsEnabled","registerTransition","_introTransition","stringifyAttribute","inputIsCheckedRadio","detachWhenReady","t2","_transition","id","removeFromLiveQueries","Form___classCallCheck","Form___inherits","handleReset","Mustache___classCallCheck","Observer","dispatch","newValue","strict","addObserver","defer","cancel","PatternObserver","baseModel","observe___classCallCheck","pattern","baseKeypath","oldValues","newValues","findMatches","init","isEqual","wildcards","ListObserver","observeList___classCallCheck","pending","sliced","negativeOne","inserted","deleted","hadIndex","onceOptions","shared_trim","notEmptyString","Ractive$once","arrayProto","methodName","viewmodel","array","_len","_key","getNewIndices","then","global_css__prefix","styleElement","head","getElementsByTagName","inDom","styleSheet","global_css__update","css","cssText","registries__registryNames","Registry","registries","global_css","_render__renderHook","_render__completeHook","adaptConfigurator","Parent","proto","adapt","adaptConfigurator__combine","ensureArray","selectorsPattern","commentsPattern","selectorUnitPattern","mediaQueryPattern","dataRvcGuidPattern","cssConfigurator__uid","cssConfigurator","noCssTransform","transformCss","cssId","dataConfigurator","dataConfigurator__combine","parseOptions","parser","fromId","isHashedId","isParsed","getParseOptions","createHelper","template_parser__createHelper","doParse","template_parser","templateConfigurator","parseIfString","getDynamicTemplate","_config","p","extendPartials","useDefaults","configure","registry","create","isOwner","config","order","defaultKeys","custom","isBlacklisted","isStandardKey","makeObj","c","shouldRerender","prototype_reset__completeHook","resetHook","prototype_reset__renderHook","prototype_reset__unrenderHook","COMPONENT","NUMBER_LITERAL","STRING_LITERAL","REFERENCE","partial","collection","collect","forceResetTemplate","Item","shared_Item___classCallCheck","processWrapper","__model","mutatorMethods","patchedArrayProto","setting","wrappers","patchArrayMethods","unpatchArrayMethods","__proto__","configurable","unpatch","patch","arrayAdaptor__errorMessage","arrayAdaptor","object","wrap","ArrayWrapper","arrayAdaptor___classCallCheck","instances","magicAdaptor","MagicWrapper","magicArrayAdaptor","MagicArrayWrapper","magicAdaptor___classCallCheck","originalDescriptors","originalDescriptor","getOwnPropertyDescriptor","childKeypath","descriptor","createOrWrapDescriptor","__magic","revert","dependants","magicWrapper","arrayWrapper","Parser","ParseError","stack","captureGroup","prefixers","KeyModel","KeyModel___classCallCheck","methodCallers__handleChange","dependant","KeypathModel","KeypathModel___classCallCheck","hasProp","originatingModel","Model","Model___classCallCheck","deps","children","childByKey","indexModels","unresolvedByKey","adaptor","getPrefixer","clearUnresolveds","specificKey","hasKey","has","createBranch","branch","discard","boundsSensitive","existingMatches","member","computations","shouldCapture","capture","getIndexModel","fragmentIndex","getKeyModel","keypathModel","mark","retrieve","methodCallers__mark","comparator","oldArray","newArray","oldLength","usedIndices","firstUnusedIndex","_merged","dep","changes","shouldTeardown","parentValue","previousOriginatingModel","max","updateKeypathDependants","methodCallers__teardown","updateFromBindings","cascade","_updateFromBindings","_updateKeypathDependants","Computation","_Model","signature","Computation___classCallCheck","setter","computationContext","dependencies","Computation___inherits","startCapturing","getter","message","console","groupCollapsed","functionBody","prettify","getterString","getterUseStack","truncateStack","error","groupEnd","stopCapturing","setDependencies","RootModel","RootModel___classCallCheck","mappings","RootModel___inherits","applyChanges","_changeHash","flush","compute","computation","localKey","origin","constructHook","construct__registryNames","construct__uid","HookQueue","HookQueue___classCallCheck","hook","inProcess","queue","begin","getChildQueue","configHook","initHook","functionCache","ExpressionProxy","ExpressionProxy___classCallCheck","ExpressionProxy___inherits","wrapFunction","ReferenceExpressionProxy","ReferenceExpressionProxy___classCallCheck","base","members","ReferenceExpressionProxy___inherits","leadingWhitespace","lineStart","lines","lineEnds","line","lineEnd","read","leftover","remaining","postProcess","converters","getLinePos","char","columnNum","lineNum","numTabs","annotation","character","shortMessage","matchString","substr","matchPattern","allowWhitespace","nextChar","Child","hasOwn","stringMiddlePattern","escapeSequencePattern","lineContinuationPattern","JsonParser","specials","specialsPattern","parseJSON__numberPattern","placeholderPattern","placeholderAtStartPattern","onlyWhitespace","makeQuotedStringMatcher","okQuote","literal","done","next","charCodeAt","JSON","getSingleQuotedString","getDoubleQuotedString","readStringLiteral","readNumberLiteral__numberPattern","patterns__name","identifier","true","false","null","placeholder","special","number","stringLiteral","pair","getKeyValuePair","valueToken","items_Component__teardownHook","Component","ComponentConstructor","items_Component___classCallCheck","instance","complexMappings","content","_partials","construct","setupEvents","items_Component___inherits","childData","initialise","isolated","checkYielders","items_Component__makeDirty","_render","updateLiveQueries__default","_observers","removeFromLiveComponentQueries","__ractive_instances__","_this5","Doctype___classCallCheck","Doctype___inherits","accept-charset","accesskey","bgcolor","class","codebase","colspan","contenteditable","datetime","dirname","for","http-equiv","ismap","maxlength","novalidate","pubdate","readonly","haystack","needle","original","_liveQueries","description","clearTimeout","isBindable","bindName","bindChecked","makeDirty","typeAttribute","valueAttribute","nameAttribute","xmlns","getPartialTemplate","getPartialFromRegistry","noThrow","findParentPartial","findInstance","noRegistryFunctionReturn","findOwner","findConstructor","_Parent","subClass","superClass","TypeError","enumerable","setPrototypeOf","refs","hasIndexRef","getComponentConstructor","items_Component","ElementConstructor","guid","counter","placeholderId","Ractive$resetTemplate","Ractive$set","Ractive$subtract","shared_add","Ractive$teardown","_boundFunctions","deleteFunctionCopy","Ractive$toggle","badArguments","splitKeypath","Ractive$unrender","_animations","Ractive$updateModel","unwrap","addRegistries","addOtherOptions","addRegistry","_method","reduce","extendOne","unwrapExtended","computed","TEMPLATE_VERSION","defaultOptions","append","preserveWhitespace","sanitize","stripComments","delimiters","tripleDelimiters","modifyArrays","noIntro","easeIn","Math","pow","easeOut","easeInOut","window","document","hasConsole","navigator","appName","warn","dom__div","methodNames","unprefixed","prefixed","dom__i","makeFunction","implementation","hasFeature","ns","createElementNS","cloneNode","desc","F","log","printWarning","welcome","is__toString","alreadyWarned","welcomeIntro","welcomeMessage","hasGroup","requestAnimationFrame","snap","interpol","intermediate","min","properties","refPattern","shared_add__errorMessage","lastTime","currTime","timeToCall","rAF","performance","deprecations","deprecated","replacement","Hook___classCallCheck","deprecate","arg","predicate","list","thisArg","_Promise","PENDING","FULFILLED","REJECTED","dispatchHandlers","makeResolver","fulfil","reject","fulfilledHandlers","rejectedHandlers","state","newState","makeDispatcher","wait","onFulfilled","onRejected","promise2","processResolutionHandler","handlers","forward","p1result","utils_Promise__resolve","all","promises","processPromise","reason","TransitionManager","TransitionManager___classCallCheck","intros","outros","totalChildren","outroChildren","detachQueue","decoratorQueue","outrosComplete","addChild","addDecorator","decrementOutros","check","decrementTotal","detachNodes","_detachNodes","ready","changeHook","batch","returnPromise","fulfilPromise","previousBatch","transitionManager","fragments","tasks","immediateObservers","deferredObservers","flushChanges","addToArray","observer","registerDecorator","thing","task","postRender","_batch","animations","animation","Animation","startTime","timeNow","noAnimation","detachHook","Ractive$find","Query","isComponentQuery","Query___classCallCheck","_root","nodeOrComponent","sortByItemPosition","sortByDocumentPosition","Ractive$findComponent","Ractive$findParent","starMaps","wildcardCache","insertHook","comparators","getElement","output","getElementById","sources","b","isFinite","format","logIfDebug","_len2","_key2","warnOnce","_len3","_key3","registryName","Ractive$add","lastItem","arrayLike","called","resolvePromise","rejectPromise","y","tm","Ractive$animate","k","makeValueCollector","currentValues","collectValue","dummy","dummyOptions","Ractive$detach","isDetached","otherNode","compareDocumentPosition","bitmask","ancestryA","getAncestry","ancestryB","oldestA","oldestB","mutualAncestor","fragmentA","fragmentB","indexA","indexB","getParent","ancestry","ancestor","Ractive$findAll","Ractive$findAllComponents","_liveComponentQueries","Ractive$findContainer","enqueue","_eventQueue","dequeue","getPotentialWildcardMatches","starMap","mapper","wildcardKeypath","getStarMap","star","num","binary","l","ones","parseInt","digit","_noArg","getWildcardNames","fireEventAs","subscribers","initialFire","_subs","notifySubscribers","fullName","originalEvent","stopEvent","preventDefault","stopPropagation","Ractive$fire","badReference","localViewmodel","hasContextChain","crossedComponentBoundary","repeater","parts","Ractive$get","Ractive$insert","fireInsertHook","getComparator","stringify","Ractive$merge","compare","observers","createObserver","keypaths","wildcardIndex","_model","Ractive$off","Ractive$on","listeners","listener","spliceArguments","removeStart","removeEnd","balance","getSpliceEquivalent","touchedFrom","_render__render","Ractive$render","others","removeOtherInstances","transformed","dataAttr","addGuid","selectorUnits","unit","prepended","appended","modifiers","extractString","selectors","validate","childValue","parentIsFn","childIsFn","callDataFunction","fromProperties","primary","secondary","helper","textContent","val","initial","templateConfigurator__createHelper","existingPartials","newPartials","overwrite","getSuperMethod","_parent","oldSuper","getMessage","correct","isError","deprecateOption","deprecatedOption","extendOtherMethods","wrapPrototype","Ractive$reset","rerender","dest","_ref","prefixKeypath","prefix","rootKeypath","rootDot","relativeKeypath","fnBody","tabs","minIndent","prev","Infinity","truncated","createFunctionFromString","hasThis","Function","initialiseProperties","deprecateRactiveData","getAdaptors","getComputationSignature","construct__combine","protoAdapt","lookup","hookQueue","childQueue","userOptions","uid","__ractive_nowrap","resolvers_resolve__resolve","rx","readNumberLiteral","readKey","token","updateLiveQueries__updateLiveQueries","updateId","updateMultipleSelectValue","updateSelectValue","updateValue","updateContentEditableValue","updateRadioValue","updateRadioName","updateCheckboxName","updateIEStyleAttribute","updateProperty","updateAttribute","updateClassName","className","entity","code","fromCharCode","validateCode"],"mappings":"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AKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,IAAK,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,KAAM,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,QAAS,IAAKC,KAAM,IAAKC,IAAK,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,GAAI,IAAKC,GAAI,IAAKC,GAAI,IAAKC,QAAS,IAAKC,GAAI,IAAKC,IAAK,IAAKC,MAAO,IAAKC,IAAK,IAAKC,QAAS,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,MAAO,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,QAAS,IAAKC,KAAM,IAAKC,IAAK,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,GAAI,IAAKC,GAAI,IAAKC,GAAI,IAAKC,QAAS,IAAKC,GAAI,IAAKC,IAAK,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,IAAK,IAAKC,QAAS,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,MAAO,IAAKC,SAAU,IAAKC,MAAO,IAAKC,IAAK,IAAKC,KAAM,KAAMC,KAAM,KAAMC,OAAQ,KAAMC,KAAM,KAAMC,IAAK,KAAMC,IAAK,KAAMC,IAAK,KAAMC,MAAO,KAAMC,MAAO,KAAMC,MAAO,KAAMC,MAAO,KAAMC,MAAO,KAAMC,MAAO,KAAMC,MAAO,KAAMC,MAAO,KAAMC,OAAQ,KAAMC,OAAQ,KAAMC,KAAM,KAAMC,OAAQ,KAAMC,OAAQ,KAAMC,MAAO,KAA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"}